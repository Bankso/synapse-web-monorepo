(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('prop-types'), require('react'), require('crypto'), require('katex'), require('react-plotly.js'), require('react-measure'), require('react-tooltip')) :
    typeof define === 'function' && define.amd ? define(['exports', 'prop-types', 'react', 'crypto', 'katex', 'react-plotly.js', 'react-measure', 'react-tooltip'], factory) :
    (global = global || self, factory(global.SRC = {}, global.PropTypes, global.React, global.crypto, global.katex, global.Plot, global.Measure, global.ReactToolTip));
}(this, function (exports, PropTypes, React, crypto, katex, Plot, Measure, ReactTooltip) { 'use strict';

    var PropTypes__default = 'default' in PropTypes ? PropTypes['default'] : PropTypes;
    var React__default = 'default' in React ? React['default'] : React;
    crypto = crypto && crypto.hasOwnProperty('default') ? crypto['default'] : crypto;
    katex = katex && katex.hasOwnProperty('default') ? katex['default'] : katex;
    Plot = Plot && Plot.hasOwnProperty('default') ? Plot['default'] : Plot;
    Measure = Measure && Measure.hasOwnProperty('default') ? Measure['default'] : Measure;
    ReactTooltip = ReactTooltip && ReactTooltip.hasOwnProperty('default') ? ReactTooltip['default'] : ReactTooltip;

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    /* global Reflect, Promise */

    var extendStatics = function(d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };

    function __extends(d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    }

    var __assign = function() {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    function __rest(s, e) {
        var t = {};
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
            t[p] = s[p];
        if (s != null && typeof Object.getOwnPropertySymbols === "function")
            for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
                t[p[i]] = s[p[i]];
        return t;
    }

    function __awaiter(thisArg, _arguments, P, generator) {
        return new (P || (P = Promise))(function (resolve, reject) {
            function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
            function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
            function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
            step((generator = generator.apply(thisArg, _arguments || [])).next());
        });
    }

    function __generator(thisArg, body) {
        var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
        return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
        function verb(n) { return function (v) { return step([n, v]); }; }
        function step(op) {
            if (f) throw new TypeError("Generator is already executing.");
            while (_) try {
                if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
                if (y = 0, t) op = [op[0] & 2, t.value];
                switch (op[0]) {
                    case 0: case 1: t = op; break;
                    case 4: _.label++; return { value: op[1], done: false };
                    case 5: _.label++; y = op[1]; op = [0]; continue;
                    case 7: op = _.ops.pop(); _.trys.pop(); continue;
                    default:
                        if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                        if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                        if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                        if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                        if (t[2]) _.ops.pop();
                        _.trys.pop(); continue;
                }
                op = body.call(thisArg, _);
            } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
            if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
        }
    }

    /*!
     * Font Awesome Free 5.3.1 by @fontawesome - https://fontawesome.com
     * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
     */
    var noop = function noop() {};

    var _WINDOW = {};
    var _DOCUMENT = {};
    var _PERFORMANCE = { mark: noop, measure: noop };

    try {
      if (typeof window !== 'undefined') _WINDOW = window;
      if (typeof document !== 'undefined') _DOCUMENT = document;
      if (typeof performance !== 'undefined') _PERFORMANCE = performance;
    } catch (e) {}

    var _ref = _WINDOW.navigator || {};
    var _ref$userAgent = _ref.userAgent;
    var userAgent = _ref$userAgent === undefined ? '' : _ref$userAgent;

    var WINDOW = _WINDOW;
    var DOCUMENT = _DOCUMENT;
    var PERFORMANCE = _PERFORMANCE;

    var IS_DOM = !!DOCUMENT.documentElement && !!DOCUMENT.head && typeof DOCUMENT.addEventListener === 'function' && typeof DOCUMENT.createElement === 'function';
    var IS_IE = ~userAgent.indexOf('MSIE') || ~userAgent.indexOf('Trident/');

    var NAMESPACE_IDENTIFIER = '___FONT_AWESOME___';
    var DEFAULT_FAMILY_PREFIX = 'fa';
    var DEFAULT_REPLACEMENT_CLASS = 'svg-inline--fa';
    var DATA_FA_I2SVG = 'data-fa-i2svg';
    var PRODUCTION = function () {
      try {
        return process.env.NODE_ENV === 'production';
      } catch (e) {
        return false;
      }
    }();

    var classCallCheck = function (instance, Constructor) {
      if (!(instance instanceof Constructor)) {
        throw new TypeError("Cannot call a class as a function");
      }
    };

    var createClass = function () {
      function defineProperties(target, props) {
        for (var i = 0; i < props.length; i++) {
          var descriptor = props[i];
          descriptor.enumerable = descriptor.enumerable || false;
          descriptor.configurable = true;
          if ("value" in descriptor) descriptor.writable = true;
          Object.defineProperty(target, descriptor.key, descriptor);
        }
      }

      return function (Constructor, protoProps, staticProps) {
        if (protoProps) defineProperties(Constructor.prototype, protoProps);
        if (staticProps) defineProperties(Constructor, staticProps);
        return Constructor;
      };
    }();



    var _extends = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };



    var slicedToArray = function () {
      function sliceIterator(arr, i) {
        var _arr = [];
        var _n = true;
        var _d = false;
        var _e = undefined;

        try {
          for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {
            _arr.push(_s.value);

            if (i && _arr.length === i) break;
          }
        } catch (err) {
          _d = true;
          _e = err;
        } finally {
          try {
            if (!_n && _i["return"]) _i["return"]();
          } finally {
            if (_d) throw _e;
          }
        }

        return _arr;
      }

      return function (arr, i) {
        if (Array.isArray(arr)) {
          return arr;
        } else if (Symbol.iterator in Object(arr)) {
          return sliceIterator(arr, i);
        } else {
          throw new TypeError("Invalid attempt to destructure non-iterable instance");
        }
      };
    }();

    var initial = WINDOW.FontAwesomeConfig || {};

    function getAttrConfig(attr) {
      var element = DOCUMENT.querySelector('script[' + attr + ']');

      if (element) {
        return element.getAttribute(attr);
      }
    }

    function coerce(val) {
      // Getting an empty string will occur if the attribute is set on the HTML tag but without a value
      // We'll assume that this is an indication that it should be toggled to true
      // For example <script data-search-pseudo-elements src="..."></script>
      if (val === '') return true;
      if (val === 'false') return false;
      if (val === 'true') return true;
      return val;
    }

    if (DOCUMENT && typeof DOCUMENT.querySelector === 'function') {
      var attrs = [['data-family-prefix', 'familyPrefix'], ['data-replacement-class', 'replacementClass'], ['data-auto-replace-svg', 'autoReplaceSvg'], ['data-auto-add-css', 'autoAddCss'], ['data-auto-a11y', 'autoA11y'], ['data-search-pseudo-elements', 'searchPseudoElements'], ['data-observe-mutations', 'observeMutations'], ['data-keep-original-source', 'keepOriginalSource'], ['data-measure-performance', 'measurePerformance'], ['data-show-missing-icons', 'showMissingIcons']];

      attrs.forEach(function (_ref) {
        var _ref2 = slicedToArray(_ref, 2),
            attr = _ref2[0],
            key = _ref2[1];

        var val = coerce(getAttrConfig(attr));

        if (val !== undefined && val !== null) {
          initial[key] = val;
        }
      });
    }

    var _default = _extends({
      familyPrefix: DEFAULT_FAMILY_PREFIX,
      replacementClass: DEFAULT_REPLACEMENT_CLASS,
      autoReplaceSvg: true,
      autoAddCss: true,
      autoA11y: true,
      searchPseudoElements: false,
      observeMutations: true,
      keepOriginalSource: true,
      measurePerformance: false,
      showMissingIcons: true
    }, initial);

    if (!_default.autoReplaceSvg) _default.observeMutations = false;

    var config = _extends({}, _default);

    WINDOW.FontAwesomeConfig = config;

    var w = WINDOW || {};

    if (!w[NAMESPACE_IDENTIFIER]) w[NAMESPACE_IDENTIFIER] = {};
    if (!w[NAMESPACE_IDENTIFIER].styles) w[NAMESPACE_IDENTIFIER].styles = {};
    if (!w[NAMESPACE_IDENTIFIER].hooks) w[NAMESPACE_IDENTIFIER].hooks = {};
    if (!w[NAMESPACE_IDENTIFIER].shims) w[NAMESPACE_IDENTIFIER].shims = [];

    var namespace = w[NAMESPACE_IDENTIFIER];

    var functions = [];
    var listener = function listener() {
      DOCUMENT.removeEventListener('DOMContentLoaded', listener);
      loaded = 1;
      functions.map(function (fn) {
        return fn();
      });
    };

    var loaded = false;

    if (IS_DOM) {
      loaded = (DOCUMENT.documentElement.doScroll ? /^loaded|^c/ : /^loaded|^i|^c/).test(DOCUMENT.readyState);

      if (!loaded) DOCUMENT.addEventListener('DOMContentLoaded', listener);
    }

    var meaninglessTransform = {
      size: 16,
      x: 0,
      y: 0,
      rotate: 0,
      flipX: false,
      flipY: false
    };



    function insertCss(css) {
      if (!css || !IS_DOM) {
        return;
      }

      var style = DOCUMENT.createElement('style');
      style.setAttribute('type', 'text/css');
      style.innerHTML = css;

      var headChildren = DOCUMENT.head.childNodes;
      var beforeChild = null;

      for (var i = headChildren.length - 1; i > -1; i--) {
        var child = headChildren[i];
        var tagName = (child.tagName || '').toUpperCase();
        if (['STYLE', 'LINK'].indexOf(tagName) > -1) {
          beforeChild = child;
        }
      }

      DOCUMENT.head.insertBefore(style, beforeChild);

      return css;
    }

    var _uniqueId = 0;

    function nextUniqueId() {
      _uniqueId++;

      return _uniqueId;
    }

    function htmlEscape(str) {
      return ('' + str).replace(/&/g, '&amp;').replace(/"/g, '&quot;').replace(/'/g, '&#39;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
    }

    function joinAttributes(attributes) {
      return Object.keys(attributes || {}).reduce(function (acc, attributeName) {
        return acc + (attributeName + '="' + htmlEscape(attributes[attributeName]) + '" ');
      }, '').trim();
    }

    function joinStyles(styles) {
      return Object.keys(styles || {}).reduce(function (acc, styleName) {
        return acc + (styleName + ': ' + styles[styleName] + ';');
      }, '');
    }

    function transformIsMeaningful(transform) {
      return transform.size !== meaninglessTransform.size || transform.x !== meaninglessTransform.x || transform.y !== meaninglessTransform.y || transform.rotate !== meaninglessTransform.rotate || transform.flipX || transform.flipY;
    }

    function transformForSvg(_ref) {
      var transform = _ref.transform,
          containerWidth = _ref.containerWidth,
          iconWidth = _ref.iconWidth;

      var outer = {
        transform: 'translate(' + containerWidth / 2 + ' 256)'
      };
      var innerTranslate = 'translate(' + transform.x * 32 + ', ' + transform.y * 32 + ') ';
      var innerScale = 'scale(' + transform.size / 16 * (transform.flipX ? -1 : 1) + ', ' + transform.size / 16 * (transform.flipY ? -1 : 1) + ') ';
      var innerRotate = 'rotate(' + transform.rotate + ' 0 0)';
      var inner = {
        transform: innerTranslate + ' ' + innerScale + ' ' + innerRotate
      };
      var path = {
        transform: 'translate(' + iconWidth / 2 * -1 + ' -256)'
      };
      return {
        outer: outer,
        inner: inner,
        path: path
      };
    }

    var ALL_SPACE = {
      x: 0,
      y: 0,
      width: '100%',
      height: '100%'
    };

    var makeIconMasking = function (_ref) {
      var children = _ref.children,
          attributes = _ref.attributes,
          main = _ref.main,
          mask = _ref.mask,
          transform = _ref.transform;
      var mainWidth = main.width,
          mainPath = main.icon;
      var maskWidth = mask.width,
          maskPath = mask.icon;


      var trans = transformForSvg({ transform: transform, containerWidth: maskWidth, iconWidth: mainWidth });

      var maskRect = {
        tag: 'rect',
        attributes: _extends({}, ALL_SPACE, {
          fill: 'white'
        })
      };
      var maskInnerGroup = {
        tag: 'g',
        attributes: _extends({}, trans.inner),
        children: [{ tag: 'path', attributes: _extends({}, mainPath.attributes, trans.path, { fill: 'black' }) }]
      };
      var maskOuterGroup = {
        tag: 'g',
        attributes: _extends({}, trans.outer),
        children: [maskInnerGroup]
      };
      var maskId = 'mask-' + nextUniqueId();
      var clipId = 'clip-' + nextUniqueId();
      var maskTag = {
        tag: 'mask',
        attributes: _extends({}, ALL_SPACE, {
          id: maskId,
          maskUnits: 'userSpaceOnUse',
          maskContentUnits: 'userSpaceOnUse'
        }),
        children: [maskRect, maskOuterGroup]
      };
      var defs = {
        tag: 'defs',
        children: [{ tag: 'clipPath', attributes: { id: clipId }, children: [maskPath] }, maskTag]
      };

      children.push(defs, { tag: 'rect', attributes: _extends({ fill: 'currentColor', 'clip-path': 'url(#' + clipId + ')', mask: 'url(#' + maskId + ')' }, ALL_SPACE) });

      return {
        children: children,
        attributes: attributes
      };
    };

    var makeIconStandard = function (_ref) {
      var children = _ref.children,
          attributes = _ref.attributes,
          main = _ref.main,
          transform = _ref.transform,
          styles = _ref.styles;

      var styleString = joinStyles(styles);

      if (styleString.length > 0) {
        attributes['style'] = styleString;
      }

      if (transformIsMeaningful(transform)) {
        var trans = transformForSvg({ transform: transform, containerWidth: main.width, iconWidth: main.width });
        children.push({
          tag: 'g',
          attributes: _extends({}, trans.outer),
          children: [{
            tag: 'g',
            attributes: _extends({}, trans.inner),
            children: [{
              tag: main.icon.tag,
              children: main.icon.children,
              attributes: _extends({}, main.icon.attributes, trans.path)
            }]
          }]
        });
      } else {
        children.push(main.icon);
      }

      return {
        children: children,
        attributes: attributes
      };
    };

    var asIcon = function (_ref) {
      var children = _ref.children,
          main = _ref.main,
          mask = _ref.mask,
          attributes = _ref.attributes,
          styles = _ref.styles,
          transform = _ref.transform;

      if (transformIsMeaningful(transform) && main.found && !mask.found) {
        var width = main.width,
            height = main.height;

        var offset = {
          x: width / height / 2,
          y: 0.5
        };
        attributes['style'] = joinStyles(_extends({}, styles, {
          'transform-origin': offset.x + transform.x / 16 + 'em ' + (offset.y + transform.y / 16) + 'em'
        }));
      }

      return [{
        tag: 'svg',
        attributes: attributes,
        children: children
      }];
    };

    var asSymbol = function (_ref) {
      var prefix = _ref.prefix,
          iconName = _ref.iconName,
          children = _ref.children,
          attributes = _ref.attributes,
          symbol = _ref.symbol;

      var id = symbol === true ? prefix + '-' + config.familyPrefix + '-' + iconName : symbol;

      return [{
        tag: 'svg',
        attributes: {
          style: 'display: none;'
        },
        children: [{
          tag: 'symbol',
          attributes: _extends({}, attributes, { id: id }),
          children: children
        }]
      }];
    };

    function makeInlineSvgAbstract(params) {
      var _params$icons = params.icons,
          main = _params$icons.main,
          mask = _params$icons.mask,
          prefix = params.prefix,
          iconName = params.iconName,
          transform = params.transform,
          symbol = params.symbol,
          title = params.title,
          extra = params.extra,
          _params$watchable = params.watchable,
          watchable = _params$watchable === undefined ? false : _params$watchable;

      var _ref = mask.found ? mask : main,
          width = _ref.width,
          height = _ref.height;

      var widthClass = 'fa-w-' + Math.ceil(width / height * 16);
      var attrClass = [config.replacementClass, iconName ? config.familyPrefix + '-' + iconName : '', widthClass].filter(function (c) {
        return extra.classes.indexOf(c) === -1;
      }).concat(extra.classes).join(' ');

      var content = {
        children: [],
        attributes: _extends({}, extra.attributes, {
          'data-prefix': prefix,
          'data-icon': iconName,
          'class': attrClass,
          'role': 'img',
          'xmlns': 'http://www.w3.org/2000/svg',
          'viewBox': '0 0 ' + width + ' ' + height
        })
      };

      if (watchable) {
        content.attributes[DATA_FA_I2SVG] = '';
      }

      if (title) content.children.push({ tag: 'title', attributes: { id: content.attributes['aria-labelledby'] || 'title-' + nextUniqueId() }, children: [title] });

      var args = _extends({}, content, {
        prefix: prefix,
        iconName: iconName,
        main: main,
        mask: mask,
        transform: transform,
        symbol: symbol,
        styles: extra.styles
      });

      var _ref2 = mask.found && main.found ? makeIconMasking(args) : makeIconStandard(args),
          children = _ref2.children,
          attributes = _ref2.attributes;

      args.children = children;
      args.attributes = attributes;

      if (symbol) {
        return asSymbol(args);
      } else {
        return asIcon(args);
      }
    }

    var noop$2 = function noop() {};
    var p = config.measurePerformance && PERFORMANCE && PERFORMANCE.mark && PERFORMANCE.measure ? PERFORMANCE : { mark: noop$2, measure: noop$2 };

    /**
     * Internal helper to bind a function known to have 4 arguments
     * to a given context.
     */
    var bindInternal4 = function bindInternal4 (func, thisContext) {
      return function (a, b, c, d) {
        return func.call(thisContext, a, b, c, d);
      };
    };



    /**
     * # Reduce
     *
     * A fast object `.reduce()` implementation.
     *
     * @param  {Object}   subject      The object to reduce over.
     * @param  {Function} fn           The reducer function.
     * @param  {mixed}    initialValue The initial value for the reducer, defaults to subject[0].
     * @param  {Object}   thisContext  The context for the reducer.
     * @return {mixed}                 The final result.
     */
    var reduce = function fastReduceObject (subject, fn, initialValue, thisContext) {
      var keys = Object.keys(subject),
          length = keys.length,
          iterator = thisContext !== undefined ? bindInternal4(fn, thisContext) : fn,
          i, key, result;

      if (initialValue === undefined) {
        i = 1;
        result = subject[keys[0]];
      }
      else {
        i = 0;
        result = initialValue;
      }

      for (; i < length; i++) {
        key = keys[i];
        result = iterator(result, subject[key], key, subject);
      }

      return result;
    };

    var styles$2 = namespace.styles;
    var shims = namespace.shims;


    var _byUnicode = {};
    var _byLigature = {};
    var _byOldName = {};

    var build = function build() {
      var lookup = function lookup(reducer) {
        return reduce(styles$2, function (o, style, prefix) {
          o[prefix] = reduce(style, reducer, {});
          return o;
        }, {});
      };

      _byUnicode = lookup(function (acc, icon, iconName) {
        acc[icon[3]] = iconName;

        return acc;
      });

      _byLigature = lookup(function (acc, icon, iconName) {
        var ligatures = icon[2];

        acc[iconName] = iconName;

        ligatures.forEach(function (ligature) {
          acc[ligature] = iconName;
        });

        return acc;
      });

      var hasRegular = 'far' in styles$2;

      _byOldName = reduce(shims, function (acc, shim) {
        var oldName = shim[0];
        var prefix = shim[1];
        var iconName = shim[2];

        if (prefix === 'far' && !hasRegular) {
          prefix = 'fas';
        }

        acc[oldName] = { prefix: prefix, iconName: iconName };

        return acc;
      }, {});
    };

    build();

    var styles$1 = namespace.styles;

    function iconFromMapping(mapping, prefix, iconName) {
      if (mapping && mapping[prefix] && mapping[prefix][iconName]) {
        return {
          prefix: prefix,
          iconName: iconName,
          icon: mapping[prefix][iconName]
        };
      }
    }

    function toHtml(abstractNodes) {
      var tag = abstractNodes.tag,
          _abstractNodes$attrib = abstractNodes.attributes,
          attributes = _abstractNodes$attrib === undefined ? {} : _abstractNodes$attrib,
          _abstractNodes$childr = abstractNodes.children,
          children = _abstractNodes$childr === undefined ? [] : _abstractNodes$childr;


      if (typeof abstractNodes === 'string') {
        return htmlEscape(abstractNodes);
      } else {
        return '<' + tag + ' ' + joinAttributes(attributes) + '>' + children.map(toHtml).join('') + '</' + tag + '>';
      }
    }

    var parseTransformString = function parseTransformString(transformString) {
      var transform = {
        size: 16,
        x: 0,
        y: 0,
        flipX: false,
        flipY: false,
        rotate: 0
      };

      if (!transformString) {
        return transform;
      } else {
        return transformString.toLowerCase().split(' ').reduce(function (acc, n) {
          var parts = n.toLowerCase().split('-');
          var first = parts[0];
          var rest = parts.slice(1).join('-');

          if (first && rest === 'h') {
            acc.flipX = true;
            return acc;
          }

          if (first && rest === 'v') {
            acc.flipY = true;
            return acc;
          }

          rest = parseFloat(rest);

          if (isNaN(rest)) {
            return acc;
          }

          switch (first) {
            case 'grow':
              acc.size = acc.size + rest;
              break;
            case 'shrink':
              acc.size = acc.size - rest;
              break;
            case 'left':
              acc.x = acc.x - rest;
              break;
            case 'right':
              acc.x = acc.x + rest;
              break;
            case 'up':
              acc.y = acc.y - rest;
              break;
            case 'down':
              acc.y = acc.y + rest;
              break;
            case 'rotate':
              acc.rotate = acc.rotate + rest;
              break;
          }

          return acc;
        }, transform);
      }
    };

    function MissingIcon(error) {
      this.name = 'MissingIcon';
      this.message = error || 'Icon unavailable';
      this.stack = new Error().stack;
    }

    MissingIcon.prototype = Object.create(Error.prototype);
    MissingIcon.prototype.constructor = MissingIcon;

    var FILL = { fill: 'currentColor' };
    var ANIMATION_BASE = {
      attributeType: 'XML',
      repeatCount: 'indefinite',
      dur: '2s'
    };
    var RING = {
      tag: 'path',
      attributes: _extends({}, FILL, {
        d: 'M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z'
      })
    };
    var OPACITY_ANIMATE = _extends({}, ANIMATION_BASE, {
      attributeName: 'opacity'
    });
    var DOT = {
      tag: 'circle',
      attributes: _extends({}, FILL, {
        cx: '256',
        cy: '364',
        r: '28'
      }),
      children: [{ tag: 'animate', attributes: _extends({}, ANIMATION_BASE, { attributeName: 'r', values: '28;14;28;28;14;28;' }) }, { tag: 'animate', attributes: _extends({}, OPACITY_ANIMATE, { values: '1;0;1;1;0;1;' }) }]
    };
    var QUESTION = {
      tag: 'path',
      attributes: _extends({}, FILL, {
        opacity: '1',
        d: 'M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z'
      }),
      children: [{ tag: 'animate', attributes: _extends({}, OPACITY_ANIMATE, { values: '1;0;0;0;0;1;' }) }]
    };
    var EXCLAMATION = {
      tag: 'path',
      attributes: _extends({}, FILL, {
        opacity: '0',
        d: 'M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z'
      }),
      children: [{ tag: 'animate', attributes: _extends({}, OPACITY_ANIMATE, { values: '0;0;1;1;0;0;' }) }]
    };

    var styles = namespace.styles;

    var baseStyles = "svg:not(:root).svg-inline--fa {\n  overflow: visible; }\n\n.svg-inline--fa {\n  display: inline-block;\n  font-size: inherit;\n  height: 1em;\n  overflow: visible;\n  vertical-align: -.125em; }\n  .svg-inline--fa.fa-lg {\n    vertical-align: -.225em; }\n  .svg-inline--fa.fa-w-1 {\n    width: 0.0625em; }\n  .svg-inline--fa.fa-w-2 {\n    width: 0.125em; }\n  .svg-inline--fa.fa-w-3 {\n    width: 0.1875em; }\n  .svg-inline--fa.fa-w-4 {\n    width: 0.25em; }\n  .svg-inline--fa.fa-w-5 {\n    width: 0.3125em; }\n  .svg-inline--fa.fa-w-6 {\n    width: 0.375em; }\n  .svg-inline--fa.fa-w-7 {\n    width: 0.4375em; }\n  .svg-inline--fa.fa-w-8 {\n    width: 0.5em; }\n  .svg-inline--fa.fa-w-9 {\n    width: 0.5625em; }\n  .svg-inline--fa.fa-w-10 {\n    width: 0.625em; }\n  .svg-inline--fa.fa-w-11 {\n    width: 0.6875em; }\n  .svg-inline--fa.fa-w-12 {\n    width: 0.75em; }\n  .svg-inline--fa.fa-w-13 {\n    width: 0.8125em; }\n  .svg-inline--fa.fa-w-14 {\n    width: 0.875em; }\n  .svg-inline--fa.fa-w-15 {\n    width: 0.9375em; }\n  .svg-inline--fa.fa-w-16 {\n    width: 1em; }\n  .svg-inline--fa.fa-w-17 {\n    width: 1.0625em; }\n  .svg-inline--fa.fa-w-18 {\n    width: 1.125em; }\n  .svg-inline--fa.fa-w-19 {\n    width: 1.1875em; }\n  .svg-inline--fa.fa-w-20 {\n    width: 1.25em; }\n  .svg-inline--fa.fa-pull-left {\n    margin-right: .3em;\n    width: auto; }\n  .svg-inline--fa.fa-pull-right {\n    margin-left: .3em;\n    width: auto; }\n  .svg-inline--fa.fa-border {\n    height: 1.5em; }\n  .svg-inline--fa.fa-li {\n    width: 2em; }\n  .svg-inline--fa.fa-fw {\n    width: 1.25em; }\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0; }\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -.125em;\n  width: 1em; }\n  .fa-layers svg.svg-inline--fa {\n    -webkit-transform-origin: center center;\n            transform-origin: center center; }\n\n.fa-layers-text, .fa-layers-counter {\n  display: inline-block;\n  position: absolute;\n  text-align: center; }\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  -webkit-transform-origin: center center;\n          transform-origin: center center; }\n\n.fa-layers-counter {\n  background-color: #ff253a;\n  border-radius: 1em;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  color: #fff;\n  height: 1.5em;\n  line-height: 1;\n  max-width: 5em;\n  min-width: 1.5em;\n  overflow: hidden;\n  padding: .25em;\n  right: 0;\n  text-overflow: ellipsis;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right; }\n\n.fa-layers-bottom-right {\n  bottom: 0;\n  right: 0;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom right;\n          transform-origin: bottom right; }\n\n.fa-layers-bottom-left {\n  bottom: 0;\n  left: 0;\n  right: auto;\n  top: auto;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: bottom left;\n          transform-origin: bottom left; }\n\n.fa-layers-top-right {\n  right: 0;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top right;\n          transform-origin: top right; }\n\n.fa-layers-top-left {\n  left: 0;\n  right: auto;\n  top: 0;\n  -webkit-transform: scale(0.25);\n          transform: scale(0.25);\n  -webkit-transform-origin: top left;\n          transform-origin: top left; }\n\n.fa-lg {\n  font-size: 1.33333em;\n  line-height: 0.75em;\n  vertical-align: -.0667em; }\n\n.fa-xs {\n  font-size: .75em; }\n\n.fa-sm {\n  font-size: .875em; }\n\n.fa-1x {\n  font-size: 1em; }\n\n.fa-2x {\n  font-size: 2em; }\n\n.fa-3x {\n  font-size: 3em; }\n\n.fa-4x {\n  font-size: 4em; }\n\n.fa-5x {\n  font-size: 5em; }\n\n.fa-6x {\n  font-size: 6em; }\n\n.fa-7x {\n  font-size: 7em; }\n\n.fa-8x {\n  font-size: 8em; }\n\n.fa-9x {\n  font-size: 9em; }\n\n.fa-10x {\n  font-size: 10em; }\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em; }\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: 2.5em;\n  padding-left: 0; }\n  .fa-ul > li {\n    position: relative; }\n\n.fa-li {\n  left: -2em;\n  position: absolute;\n  text-align: center;\n  width: 2em;\n  line-height: inherit; }\n\n.fa-border {\n  border: solid 0.08em #eee;\n  border-radius: .1em;\n  padding: .2em .25em .15em; }\n\n.fa-pull-left {\n  float: left; }\n\n.fa-pull-right {\n  float: right; }\n\n.fa.fa-pull-left,\n.fas.fa-pull-left,\n.far.fa-pull-left,\n.fal.fa-pull-left,\n.fab.fa-pull-left {\n  margin-right: .3em; }\n\n.fa.fa-pull-right,\n.fas.fa-pull-right,\n.far.fa-pull-right,\n.fal.fa-pull-right,\n.fab.fa-pull-right {\n  margin-left: .3em; }\n\n.fa-spin {\n  -webkit-animation: fa-spin 2s infinite linear;\n          animation: fa-spin 2s infinite linear; }\n\n.fa-pulse {\n  -webkit-animation: fa-spin 1s infinite steps(8);\n          animation: fa-spin 1s infinite steps(8); }\n\n@-webkit-keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg); } }\n\n@keyframes fa-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n            transform: rotate(0deg); }\n  100% {\n    -webkit-transform: rotate(360deg);\n            transform: rotate(360deg); } }\n\n.fa-rotate-90 {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=1)\";\n  -webkit-transform: rotate(90deg);\n          transform: rotate(90deg); }\n\n.fa-rotate-180 {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=2)\";\n  -webkit-transform: rotate(180deg);\n          transform: rotate(180deg); }\n\n.fa-rotate-270 {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=3)\";\n  -webkit-transform: rotate(270deg);\n          transform: rotate(270deg); }\n\n.fa-flip-horizontal {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=0, mirror=1)\";\n  -webkit-transform: scale(-1, 1);\n          transform: scale(-1, 1); }\n\n.fa-flip-vertical {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)\";\n  -webkit-transform: scale(1, -1);\n          transform: scale(1, -1); }\n\n.fa-flip-horizontal.fa-flip-vertical {\n  -ms-filter: \"progid:DXImageTransform.Microsoft.BasicImage(rotation=2, mirror=1)\";\n  -webkit-transform: scale(-1, -1);\n          transform: scale(-1, -1); }\n\n:root .fa-rotate-90,\n:root .fa-rotate-180,\n:root .fa-rotate-270,\n:root .fa-flip-horizontal,\n:root .fa-flip-vertical {\n  -webkit-filter: none;\n          filter: none; }\n\n.fa-stack {\n  display: inline-block;\n  height: 2em;\n  position: relative;\n  width: 2em; }\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0; }\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1em; }\n\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2em; }\n\n.fa-inverse {\n  color: #fff; }\n\n.sr-only {\n  border: 0;\n  clip: rect(0, 0, 0, 0);\n  height: 1px;\n  margin: -1px;\n  overflow: hidden;\n  padding: 0;\n  position: absolute;\n  width: 1px; }\n\n.sr-only-focusable:active, .sr-only-focusable:focus {\n  clip: auto;\n  height: auto;\n  margin: 0;\n  overflow: visible;\n  position: static;\n  width: auto; }\n";

    var css = function () {
      var dfp = DEFAULT_FAMILY_PREFIX;
      var drc = DEFAULT_REPLACEMENT_CLASS;
      var fp = config.familyPrefix;
      var rc = config.replacementClass;
      var s = baseStyles;

      if (fp !== dfp || rc !== drc) {
        var dPatt = new RegExp('\\.' + dfp + '\\-', 'g');
        var rPatt = new RegExp('\\.' + drc, 'g');

        s = s.replace(dPatt, '.' + fp + '-').replace(rPatt, '.' + rc);
      }

      return s;
    };

    function define(prefix, icons) {
      var normalized = Object.keys(icons).reduce(function (acc, iconName) {
        var icon = icons[iconName];
        var expanded = !!icon.icon;

        if (expanded) {
          acc[icon.iconName] = icon.icon;
        } else {
          acc[iconName] = icon;
        }
        return acc;
      }, {});

      if (typeof namespace.hooks.addPack === 'function') {
        namespace.hooks.addPack(prefix, normalized);
      } else {
        namespace.styles[prefix] = _extends({}, namespace.styles[prefix] || {}, normalized);
      }

      /**
       * Font Awesome 4 used the prefix of `fa` for all icons. With the introduction
       * of new styles we needed to differentiate between them. Prefix `fa` is now an alias
       * for `fas` so we'll easy the upgrade process for our users by automatically defining
       * this as well.
       */
      if (prefix === 'fas') {
        define('fa', icons);
      }
    }

    var Library = function () {
      function Library() {
        classCallCheck(this, Library);

        this.definitions = {};
      }

      createClass(Library, [{
        key: 'add',
        value: function add() {
          var _this = this;

          for (var _len = arguments.length, definitions = Array(_len), _key = 0; _key < _len; _key++) {
            definitions[_key] = arguments[_key];
          }

          var additions = definitions.reduce(this._pullDefinitions, {});

          Object.keys(additions).forEach(function (key) {
            _this.definitions[key] = _extends({}, _this.definitions[key] || {}, additions[key]);
            define(key, additions[key]);
            build();
          });
        }
      }, {
        key: 'reset',
        value: function reset() {
          this.definitions = {};
        }
      }, {
        key: '_pullDefinitions',
        value: function _pullDefinitions(additions, definition) {
          var normalized = definition.prefix && definition.iconName && definition.icon ? { 0: definition } : definition;

          Object.keys(normalized).map(function (key) {
            var _normalized$key = normalized[key],
                prefix = _normalized$key.prefix,
                iconName = _normalized$key.iconName,
                icon = _normalized$key.icon;


            if (!additions[prefix]) additions[prefix] = {};

            additions[prefix][iconName] = icon;
          });

          return additions;
        }
      }]);
      return Library;
    }();

    function prepIcon(icon) {
      var width = icon[0];
      var height = icon[1];
      var vectorData = icon.slice(4);

      return {
        found: true,
        width: width,
        height: height,
        icon: { tag: 'path', attributes: { fill: 'currentColor', d: vectorData[0] } }
      };
    }

    function ensureCss() {
      if (config.autoAddCss && !_cssInserted) {
        insertCss(css());
        _cssInserted = true;
      }
    }

    function apiObject(val, abstractCreator) {
      Object.defineProperty(val, 'abstract', {
        get: abstractCreator
      });

      Object.defineProperty(val, 'html', {
        get: function get() {
          return val.abstract.map(function (a) {
            return toHtml(a);
          });
        }
      });

      Object.defineProperty(val, 'node', {
        get: function get() {
          if (!IS_DOM) return;

          var container = DOCUMENT.createElement('div');
          container.innerHTML = val.html;
          return container.children;
        }
      });

      return val;
    }

    function findIconDefinition(params) {
      var _params$prefix = params.prefix,
          prefix = _params$prefix === undefined ? 'fa' : _params$prefix,
          iconName = params.iconName;


      if (!iconName) return;

      return iconFromMapping(library.definitions, prefix, iconName) || iconFromMapping(namespace.styles, prefix, iconName);
    }

    function resolveIcons(next) {
      return function (maybeIconDefinition) {
        var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};

        var iconDefinition = (maybeIconDefinition || {}).icon ? maybeIconDefinition : findIconDefinition(maybeIconDefinition || {});

        var mask = params.mask;


        if (mask) {
          mask = (mask || {}).icon ? mask : findIconDefinition(mask || {});
        }

        return next(iconDefinition, _extends({}, params, { mask: mask }));
      };
    }

    var library = new Library();

    var _cssInserted = false;

    var parse = {
      transform: function transform(transformString) {
        return parseTransformString(transformString);
      }
    };

    var icon = resolveIcons(function (iconDefinition) {
      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
      var _params$transform = params.transform,
          transform = _params$transform === undefined ? meaninglessTransform : _params$transform,
          _params$symbol = params.symbol,
          symbol = _params$symbol === undefined ? false : _params$symbol,
          _params$mask = params.mask,
          mask = _params$mask === undefined ? null : _params$mask,
          _params$title = params.title,
          title = _params$title === undefined ? null : _params$title,
          _params$classes = params.classes,
          classes = _params$classes === undefined ? [] : _params$classes,
          _params$attributes = params.attributes,
          attributes = _params$attributes === undefined ? {} : _params$attributes,
          _params$styles = params.styles,
          styles = _params$styles === undefined ? {} : _params$styles;


      if (!iconDefinition) return;

      var prefix = iconDefinition.prefix,
          iconName = iconDefinition.iconName,
          icon = iconDefinition.icon;


      return apiObject(_extends({ type: 'icon' }, iconDefinition), function () {
        ensureCss();

        if (config.autoA11y) {
          if (title) {
            attributes['aria-labelledby'] = config.replacementClass + '-title-' + nextUniqueId();
          } else {
            attributes['aria-hidden'] = 'true';
          }
        }

        return makeInlineSvgAbstract({
          icons: {
            main: prepIcon(icon),
            mask: mask ? prepIcon(mask.icon) : { found: false, width: null, height: null, icon: {} }
          },
          prefix: prefix,
          iconName: iconName,
          transform: _extends({}, meaninglessTransform, transform),
          symbol: symbol,
          title: title,
          extra: {
            attributes: attributes,
            styles: styles,
            classes: classes
          }
        });
      });
    });

    /*!
     * Font Awesome Free 5.3.1 by @fontawesome - https://fontawesome.com
     * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
     */
    var faAngleLeft = { prefix: 'fas', iconName: 'angle-left', icon: [256, 512, [], "f104", "M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"] };
    var faAngleRight = { prefix: 'fas', iconName: 'angle-right', icon: [256, 512, [], "f105", "M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"] };
    var faCheck = { prefix: 'fas', iconName: 'check', icon: [512, 512, [], "f00c", "M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z"] };
    var faColumns = { prefix: 'fas', iconName: 'columns', icon: [512, 512, [], "f0db", "M464 32H48C21.49 32 0 53.49 0 80v352c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V80c0-26.51-21.49-48-48-48zM224 416H64V160h160v256zm224 0H288V160h160v256z"] };
    var faDatabase = { prefix: 'fas', iconName: 'database', icon: [448, 512, [], "f1c0", "M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z"] };
    var faFilter = { prefix: 'fas', iconName: 'filter', icon: [512, 512, [], "f0b0", "M487.976 0H24.028C2.71 0-8.047 25.866 7.058 40.971L192 225.941V432c0 7.831 3.821 15.17 10.237 19.662l80 55.98C298.02 518.69 320 507.493 320 487.98V225.941l184.947-184.97C520.021 25.896 509.338 0 487.976 0z"] };
    var faPlus = { prefix: 'fas', iconName: 'plus', icon: [448, 512, [], "f067", "M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"] };
    var faSort = { prefix: 'fas', iconName: 'sort', icon: [320, 512, [], "f0dc", "M41 288h238c21.4 0 32.1 25.9 17 41L177 448c-9.4 9.4-24.6 9.4-33.9 0L24 329c-15.1-15.1-4.4-41 17-41zm255-105L177 64c-9.4-9.4-24.6-9.4-33.9 0L24 183c-15.1 15.1-4.4 41 17 41h238c21.4 0 32.1-25.9 17-41z"] };
    var faSortAmountDown = { prefix: 'fas', iconName: 'sort-amount-down', icon: [512, 512, [], "f160", "M187.298 395.314l-79.984 80.002c-6.248 6.247-16.383 6.245-22.627 0L4.705 395.314C-5.365 385.244 1.807 368 16.019 368H64V48c0-8.837 7.163-16 16-16h32c8.837 0 16 7.163 16 16v320h47.984c14.241 0 21.363 17.264 11.314 27.314zM240 96h256c8.837 0 16-7.163 16-16V48c0-8.837-7.163-16-16-16H240c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16zm-16 112v-32c0-8.837 7.163-16 16-16h192c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16H240c-8.837 0-16-7.163-16-16zm0 256v-32c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16h-64c-8.837 0-16-7.163-16-16zm0-128v-32c0-8.837 7.163-16 16-16h128c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16H240c-8.837 0-16-7.163-16-16z"] };
    var faSortAmountUp = { prefix: 'fas', iconName: 'sort-amount-up', icon: [512, 512, [], "f161", "M4.702 116.686l79.984-80.002c6.248-6.247 16.383-6.245 22.627 0l79.981 80.002c10.07 10.07 2.899 27.314-11.314 27.314H128v320c0 8.837-7.163 16-16 16H80c-8.837 0-16-7.163-16-16V144H16.016c-14.241 0-21.363-17.264-11.314-27.314zM240 96h256c8.837 0 16-7.163 16-16V48c0-8.837-7.163-16-16-16H240c-8.837 0-16 7.163-16 16v32c0 8.837 7.163 16 16 16zm-16 112v-32c0-8.837 7.163-16 16-16h192c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16H240c-8.837 0-16-7.163-16-16zm0 256v-32c0-8.837 7.163-16 16-16h64c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16h-64c-8.837 0-16-7.163-16-16zm0-128v-32c0-8.837 7.163-16 16-16h128c8.837 0 16 7.163 16 16v32c0 8.837-7.163 16-16 16H240c-8.837 0-16-7.163-16-16z"] };
    var faTimes = { prefix: 'fas', iconName: 'times', icon: [352, 512, [], "f00d", "M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"] };

    var commonjsGlobal = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

    function createCommonjsModule(fn, module) {
    	return module = { exports: {} }, fn(module, module.exports), module.exports;
    }

    var humps = createCommonjsModule(function (module) {
    (function(global) {

      var _processKeys = function(convert, obj, options) {
        if(!_isObject(obj) || _isDate(obj) || _isRegExp(obj) || _isBoolean(obj) || _isFunction(obj)) {
          return obj;
        }

        var output,
            i = 0,
            l = 0;

        if(_isArray(obj)) {
          output = [];
          for(l=obj.length; i<l; i++) {
            output.push(_processKeys(convert, obj[i], options));
          }
        }
        else {
          output = {};
          for(var key in obj) {
            if(Object.prototype.hasOwnProperty.call(obj, key)) {
              output[convert(key, options)] = _processKeys(convert, obj[key], options);
            }
          }
        }
        return output;
      };

      // String conversion methods

      var separateWords = function(string, options) {
        options = options || {};
        var separator = options.separator || '_';
        var split = options.split || /(?=[A-Z])/;

        return string.split(split).join(separator);
      };

      var camelize = function(string) {
        if (_isNumerical(string)) {
          return string;
        }
        string = string.replace(/[\-_\s]+(.)?/g, function(match, chr) {
          return chr ? chr.toUpperCase() : '';
        });
        // Ensure 1st char is always lowercase
        return string.substr(0, 1).toLowerCase() + string.substr(1);
      };

      var pascalize = function(string) {
        var camelized = camelize(string);
        // Ensure 1st char is always uppercase
        return camelized.substr(0, 1).toUpperCase() + camelized.substr(1);
      };

      var decamelize = function(string, options) {
        return separateWords(string, options).toLowerCase();
      };

      // Utilities
      // Taken from Underscore.js

      var toString = Object.prototype.toString;

      var _isFunction = function(obj) {
        return typeof(obj) === 'function';
      };
      var _isObject = function(obj) {
        return obj === Object(obj);
      };
      var _isArray = function(obj) {
        return toString.call(obj) == '[object Array]';
      };
      var _isDate = function(obj) {
        return toString.call(obj) == '[object Date]';
      };
      var _isRegExp = function(obj) {
        return toString.call(obj) == '[object RegExp]';
      };
      var _isBoolean = function(obj) {
        return toString.call(obj) == '[object Boolean]';
      };

      // Performant way to determine if obj coerces to a number
      var _isNumerical = function(obj) {
        obj = obj - 0;
        return obj === obj;
      };

      // Sets up function which handles processing keys
      // allowing the convert function to be modified by a callback
      var _processor = function(convert, options) {
        var callback = options && 'process' in options ? options.process : options;

        if(typeof(callback) !== 'function') {
          return convert;
        }

        return function(string, options) {
          return callback(string, convert, options);
        }
      };

      var humps = {
        camelize: camelize,
        decamelize: decamelize,
        pascalize: pascalize,
        depascalize: decamelize,
        camelizeKeys: function(object, options) {
          return _processKeys(_processor(camelize, options), object);
        },
        decamelizeKeys: function(object, options) {
          return _processKeys(_processor(decamelize, options), object, options);
        },
        pascalizeKeys: function(object, options) {
          return _processKeys(_processor(pascalize, options), object);
        },
        depascalizeKeys: function () {
          return this.decamelizeKeys.apply(this, arguments);
        }
      };

      if (module.exports) {
        module.exports = humps;
      } else {
        global.humps = humps;
      }

    })(commonjsGlobal);
    });

    var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) {
      return typeof obj;
    } : function (obj) {
      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
    };

    var defineProperty = function (obj, key, value) {
      if (key in obj) {
        Object.defineProperty(obj, key, {
          value: value,
          enumerable: true,
          configurable: true,
          writable: true
        });
      } else {
        obj[key] = value;
      }

      return obj;
    };

    var _extends$1 = Object.assign || function (target) {
      for (var i = 1; i < arguments.length; i++) {
        var source = arguments[i];

        for (var key in source) {
          if (Object.prototype.hasOwnProperty.call(source, key)) {
            target[key] = source[key];
          }
        }
      }

      return target;
    };

    var objectWithoutProperties = function (obj, keys) {
      var target = {};

      for (var i in obj) {
        if (keys.indexOf(i) >= 0) continue;
        if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;
        target[i] = obj[i];
      }

      return target;
    };

    var toConsumableArray$1 = function (arr) {
      if (Array.isArray(arr)) {
        for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i];

        return arr2;
      } else {
        return Array.from(arr);
      }
    };

    function capitalize(val) {
      return val.charAt(0).toUpperCase() + val.slice(1);
    }

    function styleToObject(style) {
      return style.split(';').map(function (s) {
        return s.trim();
      }).filter(function (s) {
        return s;
      }).reduce(function (acc, pair) {
        var i = pair.indexOf(':');
        var prop = humps.camelize(pair.slice(0, i));
        var value = pair.slice(i + 1).trim();

        prop.startsWith('webkit') ? acc[capitalize(prop)] = value : acc[prop] = value;

        return acc;
      }, {});
    }

    function convert(createElement, element) {
      var extraProps = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};

      if (typeof element === 'string') {
        return element;
      }
      var children = (element.children || []).map(convert.bind(null, createElement));

      var mixins = Object.keys(element.attributes || {}).reduce(function (acc, key) {
        var val = element.attributes[key];

        switch (key) {
          case 'class':
            acc.attrs['className'] = val;
            delete element.attributes['class'];
            break;
          case 'style':
            acc.attrs['style'] = styleToObject(val);
            break;
          default:
            if (key.indexOf('aria-') === 0 || key.indexOf('data-') === 0) {
              acc.attrs[key.toLowerCase()] = val;
            } else {
              acc.attrs[humps.camelize(key)] = val;
            }
        }

        return acc;
      }, { attrs: {} });

      var _extraProps$style = extraProps.style,
          existingStyle = _extraProps$style === undefined ? {} : _extraProps$style,
          remaining = objectWithoutProperties(extraProps, ['style']);


      mixins.attrs['style'] = _extends$1({}, mixins.attrs['style'], existingStyle);

      return createElement.apply(undefined, [element.tag, _extends$1({}, mixins.attrs, remaining)].concat(toConsumableArray$1(children)));
    }

    var PRODUCTION$1 = false;

    try {
      PRODUCTION$1 = process.env.NODE_ENV === 'production';
    } catch (e) {}

    function log () {
      if (!PRODUCTION$1 && console && typeof console.error === 'function') {
        var _console;

        (_console = console).error.apply(_console, arguments);
      }
    }

    function objectWithKey(key, value) {
      return Array.isArray(value) && value.length > 0 || !Array.isArray(value) && value ? defineProperty({}, key, value) : {};
    }

    function classList(props) {
      var _classes;

      var classes = (_classes = {
        'fa-spin': props.spin,
        'fa-pulse': props.pulse,
        'fa-fw': props.fixedWidth,
        'fa-inverse': props.inverse,
        'fa-border': props.border,
        'fa-li': props.listItem,
        'fa-flip-horizontal': props.flip === 'horizontal' || props.flip === 'both',
        'fa-flip-vertical': props.flip === 'vertical' || props.flip === 'both'
      }, defineProperty(_classes, 'fa-' + props.size, props.size !== null), defineProperty(_classes, 'fa-rotate-' + props.rotation, props.rotation !== null), defineProperty(_classes, 'fa-pull-' + props.pull, props.pull !== null), _classes);

      return Object.keys(classes).map(function (key) {
        return classes[key] ? key : null;
      }).filter(function (key) {
        return key;
      });
    }

    function normalizeIconArgs(icon$$1) {
      if (icon$$1 === null) {
        return null;
      }

      if ((typeof icon$$1 === 'undefined' ? 'undefined' : _typeof(icon$$1)) === 'object' && icon$$1.prefix && icon$$1.iconName) {
        return icon$$1;
      }

      if (Array.isArray(icon$$1) && icon$$1.length === 2) {
        return { prefix: icon$$1[0], iconName: icon$$1[1] };
      }

      if (typeof icon$$1 === 'string') {
        return { prefix: 'fas', iconName: icon$$1 };
      }
    }

    function FontAwesomeIcon(props) {
      var iconArgs = props.icon,
          maskArgs = props.mask,
          symbol = props.symbol,
          className = props.className,
          title = props.title;


      var iconLookup = normalizeIconArgs(iconArgs);
      var classes = objectWithKey('classes', [].concat(toConsumableArray$1(classList(props)), toConsumableArray$1(className.split(' '))));
      var transform = objectWithKey('transform', typeof props.transform === 'string' ? parse.transform(props.transform) : props.transform);
      var mask = objectWithKey('mask', normalizeIconArgs(maskArgs));

      var renderedIcon = icon(iconLookup, _extends$1({}, classes, transform, mask, {
        symbol: symbol,
        title: title
      }));

      if (!renderedIcon) {
        log('Could not find icon', iconLookup);
        return null;
      }

      var abstract = renderedIcon.abstract;

      var extraProps = {};

      Object.keys(props).forEach(function (key) {
        if (!FontAwesomeIcon.defaultProps.hasOwnProperty(key)) {
          extraProps[key] = props[key];
        }
      });

      return convertCurry(abstract[0], extraProps);
    }

    FontAwesomeIcon.displayName = 'FontAwesomeIcon';

    FontAwesomeIcon.propTypes = {
      border: PropTypes__default.bool,

      className: PropTypes__default.string,

      mask: PropTypes__default.oneOfType([PropTypes__default.object, PropTypes__default.array, PropTypes__default.string]),

      fixedWidth: PropTypes__default.bool,

      inverse: PropTypes__default.bool,

      flip: PropTypes__default.oneOf(['horizontal', 'vertical', 'both']),

      icon: PropTypes__default.oneOfType([PropTypes__default.object, PropTypes__default.array, PropTypes__default.string]),

      listItem: PropTypes__default.bool,

      pull: PropTypes__default.oneOf(['right', 'left']),

      pulse: PropTypes__default.bool,

      rotation: PropTypes__default.oneOf([90, 180, 270]),

      size: PropTypes__default.oneOf(['lg', 'xs', 'sm', '1x', '2x', '3x', '4x', '5x', '6x', '7x', '8x', '9x', '10x']),

      spin: PropTypes__default.bool,

      symbol: PropTypes__default.oneOfType([PropTypes__default.bool, PropTypes__default.string]),

      title: PropTypes__default.string,

      transform: PropTypes__default.oneOfType([PropTypes__default.string, PropTypes__default.object])
    };

    FontAwesomeIcon.defaultProps = {
      border: false,
      className: '',
      mask: null,
      fixedWidth: false,
      inverse: false,
      flip: null,
      icon: null,
      listItem: false,
      pull: null,
      pulse: false,
      rotation: null,
      size: null,
      spin: false,
      symbol: false,
      title: '',
      transform: null
    };

    var convertCurry = convert.bind(null, React__default.createElement);

    var COLOR_PALETTE_EVEN = [
        'rgb(91,176,181)',
        'rgb(124,192,196)',
        'rgb(157,208,211)',
        'rgb(189,223,225)',
        'rgb(222,239,240)',
        'rgb(217,229,236)',
        'rgb(179,202,217)',
        'rgb(140,176,198)',
        'rgb(102,149,179)',
        'rgb(64,123,160)',
        'rgb(201,66,129)',
        'rgb(212,104,154)',
        'rgb(223,142,179)',
        'rgb(233,179,205)',
        'rgb(244,217,230)',
        'rgb(218,214,229)',
        'rgb(181,173,203)',
        'rgb(145,133,177)',
        'rgb(108,92,151)',
        'rgb(71,51,125)',
        'rgb(222,154,31)',
        'rgb(229,174,76)',
        'rgb(235,194,121)',
        'rgb(242,215,165)',
        'rgb(248,235,210)',
        'rgb(207,234,231)',
        'rgb(159,212,207)',
        'rgb(112,191,184)',
        'rgb(64,169,160)',
        'rgb(16,148,136)',
        'rgb(60,74,99)',
        'rgb(99,110,130)',
        'rgb(138,146,161)',
        'rgb(177,183,193)',
        'rgb(216,219,224)',
        'rgb(246,226,210)',
        'rgb(238,197,165)',
        'rgb(229,167,120)',
        'rgb(221,138,75)',
        'rgb(212,109,30)',
        'rgb(88,161,88)',
        'rgb(121,180,121)',
        'rgb(155,199,155)',
        'rgb(188,217,188)',
        'rgb(222,236,222)',
        'rgb(220,227,242)',
        'rgb(185,198,230)',
        'rgb(151,170,217)',
        'rgb(116,141,205)',
        'rgb(81,113,192)',
        'rgb(178,36,42)',
        'rgb(193,80,85)',
        'rgb(209,124,127)',
        'rgb(224,167,170)',
        'rgb(240,211,212)',
        'rgb(222,239,240)',
        'rgb(189,223,225)',
        'rgb(157,208,211)',
        'rgb(124,192,196)',
        'rgb(91,176,181)',
        'rgb(64,123,160)',
        'rgb(102,149,179)',
        'rgb(140,176,198)',
        'rgb(179,202,217)',
        'rgb(217,229,236)',
        'rgb(244,217,230)',
        'rgb(233,179,205)',
        'rgb(223,142,179)',
        'rgb(212,104,154)',
        'rgb(201,66,129)',
        'rgb(71,51,125)',
        'rgb(108,92,151)',
        'rgb(145,133,177)',
        'rgb(181,173,203)',
        'rgb(218,214,229)',
        'rgb(248,235,210)',
        'rgb(242,215,165)',
        'rgb(235,194,121)',
        'rgb(229,174,76)',
        'rgb(222,154,31)',
        'rgb(16,148,136)',
        'rgb(64,169,160)',
        'rgb(112,191,184)',
        'rgb(159,212,207)',
        'rgb(207,234,231)',
        'rgb(216,219,224)',
        'rgb(177,183,193)',
        'rgb(138,146,161)',
        'rgb(99,110,130)',
        'rgb(60,74,99)',
        'rgb(212,109,30)',
        'rgb(221,138,75)',
        'rgb(229,167,120)',
        'rgb(238,197,165)',
        'rgb(246,226,210)',
        'rgb(222,236,222)',
        'rgb(188,217,188)',
        'rgb(155,199,155)',
        'rgb(121,180,121)',
        'rgb(88,161,88)',
        'rgb(81,113,192)',
        'rgb(116,141,205)',
        'rgb(151,170,217)',
        'rgb(185,198,230)',
        'rgb(220,227,242)',
        'rgb(240,211,212)',
        'rgb(224,167,170)',
        'rgb(209,124,127)',
        'rgb(193,80,85)',
        'rgb(178,36,42)'
    ];
    var COLOR_PALETTE_ODD = [
        'rgb(64,123,160)',
        'rgb(102,149,179)',
        'rgb(140,176,198)',
        'rgb(179,202,217)',
        'rgb(217,229,236)',
        'rgb(244,217,230)',
        'rgb(233,179,205)',
        'rgb(223,142,179)',
        'rgb(212,104,154)',
        'rgb(201,66,129)',
        'rgb(71,51,125)',
        'rgb(108,92,151)',
        'rgb(145,133,177)',
        'rgb(181,173,203)',
        'rgb(218,214,229)',
        'rgb(248,235,210)',
        'rgb(242,215,165)',
        'rgb(235,194,121)',
        'rgb(229,174,76)',
        'rgb(222,154,31)',
        'rgb(16,148,136)',
        'rgb(64,169,160)',
        'rgb(112,191,184)',
        'rgb(159,212,207)',
        'rgb(207,234,231)',
        'rgb(216,219,224)',
        'rgb(177,183,193)',
        'rgb(138,146,161)',
        'rgb(99,110,130)',
        'rgb(60,74,99)',
        'rgb(212,109,30)',
        'rgb(221,138,75)',
        'rgb(229,167,120)',
        'rgb(238,197,165)',
        'rgb(246,226,210)',
        'rgb(222,236,222)',
        'rgb(188,217,188)',
        'rgb(155,199,155)',
        'rgb(121,180,121)',
        'rgb(88,161,88)',
        'rgb(81,113,192)',
        'rgb(116,141,205)',
        'rgb(151,170,217)',
        'rgb(185,198,230)',
        'rgb(220,227,242)',
        'rgb(240,211,212)',
        'rgb(224,167,170)',
        'rgb(209,124,127)',
        'rgb(193,80,85)',
        'rgb(178,36,42)',
        'rgb(91,176,181)',
        'rgb(124,192,196)',
        'rgb(157,208,211)',
        'rgb(189,223,225)',
        'rgb(222,239,240)',
        'rgb(217,229,236)',
        'rgb(179,202,217)',
        'rgb(140,176,198)',
        'rgb(102,149,179)',
        'rgb(64,123,160)',
        'rgb(201,66,129)',
        'rgb(212,104,154)',
        'rgb(223,142,179)',
        'rgb(233,179,205)',
        'rgb(244,217,230)',
        'rgb(218,214,229)',
        'rgb(181,173,203)',
        'rgb(145,133,177)',
        'rgb(108,92,151)',
        'rgb(71,51,125)',
        'rgb(222,154,31)',
        'rgb(229,174,76)',
        'rgb(235,194,121)',
        'rgb(242,215,165)',
        'rgb(248,235,210)',
        'rgb(207,234,231)',
        'rgb(159,212,207)',
        'rgb(112,191,184)',
        'rgb(64,169,160)',
        'rgb(16,148,136)',
        'rgb(60,74,99)',
        'rgb(99,110,130)',
        'rgb(138,146,161)',
        'rgb(177,183,193)',
        'rgb(216,219,224)',
        'rgb(246,226,210)',
        'rgb(238,197,165)',
        'rgb(229,167,120)',
        'rgb(221,138,75)',
        'rgb(212,109,30)',
        'rgb(88,161,88)',
        'rgb(121,180,121)',
        'rgb(155,199,155)',
        'rgb(188,217,188)',
        'rgb(222,236,222)',
        'rgb(220,227,242)',
        'rgb(185,198,230)',
        'rgb(151,170,217)',
        'rgb(116,141,205)',
        'rgb(81,113,192)',
        'rgb(178,36,42)',
        'rgb(193,80,85)',
        'rgb(209,124,127)',
        'rgb(224,167,170)',
        'rgb(240,211,212)',
        'rgb(222,239,240)',
        'rgb(189,223,225)',
        'rgb(157,208,211)',
        'rgb(124,192,196)',
        'rgb(91,176,181)'
    ];

    function getColorPallette(start, end) {
        var colorPalleteSelection = [];
        var textColors = [];
        var offset = -1;
        if (start % 2 === 0) {
            colorPalleteSelection = COLOR_PALETTE_EVEN;
            offset = start * 5;
        }
        else {
            colorPalleteSelection = COLOR_PALETTE_ODD;
            offset = (start - 1) * 5;
        }
        var colorPalette = [];
        for (var i = 0; i < end; i += 1) {
            var textColor = i % 10 < 2 || i % 10 > 7 ? 'white' : 'black';
            var color = "" + colorPalleteSelection[(offset + i) % colorPalleteSelection.length];
            colorPalette.push(color);
            textColors.push(textColor);
        }
        return { colorPalette: colorPalette, textColors: textColors };
    }

    /**
     * Removes all key-value entries from the list cache.
     *
     * @private
     * @name clear
     * @memberOf ListCache
     */
    function listCacheClear() {
      this.__data__ = [];
      this.size = 0;
    }

    var _listCacheClear = listCacheClear;

    /**
     * Performs a
     * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
     * comparison between two values to determine if they are equivalent.
     *
     * @static
     * @memberOf _
     * @since 4.0.0
     * @category Lang
     * @param {*} value The value to compare.
     * @param {*} other The other value to compare.
     * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
     * @example
     *
     * var object = { 'a': 1 };
     * var other = { 'a': 1 };
     *
     * _.eq(object, object);
     * // => true
     *
     * _.eq(object, other);
     * // => false
     *
     * _.eq('a', 'a');
     * // => true
     *
     * _.eq('a', Object('a'));
     * // => false
     *
     * _.eq(NaN, NaN);
     * // => true
     */
    function eq(value, other) {
      return value === other || (value !== value && other !== other);
    }

    var eq_1 = eq;

    /**
     * Gets the index at which the `key` is found in `array` of key-value pairs.
     *
     * @private
     * @param {Array} array The array to inspect.
     * @param {*} key The key to search for.
     * @returns {number} Returns the index of the matched value, else `-1`.
     */
    function assocIndexOf(array, key) {
      var length = array.length;
      while (length--) {
        if (eq_1(array[length][0], key)) {
          return length;
        }
      }
      return -1;
    }

    var _assocIndexOf = assocIndexOf;

    /** Used for built-in method references. */
    var arrayProto = Array.prototype;

    /** Built-in value references. */
    var splice = arrayProto.splice;

    /**
     * Removes `key` and its value from the list cache.
     *
     * @private
     * @name delete
     * @memberOf ListCache
     * @param {string} key The key of the value to remove.
     * @returns {boolean} Returns `true` if the entry was removed, else `false`.
     */
    function listCacheDelete(key) {
      var data = this.__data__,
          index = _assocIndexOf(data, key);

      if (index < 0) {
        return false;
      }
      var lastIndex = data.length - 1;
      if (index == lastIndex) {
        data.pop();
      } else {
        splice.call(data, index, 1);
      }
      --this.size;
      return true;
    }

    var _listCacheDelete = listCacheDelete;

    /**
     * Gets the list cache value for `key`.
     *
     * @private
     * @name get
     * @memberOf ListCache
     * @param {string} key The key of the value to get.
     * @returns {*} Returns the entry value.
     */
    function listCacheGet(key) {
      var data = this.__data__,
          index = _assocIndexOf(data, key);

      return index < 0 ? undefined : data[index][1];
    }

    var _listCacheGet = listCacheGet;

    /**
     * Checks if a list cache value for `key` exists.
     *
     * @private
     * @name has
     * @memberOf ListCache
     * @param {string} key The key of the entry to check.
     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
     */
    function listCacheHas(key) {
      return _assocIndexOf(this.__data__, key) > -1;
    }

    var _listCacheHas = listCacheHas;

    /**
     * Sets the list cache `key` to `value`.
     *
     * @private
     * @name set
     * @memberOf ListCache
     * @param {string} key The key of the value to set.
     * @param {*} value The value to set.
     * @returns {Object} Returns the list cache instance.
     */
    function listCacheSet(key, value) {
      var data = this.__data__,
          index = _assocIndexOf(data, key);

      if (index < 0) {
        ++this.size;
        data.push([key, value]);
      } else {
        data[index][1] = value;
      }
      return this;
    }

    var _listCacheSet = listCacheSet;

    /**
     * Creates an list cache object.
     *
     * @private
     * @constructor
     * @param {Array} [entries] The key-value pairs to cache.
     */
    function ListCache(entries) {
      var index = -1,
          length = entries == null ? 0 : entries.length;

      this.clear();
      while (++index < length) {
        var entry = entries[index];
        this.set(entry[0], entry[1]);
      }
    }

    // Add methods to `ListCache`.
    ListCache.prototype.clear = _listCacheClear;
    ListCache.prototype['delete'] = _listCacheDelete;
    ListCache.prototype.get = _listCacheGet;
    ListCache.prototype.has = _listCacheHas;
    ListCache.prototype.set = _listCacheSet;

    var _ListCache = ListCache;

    /**
     * Removes all key-value entries from the stack.
     *
     * @private
     * @name clear
     * @memberOf Stack
     */
    function stackClear() {
      this.__data__ = new _ListCache;
      this.size = 0;
    }

    var _stackClear = stackClear;

    /**
     * Removes `key` and its value from the stack.
     *
     * @private
     * @name delete
     * @memberOf Stack
     * @param {string} key The key of the value to remove.
     * @returns {boolean} Returns `true` if the entry was removed, else `false`.
     */
    function stackDelete(key) {
      var data = this.__data__,
          result = data['delete'](key);

      this.size = data.size;
      return result;
    }

    var _stackDelete = stackDelete;

    /**
     * Gets the stack value for `key`.
     *
     * @private
     * @name get
     * @memberOf Stack
     * @param {string} key The key of the value to get.
     * @returns {*} Returns the entry value.
     */
    function stackGet(key) {
      return this.__data__.get(key);
    }

    var _stackGet = stackGet;

    /**
     * Checks if a stack value for `key` exists.
     *
     * @private
     * @name has
     * @memberOf Stack
     * @param {string} key The key of the entry to check.
     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
     */
    function stackHas(key) {
      return this.__data__.has(key);
    }

    var _stackHas = stackHas;

    var commonjsGlobal$1 = typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

    function createCommonjsModule$1(fn, module) {
    	return module = { exports: {} }, fn(module, module.exports), module.exports;
    }

    /** Detect free variable `global` from Node.js. */
    var freeGlobal = typeof commonjsGlobal$1 == 'object' && commonjsGlobal$1 && commonjsGlobal$1.Object === Object && commonjsGlobal$1;

    var _freeGlobal = freeGlobal;

    /** Detect free variable `self`. */
    var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

    /** Used as a reference to the global object. */
    var root = _freeGlobal || freeSelf || Function('return this')();

    var _root = root;

    /** Built-in value references. */
    var Symbol$1 = _root.Symbol;

    var _Symbol = Symbol$1;

    /** Used for built-in method references. */
    var objectProto = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty = objectProto.hasOwnProperty;

    /**
     * Used to resolve the
     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
     * of values.
     */
    var nativeObjectToString = objectProto.toString;

    /** Built-in value references. */
    var symToStringTag = _Symbol ? _Symbol.toStringTag : undefined;

    /**
     * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.
     *
     * @private
     * @param {*} value The value to query.
     * @returns {string} Returns the raw `toStringTag`.
     */
    function getRawTag(value) {
      var isOwn = hasOwnProperty.call(value, symToStringTag),
          tag = value[symToStringTag];

      try {
        value[symToStringTag] = undefined;
        var unmasked = true;
      } catch (e) {}

      var result = nativeObjectToString.call(value);
      if (unmasked) {
        if (isOwn) {
          value[symToStringTag] = tag;
        } else {
          delete value[symToStringTag];
        }
      }
      return result;
    }

    var _getRawTag = getRawTag;

    /** Used for built-in method references. */
    var objectProto$1 = Object.prototype;

    /**
     * Used to resolve the
     * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
     * of values.
     */
    var nativeObjectToString$1 = objectProto$1.toString;

    /**
     * Converts `value` to a string using `Object.prototype.toString`.
     *
     * @private
     * @param {*} value The value to convert.
     * @returns {string} Returns the converted string.
     */
    function objectToString(value) {
      return nativeObjectToString$1.call(value);
    }

    var _objectToString = objectToString;

    /** `Object#toString` result references. */
    var nullTag = '[object Null]',
        undefinedTag = '[object Undefined]';

    /** Built-in value references. */
    var symToStringTag$1 = _Symbol ? _Symbol.toStringTag : undefined;

    /**
     * The base implementation of `getTag` without fallbacks for buggy environments.
     *
     * @private
     * @param {*} value The value to query.
     * @returns {string} Returns the `toStringTag`.
     */
    function baseGetTag(value) {
      if (value == null) {
        return value === undefined ? undefinedTag : nullTag;
      }
      return (symToStringTag$1 && symToStringTag$1 in Object(value))
        ? _getRawTag(value)
        : _objectToString(value);
    }

    var _baseGetTag = baseGetTag;

    /**
     * Checks if `value` is the
     * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
     * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
     *
     * @static
     * @memberOf _
     * @since 0.1.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is an object, else `false`.
     * @example
     *
     * _.isObject({});
     * // => true
     *
     * _.isObject([1, 2, 3]);
     * // => true
     *
     * _.isObject(_.noop);
     * // => true
     *
     * _.isObject(null);
     * // => false
     */
    function isObject(value) {
      var type = typeof value;
      return value != null && (type == 'object' || type == 'function');
    }

    var isObject_1 = isObject;

    /** `Object#toString` result references. */
    var asyncTag = '[object AsyncFunction]',
        funcTag = '[object Function]',
        genTag = '[object GeneratorFunction]',
        proxyTag = '[object Proxy]';

    /**
     * Checks if `value` is classified as a `Function` object.
     *
     * @static
     * @memberOf _
     * @since 0.1.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a function, else `false`.
     * @example
     *
     * _.isFunction(_);
     * // => true
     *
     * _.isFunction(/abc/);
     * // => false
     */
    function isFunction(value) {
      if (!isObject_1(value)) {
        return false;
      }
      // The use of `Object#toString` avoids issues with the `typeof` operator
      // in Safari 9 which returns 'object' for typed arrays and other constructors.
      var tag = _baseGetTag(value);
      return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;
    }

    var isFunction_1 = isFunction;

    /** Used to detect overreaching core-js shims. */
    var coreJsData = _root['__core-js_shared__'];

    var _coreJsData = coreJsData;

    /** Used to detect methods masquerading as native. */
    var maskSrcKey = (function() {
      var uid = /[^.]+$/.exec(_coreJsData && _coreJsData.keys && _coreJsData.keys.IE_PROTO || '');
      return uid ? ('Symbol(src)_1.' + uid) : '';
    }());

    /**
     * Checks if `func` has its source masked.
     *
     * @private
     * @param {Function} func The function to check.
     * @returns {boolean} Returns `true` if `func` is masked, else `false`.
     */
    function isMasked(func) {
      return !!maskSrcKey && (maskSrcKey in func);
    }

    var _isMasked = isMasked;

    /** Used for built-in method references. */
    var funcProto = Function.prototype;

    /** Used to resolve the decompiled source of functions. */
    var funcToString = funcProto.toString;

    /**
     * Converts `func` to its source code.
     *
     * @private
     * @param {Function} func The function to convert.
     * @returns {string} Returns the source code.
     */
    function toSource(func) {
      if (func != null) {
        try {
          return funcToString.call(func);
        } catch (e) {}
        try {
          return (func + '');
        } catch (e) {}
      }
      return '';
    }

    var _toSource = toSource;

    /**
     * Used to match `RegExp`
     * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
     */
    var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

    /** Used to detect host constructors (Safari). */
    var reIsHostCtor = /^\[object .+?Constructor\]$/;

    /** Used for built-in method references. */
    var funcProto$1 = Function.prototype,
        objectProto$2 = Object.prototype;

    /** Used to resolve the decompiled source of functions. */
    var funcToString$1 = funcProto$1.toString;

    /** Used to check objects for own properties. */
    var hasOwnProperty$1 = objectProto$2.hasOwnProperty;

    /** Used to detect if a method is native. */
    var reIsNative = RegExp('^' +
      funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar, '\\$&')
      .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
    );

    /**
     * The base implementation of `_.isNative` without bad shim checks.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a native function,
     *  else `false`.
     */
    function baseIsNative(value) {
      if (!isObject_1(value) || _isMasked(value)) {
        return false;
      }
      var pattern = isFunction_1(value) ? reIsNative : reIsHostCtor;
      return pattern.test(_toSource(value));
    }

    var _baseIsNative = baseIsNative;

    /**
     * Gets the value at `key` of `object`.
     *
     * @private
     * @param {Object} [object] The object to query.
     * @param {string} key The key of the property to get.
     * @returns {*} Returns the property value.
     */
    function getValue(object, key) {
      return object == null ? undefined : object[key];
    }

    var _getValue = getValue;

    /**
     * Gets the native function at `key` of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @param {string} key The key of the method to get.
     * @returns {*} Returns the function if it's native, else `undefined`.
     */
    function getNative(object, key) {
      var value = _getValue(object, key);
      return _baseIsNative(value) ? value : undefined;
    }

    var _getNative = getNative;

    /* Built-in method references that are verified to be native. */
    var Map = _getNative(_root, 'Map');

    var _Map = Map;

    /* Built-in method references that are verified to be native. */
    var nativeCreate = _getNative(Object, 'create');

    var _nativeCreate = nativeCreate;

    /**
     * Removes all key-value entries from the hash.
     *
     * @private
     * @name clear
     * @memberOf Hash
     */
    function hashClear() {
      this.__data__ = _nativeCreate ? _nativeCreate(null) : {};
      this.size = 0;
    }

    var _hashClear = hashClear;

    /**
     * Removes `key` and its value from the hash.
     *
     * @private
     * @name delete
     * @memberOf Hash
     * @param {Object} hash The hash to modify.
     * @param {string} key The key of the value to remove.
     * @returns {boolean} Returns `true` if the entry was removed, else `false`.
     */
    function hashDelete(key) {
      var result = this.has(key) && delete this.__data__[key];
      this.size -= result ? 1 : 0;
      return result;
    }

    var _hashDelete = hashDelete;

    /** Used to stand-in for `undefined` hash values. */
    var HASH_UNDEFINED = '__lodash_hash_undefined__';

    /** Used for built-in method references. */
    var objectProto$3 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$2 = objectProto$3.hasOwnProperty;

    /**
     * Gets the hash value for `key`.
     *
     * @private
     * @name get
     * @memberOf Hash
     * @param {string} key The key of the value to get.
     * @returns {*} Returns the entry value.
     */
    function hashGet(key) {
      var data = this.__data__;
      if (_nativeCreate) {
        var result = data[key];
        return result === HASH_UNDEFINED ? undefined : result;
      }
      return hasOwnProperty$2.call(data, key) ? data[key] : undefined;
    }

    var _hashGet = hashGet;

    /** Used for built-in method references. */
    var objectProto$4 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$3 = objectProto$4.hasOwnProperty;

    /**
     * Checks if a hash value for `key` exists.
     *
     * @private
     * @name has
     * @memberOf Hash
     * @param {string} key The key of the entry to check.
     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
     */
    function hashHas(key) {
      var data = this.__data__;
      return _nativeCreate ? (data[key] !== undefined) : hasOwnProperty$3.call(data, key);
    }

    var _hashHas = hashHas;

    /** Used to stand-in for `undefined` hash values. */
    var HASH_UNDEFINED$1 = '__lodash_hash_undefined__';

    /**
     * Sets the hash `key` to `value`.
     *
     * @private
     * @name set
     * @memberOf Hash
     * @param {string} key The key of the value to set.
     * @param {*} value The value to set.
     * @returns {Object} Returns the hash instance.
     */
    function hashSet(key, value) {
      var data = this.__data__;
      this.size += this.has(key) ? 0 : 1;
      data[key] = (_nativeCreate && value === undefined) ? HASH_UNDEFINED$1 : value;
      return this;
    }

    var _hashSet = hashSet;

    /**
     * Creates a hash object.
     *
     * @private
     * @constructor
     * @param {Array} [entries] The key-value pairs to cache.
     */
    function Hash(entries) {
      var index = -1,
          length = entries == null ? 0 : entries.length;

      this.clear();
      while (++index < length) {
        var entry = entries[index];
        this.set(entry[0], entry[1]);
      }
    }

    // Add methods to `Hash`.
    Hash.prototype.clear = _hashClear;
    Hash.prototype['delete'] = _hashDelete;
    Hash.prototype.get = _hashGet;
    Hash.prototype.has = _hashHas;
    Hash.prototype.set = _hashSet;

    var _Hash = Hash;

    /**
     * Removes all key-value entries from the map.
     *
     * @private
     * @name clear
     * @memberOf MapCache
     */
    function mapCacheClear() {
      this.size = 0;
      this.__data__ = {
        'hash': new _Hash,
        'map': new (_Map || _ListCache),
        'string': new _Hash
      };
    }

    var _mapCacheClear = mapCacheClear;

    /**
     * Checks if `value` is suitable for use as unique object key.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
     */
    function isKeyable(value) {
      var type = typeof value;
      return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
        ? (value !== '__proto__')
        : (value === null);
    }

    var _isKeyable = isKeyable;

    /**
     * Gets the data for `map`.
     *
     * @private
     * @param {Object} map The map to query.
     * @param {string} key The reference key.
     * @returns {*} Returns the map data.
     */
    function getMapData(map, key) {
      var data = map.__data__;
      return _isKeyable(key)
        ? data[typeof key == 'string' ? 'string' : 'hash']
        : data.map;
    }

    var _getMapData = getMapData;

    /**
     * Removes `key` and its value from the map.
     *
     * @private
     * @name delete
     * @memberOf MapCache
     * @param {string} key The key of the value to remove.
     * @returns {boolean} Returns `true` if the entry was removed, else `false`.
     */
    function mapCacheDelete(key) {
      var result = _getMapData(this, key)['delete'](key);
      this.size -= result ? 1 : 0;
      return result;
    }

    var _mapCacheDelete = mapCacheDelete;

    /**
     * Gets the map value for `key`.
     *
     * @private
     * @name get
     * @memberOf MapCache
     * @param {string} key The key of the value to get.
     * @returns {*} Returns the entry value.
     */
    function mapCacheGet(key) {
      return _getMapData(this, key).get(key);
    }

    var _mapCacheGet = mapCacheGet;

    /**
     * Checks if a map value for `key` exists.
     *
     * @private
     * @name has
     * @memberOf MapCache
     * @param {string} key The key of the entry to check.
     * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
     */
    function mapCacheHas(key) {
      return _getMapData(this, key).has(key);
    }

    var _mapCacheHas = mapCacheHas;

    /**
     * Sets the map `key` to `value`.
     *
     * @private
     * @name set
     * @memberOf MapCache
     * @param {string} key The key of the value to set.
     * @param {*} value The value to set.
     * @returns {Object} Returns the map cache instance.
     */
    function mapCacheSet(key, value) {
      var data = _getMapData(this, key),
          size = data.size;

      data.set(key, value);
      this.size += data.size == size ? 0 : 1;
      return this;
    }

    var _mapCacheSet = mapCacheSet;

    /**
     * Creates a map cache object to store key-value pairs.
     *
     * @private
     * @constructor
     * @param {Array} [entries] The key-value pairs to cache.
     */
    function MapCache(entries) {
      var index = -1,
          length = entries == null ? 0 : entries.length;

      this.clear();
      while (++index < length) {
        var entry = entries[index];
        this.set(entry[0], entry[1]);
      }
    }

    // Add methods to `MapCache`.
    MapCache.prototype.clear = _mapCacheClear;
    MapCache.prototype['delete'] = _mapCacheDelete;
    MapCache.prototype.get = _mapCacheGet;
    MapCache.prototype.has = _mapCacheHas;
    MapCache.prototype.set = _mapCacheSet;

    var _MapCache = MapCache;

    /** Used as the size to enable large array optimizations. */
    var LARGE_ARRAY_SIZE = 200;

    /**
     * Sets the stack `key` to `value`.
     *
     * @private
     * @name set
     * @memberOf Stack
     * @param {string} key The key of the value to set.
     * @param {*} value The value to set.
     * @returns {Object} Returns the stack cache instance.
     */
    function stackSet(key, value) {
      var data = this.__data__;
      if (data instanceof _ListCache) {
        var pairs = data.__data__;
        if (!_Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {
          pairs.push([key, value]);
          this.size = ++data.size;
          return this;
        }
        data = this.__data__ = new _MapCache(pairs);
      }
      data.set(key, value);
      this.size = data.size;
      return this;
    }

    var _stackSet = stackSet;

    /**
     * Creates a stack cache object to store key-value pairs.
     *
     * @private
     * @constructor
     * @param {Array} [entries] The key-value pairs to cache.
     */
    function Stack(entries) {
      var data = this.__data__ = new _ListCache(entries);
      this.size = data.size;
    }

    // Add methods to `Stack`.
    Stack.prototype.clear = _stackClear;
    Stack.prototype['delete'] = _stackDelete;
    Stack.prototype.get = _stackGet;
    Stack.prototype.has = _stackHas;
    Stack.prototype.set = _stackSet;

    var _Stack = Stack;

    /**
     * A specialized version of `_.forEach` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns `array`.
     */
    function arrayEach(array, iteratee) {
      var index = -1,
          length = array == null ? 0 : array.length;

      while (++index < length) {
        if (iteratee(array[index], index, array) === false) {
          break;
        }
      }
      return array;
    }

    var _arrayEach = arrayEach;

    var defineProperty$1 = (function() {
      try {
        var func = _getNative(Object, 'defineProperty');
        func({}, '', {});
        return func;
      } catch (e) {}
    }());

    var _defineProperty = defineProperty$1;

    /**
     * The base implementation of `assignValue` and `assignMergeValue` without
     * value checks.
     *
     * @private
     * @param {Object} object The object to modify.
     * @param {string} key The key of the property to assign.
     * @param {*} value The value to assign.
     */
    function baseAssignValue(object, key, value) {
      if (key == '__proto__' && _defineProperty) {
        _defineProperty(object, key, {
          'configurable': true,
          'enumerable': true,
          'value': value,
          'writable': true
        });
      } else {
        object[key] = value;
      }
    }

    var _baseAssignValue = baseAssignValue;

    /** Used for built-in method references. */
    var objectProto$5 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$4 = objectProto$5.hasOwnProperty;

    /**
     * Assigns `value` to `key` of `object` if the existing value is not equivalent
     * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
     * for equality comparisons.
     *
     * @private
     * @param {Object} object The object to modify.
     * @param {string} key The key of the property to assign.
     * @param {*} value The value to assign.
     */
    function assignValue(object, key, value) {
      var objValue = object[key];
      if (!(hasOwnProperty$4.call(object, key) && eq_1(objValue, value)) ||
          (value === undefined && !(key in object))) {
        _baseAssignValue(object, key, value);
      }
    }

    var _assignValue = assignValue;

    /**
     * Copies properties of `source` to `object`.
     *
     * @private
     * @param {Object} source The object to copy properties from.
     * @param {Array} props The property identifiers to copy.
     * @param {Object} [object={}] The object to copy properties to.
     * @param {Function} [customizer] The function to customize copied values.
     * @returns {Object} Returns `object`.
     */
    function copyObject(source, props, object, customizer) {
      var isNew = !object;
      object || (object = {});

      var index = -1,
          length = props.length;

      while (++index < length) {
        var key = props[index];

        var newValue = customizer
          ? customizer(object[key], source[key], key, object, source)
          : undefined;

        if (newValue === undefined) {
          newValue = source[key];
        }
        if (isNew) {
          _baseAssignValue(object, key, newValue);
        } else {
          _assignValue(object, key, newValue);
        }
      }
      return object;
    }

    var _copyObject = copyObject;

    /**
     * The base implementation of `_.times` without support for iteratee shorthands
     * or max array length checks.
     *
     * @private
     * @param {number} n The number of times to invoke `iteratee`.
     * @param {Function} iteratee The function invoked per iteration.
     * @returns {Array} Returns the array of results.
     */
    function baseTimes(n, iteratee) {
      var index = -1,
          result = Array(n);

      while (++index < n) {
        result[index] = iteratee(index);
      }
      return result;
    }

    var _baseTimes = baseTimes;

    /**
     * Checks if `value` is object-like. A value is object-like if it's not `null`
     * and has a `typeof` result of "object".
     *
     * @static
     * @memberOf _
     * @since 4.0.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
     * @example
     *
     * _.isObjectLike({});
     * // => true
     *
     * _.isObjectLike([1, 2, 3]);
     * // => true
     *
     * _.isObjectLike(_.noop);
     * // => false
     *
     * _.isObjectLike(null);
     * // => false
     */
    function isObjectLike(value) {
      return value != null && typeof value == 'object';
    }

    var isObjectLike_1 = isObjectLike;

    /** `Object#toString` result references. */
    var argsTag = '[object Arguments]';

    /**
     * The base implementation of `_.isArguments`.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is an `arguments` object,
     */
    function baseIsArguments(value) {
      return isObjectLike_1(value) && _baseGetTag(value) == argsTag;
    }

    var _baseIsArguments = baseIsArguments;

    /** Used for built-in method references. */
    var objectProto$6 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$5 = objectProto$6.hasOwnProperty;

    /** Built-in value references. */
    var propertyIsEnumerable = objectProto$6.propertyIsEnumerable;

    /**
     * Checks if `value` is likely an `arguments` object.
     *
     * @static
     * @memberOf _
     * @since 0.1.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is an `arguments` object,
     *  else `false`.
     * @example
     *
     * _.isArguments(function() { return arguments; }());
     * // => true
     *
     * _.isArguments([1, 2, 3]);
     * // => false
     */
    var isArguments = _baseIsArguments(function() { return arguments; }()) ? _baseIsArguments : function(value) {
      return isObjectLike_1(value) && hasOwnProperty$5.call(value, 'callee') &&
        !propertyIsEnumerable.call(value, 'callee');
    };

    var isArguments_1 = isArguments;

    /**
     * Checks if `value` is classified as an `Array` object.
     *
     * @static
     * @memberOf _
     * @since 0.1.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is an array, else `false`.
     * @example
     *
     * _.isArray([1, 2, 3]);
     * // => true
     *
     * _.isArray(document.body.children);
     * // => false
     *
     * _.isArray('abc');
     * // => false
     *
     * _.isArray(_.noop);
     * // => false
     */
    var isArray = Array.isArray;

    var isArray_1 = isArray;

    /**
     * This method returns `false`.
     *
     * @static
     * @memberOf _
     * @since 4.13.0
     * @category Util
     * @returns {boolean} Returns `false`.
     * @example
     *
     * _.times(2, _.stubFalse);
     * // => [false, false]
     */
    function stubFalse() {
      return false;
    }

    var stubFalse_1 = stubFalse;

    var isBuffer_1 = createCommonjsModule$1(function (module, exports) {
    /** Detect free variable `exports`. */
    var freeExports = exports && !exports.nodeType && exports;

    /** Detect free variable `module`. */
    var freeModule = freeExports && 'object' == 'object' && module && !module.nodeType && module;

    /** Detect the popular CommonJS extension `module.exports`. */
    var moduleExports = freeModule && freeModule.exports === freeExports;

    /** Built-in value references. */
    var Buffer = moduleExports ? _root.Buffer : undefined;

    /* Built-in method references for those with the same name as other `lodash` methods. */
    var nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;

    /**
     * Checks if `value` is a buffer.
     *
     * @static
     * @memberOf _
     * @since 4.3.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.
     * @example
     *
     * _.isBuffer(new Buffer(2));
     * // => true
     *
     * _.isBuffer(new Uint8Array(2));
     * // => false
     */
    var isBuffer = nativeIsBuffer || stubFalse_1;

    module.exports = isBuffer;
    });

    /** Used as references for various `Number` constants. */
    var MAX_SAFE_INTEGER = 9007199254740991;

    /** Used to detect unsigned integer values. */
    var reIsUint = /^(?:0|[1-9]\d*)$/;

    /**
     * Checks if `value` is a valid array-like index.
     *
     * @private
     * @param {*} value The value to check.
     * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
     * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
     */
    function isIndex(value, length) {
      var type = typeof value;
      length = length == null ? MAX_SAFE_INTEGER : length;

      return !!length &&
        (type == 'number' ||
          (type != 'symbol' && reIsUint.test(value))) &&
            (value > -1 && value % 1 == 0 && value < length);
    }

    var _isIndex = isIndex;

    /** Used as references for various `Number` constants. */
    var MAX_SAFE_INTEGER$1 = 9007199254740991;

    /**
     * Checks if `value` is a valid array-like length.
     *
     * **Note:** This method is loosely based on
     * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
     *
     * @static
     * @memberOf _
     * @since 4.0.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
     * @example
     *
     * _.isLength(3);
     * // => true
     *
     * _.isLength(Number.MIN_VALUE);
     * // => false
     *
     * _.isLength(Infinity);
     * // => false
     *
     * _.isLength('3');
     * // => false
     */
    function isLength(value) {
      return typeof value == 'number' &&
        value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER$1;
    }

    var isLength_1 = isLength;

    /** `Object#toString` result references. */
    var argsTag$1 = '[object Arguments]',
        arrayTag = '[object Array]',
        boolTag = '[object Boolean]',
        dateTag = '[object Date]',
        errorTag = '[object Error]',
        funcTag$1 = '[object Function]',
        mapTag = '[object Map]',
        numberTag = '[object Number]',
        objectTag = '[object Object]',
        regexpTag = '[object RegExp]',
        setTag = '[object Set]',
        stringTag = '[object String]',
        weakMapTag = '[object WeakMap]';

    var arrayBufferTag = '[object ArrayBuffer]',
        dataViewTag = '[object DataView]',
        float32Tag = '[object Float32Array]',
        float64Tag = '[object Float64Array]',
        int8Tag = '[object Int8Array]',
        int16Tag = '[object Int16Array]',
        int32Tag = '[object Int32Array]',
        uint8Tag = '[object Uint8Array]',
        uint8ClampedTag = '[object Uint8ClampedArray]',
        uint16Tag = '[object Uint16Array]',
        uint32Tag = '[object Uint32Array]';

    /** Used to identify `toStringTag` values of typed arrays. */
    var typedArrayTags = {};
    typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
    typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
    typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
    typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
    typedArrayTags[uint32Tag] = true;
    typedArrayTags[argsTag$1] = typedArrayTags[arrayTag] =
    typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
    typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
    typedArrayTags[errorTag] = typedArrayTags[funcTag$1] =
    typedArrayTags[mapTag] = typedArrayTags[numberTag] =
    typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
    typedArrayTags[setTag] = typedArrayTags[stringTag] =
    typedArrayTags[weakMapTag] = false;

    /**
     * The base implementation of `_.isTypedArray` without Node.js optimizations.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
     */
    function baseIsTypedArray(value) {
      return isObjectLike_1(value) &&
        isLength_1(value.length) && !!typedArrayTags[_baseGetTag(value)];
    }

    var _baseIsTypedArray = baseIsTypedArray;

    /**
     * The base implementation of `_.unary` without support for storing metadata.
     *
     * @private
     * @param {Function} func The function to cap arguments for.
     * @returns {Function} Returns the new capped function.
     */
    function baseUnary(func) {
      return function(value) {
        return func(value);
      };
    }

    var _baseUnary = baseUnary;

    var _nodeUtil = createCommonjsModule$1(function (module, exports) {
    /** Detect free variable `exports`. */
    var freeExports = exports && !exports.nodeType && exports;

    /** Detect free variable `module`. */
    var freeModule = freeExports && 'object' == 'object' && module && !module.nodeType && module;

    /** Detect the popular CommonJS extension `module.exports`. */
    var moduleExports = freeModule && freeModule.exports === freeExports;

    /** Detect free variable `process` from Node.js. */
    var freeProcess = moduleExports && _freeGlobal.process;

    /** Used to access faster Node.js helpers. */
    var nodeUtil = (function() {
      try {
        // Use `util.types` for Node.js 10+.
        var types = freeModule && freeModule.require && freeModule.require('util').types;

        if (types) {
          return types;
        }

        // Legacy `process.binding('util')` for Node.js < 10.
        return freeProcess && freeProcess.binding && freeProcess.binding('util');
      } catch (e) {}
    }());

    module.exports = nodeUtil;
    });

    /* Node.js helper references. */
    var nodeIsTypedArray = _nodeUtil && _nodeUtil.isTypedArray;

    /**
     * Checks if `value` is classified as a typed array.
     *
     * @static
     * @memberOf _
     * @since 3.0.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
     * @example
     *
     * _.isTypedArray(new Uint8Array);
     * // => true
     *
     * _.isTypedArray([]);
     * // => false
     */
    var isTypedArray = nodeIsTypedArray ? _baseUnary(nodeIsTypedArray) : _baseIsTypedArray;

    var isTypedArray_1 = isTypedArray;

    /** Used for built-in method references. */
    var objectProto$7 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$6 = objectProto$7.hasOwnProperty;

    /**
     * Creates an array of the enumerable property names of the array-like `value`.
     *
     * @private
     * @param {*} value The value to query.
     * @param {boolean} inherited Specify returning inherited property names.
     * @returns {Array} Returns the array of property names.
     */
    function arrayLikeKeys(value, inherited) {
      var isArr = isArray_1(value),
          isArg = !isArr && isArguments_1(value),
          isBuff = !isArr && !isArg && isBuffer_1(value),
          isType = !isArr && !isArg && !isBuff && isTypedArray_1(value),
          skipIndexes = isArr || isArg || isBuff || isType,
          result = skipIndexes ? _baseTimes(value.length, String) : [],
          length = result.length;

      for (var key in value) {
        if ((inherited || hasOwnProperty$6.call(value, key)) &&
            !(skipIndexes && (
               // Safari 9 has enumerable `arguments.length` in strict mode.
               key == 'length' ||
               // Node.js 0.10 has enumerable non-index properties on buffers.
               (isBuff && (key == 'offset' || key == 'parent')) ||
               // PhantomJS 2 has enumerable non-index properties on typed arrays.
               (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||
               // Skip index properties.
               _isIndex(key, length)
            ))) {
          result.push(key);
        }
      }
      return result;
    }

    var _arrayLikeKeys = arrayLikeKeys;

    /** Used for built-in method references. */
    var objectProto$8 = Object.prototype;

    /**
     * Checks if `value` is likely a prototype object.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
     */
    function isPrototype(value) {
      var Ctor = value && value.constructor,
          proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto$8;

      return value === proto;
    }

    var _isPrototype = isPrototype;

    /**
     * Creates a unary function that invokes `func` with its argument transformed.
     *
     * @private
     * @param {Function} func The function to wrap.
     * @param {Function} transform The argument transform.
     * @returns {Function} Returns the new function.
     */
    function overArg(func, transform) {
      return function(arg) {
        return func(transform(arg));
      };
    }

    var _overArg = overArg;

    /* Built-in method references for those with the same name as other `lodash` methods. */
    var nativeKeys = _overArg(Object.keys, Object);

    var _nativeKeys = nativeKeys;

    /** Used for built-in method references. */
    var objectProto$9 = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$7 = objectProto$9.hasOwnProperty;

    /**
     * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names.
     */
    function baseKeys(object) {
      if (!_isPrototype(object)) {
        return _nativeKeys(object);
      }
      var result = [];
      for (var key in Object(object)) {
        if (hasOwnProperty$7.call(object, key) && key != 'constructor') {
          result.push(key);
        }
      }
      return result;
    }

    var _baseKeys = baseKeys;

    /**
     * Checks if `value` is array-like. A value is considered array-like if it's
     * not a function and has a `value.length` that's an integer greater than or
     * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
     *
     * @static
     * @memberOf _
     * @since 4.0.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
     * @example
     *
     * _.isArrayLike([1, 2, 3]);
     * // => true
     *
     * _.isArrayLike(document.body.children);
     * // => true
     *
     * _.isArrayLike('abc');
     * // => true
     *
     * _.isArrayLike(_.noop);
     * // => false
     */
    function isArrayLike(value) {
      return value != null && isLength_1(value.length) && !isFunction_1(value);
    }

    var isArrayLike_1 = isArrayLike;

    /**
     * Creates an array of the own enumerable property names of `object`.
     *
     * **Note:** Non-object values are coerced to objects. See the
     * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
     * for more details.
     *
     * @static
     * @since 0.1.0
     * @memberOf _
     * @category Object
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names.
     * @example
     *
     * function Foo() {
     *   this.a = 1;
     *   this.b = 2;
     * }
     *
     * Foo.prototype.c = 3;
     *
     * _.keys(new Foo);
     * // => ['a', 'b'] (iteration order is not guaranteed)
     *
     * _.keys('hi');
     * // => ['0', '1']
     */
    function keys(object) {
      return isArrayLike_1(object) ? _arrayLikeKeys(object) : _baseKeys(object);
    }

    var keys_1 = keys;

    /**
     * The base implementation of `_.assign` without support for multiple sources
     * or `customizer` functions.
     *
     * @private
     * @param {Object} object The destination object.
     * @param {Object} source The source object.
     * @returns {Object} Returns `object`.
     */
    function baseAssign(object, source) {
      return object && _copyObject(source, keys_1(source), object);
    }

    var _baseAssign = baseAssign;

    /**
     * This function is like
     * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
     * except that it includes inherited enumerable properties.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names.
     */
    function nativeKeysIn(object) {
      var result = [];
      if (object != null) {
        for (var key in Object(object)) {
          result.push(key);
        }
      }
      return result;
    }

    var _nativeKeysIn = nativeKeysIn;

    /** Used for built-in method references. */
    var objectProto$a = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$8 = objectProto$a.hasOwnProperty;

    /**
     * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names.
     */
    function baseKeysIn(object) {
      if (!isObject_1(object)) {
        return _nativeKeysIn(object);
      }
      var isProto = _isPrototype(object),
          result = [];

      for (var key in object) {
        if (!(key == 'constructor' && (isProto || !hasOwnProperty$8.call(object, key)))) {
          result.push(key);
        }
      }
      return result;
    }

    var _baseKeysIn = baseKeysIn;

    /**
     * Creates an array of the own and inherited enumerable property names of `object`.
     *
     * **Note:** Non-object values are coerced to objects.
     *
     * @static
     * @memberOf _
     * @since 3.0.0
     * @category Object
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names.
     * @example
     *
     * function Foo() {
     *   this.a = 1;
     *   this.b = 2;
     * }
     *
     * Foo.prototype.c = 3;
     *
     * _.keysIn(new Foo);
     * // => ['a', 'b', 'c'] (iteration order is not guaranteed)
     */
    function keysIn$1(object) {
      return isArrayLike_1(object) ? _arrayLikeKeys(object, true) : _baseKeysIn(object);
    }

    var keysIn_1 = keysIn$1;

    /**
     * The base implementation of `_.assignIn` without support for multiple sources
     * or `customizer` functions.
     *
     * @private
     * @param {Object} object The destination object.
     * @param {Object} source The source object.
     * @returns {Object} Returns `object`.
     */
    function baseAssignIn(object, source) {
      return object && _copyObject(source, keysIn_1(source), object);
    }

    var _baseAssignIn = baseAssignIn;

    var _cloneBuffer = createCommonjsModule$1(function (module, exports) {
    /** Detect free variable `exports`. */
    var freeExports = exports && !exports.nodeType && exports;

    /** Detect free variable `module`. */
    var freeModule = freeExports && 'object' == 'object' && module && !module.nodeType && module;

    /** Detect the popular CommonJS extension `module.exports`. */
    var moduleExports = freeModule && freeModule.exports === freeExports;

    /** Built-in value references. */
    var Buffer = moduleExports ? _root.Buffer : undefined,
        allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;

    /**
     * Creates a clone of  `buffer`.
     *
     * @private
     * @param {Buffer} buffer The buffer to clone.
     * @param {boolean} [isDeep] Specify a deep clone.
     * @returns {Buffer} Returns the cloned buffer.
     */
    function cloneBuffer(buffer, isDeep) {
      if (isDeep) {
        return buffer.slice();
      }
      var length = buffer.length,
          result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);

      buffer.copy(result);
      return result;
    }

    module.exports = cloneBuffer;
    });

    /**
     * Copies the values of `source` to `array`.
     *
     * @private
     * @param {Array} source The array to copy values from.
     * @param {Array} [array=[]] The array to copy values to.
     * @returns {Array} Returns `array`.
     */
    function copyArray(source, array) {
      var index = -1,
          length = source.length;

      array || (array = Array(length));
      while (++index < length) {
        array[index] = source[index];
      }
      return array;
    }

    var _copyArray = copyArray;

    /**
     * A specialized version of `_.filter` for arrays without support for
     * iteratee shorthands.
     *
     * @private
     * @param {Array} [array] The array to iterate over.
     * @param {Function} predicate The function invoked per iteration.
     * @returns {Array} Returns the new filtered array.
     */
    function arrayFilter(array, predicate) {
      var index = -1,
          length = array == null ? 0 : array.length,
          resIndex = 0,
          result = [];

      while (++index < length) {
        var value = array[index];
        if (predicate(value, index, array)) {
          result[resIndex++] = value;
        }
      }
      return result;
    }

    var _arrayFilter = arrayFilter;

    /**
     * This method returns a new empty array.
     *
     * @static
     * @memberOf _
     * @since 4.13.0
     * @category Util
     * @returns {Array} Returns the new empty array.
     * @example
     *
     * var arrays = _.times(2, _.stubArray);
     *
     * console.log(arrays);
     * // => [[], []]
     *
     * console.log(arrays[0] === arrays[1]);
     * // => false
     */
    function stubArray() {
      return [];
    }

    var stubArray_1 = stubArray;

    /** Used for built-in method references. */
    var objectProto$b = Object.prototype;

    /** Built-in value references. */
    var propertyIsEnumerable$1 = objectProto$b.propertyIsEnumerable;

    /* Built-in method references for those with the same name as other `lodash` methods. */
    var nativeGetSymbols = Object.getOwnPropertySymbols;

    /**
     * Creates an array of the own enumerable symbols of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of symbols.
     */
    var getSymbols = !nativeGetSymbols ? stubArray_1 : function(object) {
      if (object == null) {
        return [];
      }
      object = Object(object);
      return _arrayFilter(nativeGetSymbols(object), function(symbol) {
        return propertyIsEnumerable$1.call(object, symbol);
      });
    };

    var _getSymbols = getSymbols;

    /**
     * Copies own symbols of `source` to `object`.
     *
     * @private
     * @param {Object} source The object to copy symbols from.
     * @param {Object} [object={}] The object to copy symbols to.
     * @returns {Object} Returns `object`.
     */
    function copySymbols(source, object) {
      return _copyObject(source, _getSymbols(source), object);
    }

    var _copySymbols = copySymbols;

    /**
     * Appends the elements of `values` to `array`.
     *
     * @private
     * @param {Array} array The array to modify.
     * @param {Array} values The values to append.
     * @returns {Array} Returns `array`.
     */
    function arrayPush(array, values) {
      var index = -1,
          length = values.length,
          offset = array.length;

      while (++index < length) {
        array[offset + index] = values[index];
      }
      return array;
    }

    var _arrayPush = arrayPush;

    /** Built-in value references. */
    var getPrototype = _overArg(Object.getPrototypeOf, Object);

    var _getPrototype = getPrototype;

    /* Built-in method references for those with the same name as other `lodash` methods. */
    var nativeGetSymbols$1 = Object.getOwnPropertySymbols;

    /**
     * Creates an array of the own and inherited enumerable symbols of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of symbols.
     */
    var getSymbolsIn = !nativeGetSymbols$1 ? stubArray_1 : function(object) {
      var result = [];
      while (object) {
        _arrayPush(result, _getSymbols(object));
        object = _getPrototype(object);
      }
      return result;
    };

    var _getSymbolsIn = getSymbolsIn;

    /**
     * Copies own and inherited symbols of `source` to `object`.
     *
     * @private
     * @param {Object} source The object to copy symbols from.
     * @param {Object} [object={}] The object to copy symbols to.
     * @returns {Object} Returns `object`.
     */
    function copySymbolsIn(source, object) {
      return _copyObject(source, _getSymbolsIn(source), object);
    }

    var _copySymbolsIn = copySymbolsIn;

    /**
     * The base implementation of `getAllKeys` and `getAllKeysIn` which uses
     * `keysFunc` and `symbolsFunc` to get the enumerable property names and
     * symbols of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @param {Function} keysFunc The function to get the keys of `object`.
     * @param {Function} symbolsFunc The function to get the symbols of `object`.
     * @returns {Array} Returns the array of property names and symbols.
     */
    function baseGetAllKeys(object, keysFunc, symbolsFunc) {
      var result = keysFunc(object);
      return isArray_1(object) ? result : _arrayPush(result, symbolsFunc(object));
    }

    var _baseGetAllKeys = baseGetAllKeys;

    /**
     * Creates an array of own enumerable property names and symbols of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names and symbols.
     */
    function getAllKeys(object) {
      return _baseGetAllKeys(object, keys_1, _getSymbols);
    }

    var _getAllKeys = getAllKeys;

    /**
     * Creates an array of own and inherited enumerable property names and
     * symbols of `object`.
     *
     * @private
     * @param {Object} object The object to query.
     * @returns {Array} Returns the array of property names and symbols.
     */
    function getAllKeysIn(object) {
      return _baseGetAllKeys(object, keysIn_1, _getSymbolsIn);
    }

    var _getAllKeysIn = getAllKeysIn;

    /* Built-in method references that are verified to be native. */
    var DataView = _getNative(_root, 'DataView');

    var _DataView = DataView;

    /* Built-in method references that are verified to be native. */
    var Promise$1 = _getNative(_root, 'Promise');

    var _Promise = Promise$1;

    /* Built-in method references that are verified to be native. */
    var Set = _getNative(_root, 'Set');

    var _Set = Set;

    /* Built-in method references that are verified to be native. */
    var WeakMap = _getNative(_root, 'WeakMap');

    var _WeakMap = WeakMap;

    /** `Object#toString` result references. */
    var mapTag$1 = '[object Map]',
        objectTag$1 = '[object Object]',
        promiseTag = '[object Promise]',
        setTag$1 = '[object Set]',
        weakMapTag$1 = '[object WeakMap]';

    var dataViewTag$1 = '[object DataView]';

    /** Used to detect maps, sets, and weakmaps. */
    var dataViewCtorString = _toSource(_DataView),
        mapCtorString = _toSource(_Map),
        promiseCtorString = _toSource(_Promise),
        setCtorString = _toSource(_Set),
        weakMapCtorString = _toSource(_WeakMap);

    /**
     * Gets the `toStringTag` of `value`.
     *
     * @private
     * @param {*} value The value to query.
     * @returns {string} Returns the `toStringTag`.
     */
    var getTag = _baseGetTag;

    // Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.
    if ((_DataView && getTag(new _DataView(new ArrayBuffer(1))) != dataViewTag$1) ||
        (_Map && getTag(new _Map) != mapTag$1) ||
        (_Promise && getTag(_Promise.resolve()) != promiseTag) ||
        (_Set && getTag(new _Set) != setTag$1) ||
        (_WeakMap && getTag(new _WeakMap) != weakMapTag$1)) {
      getTag = function(value) {
        var result = _baseGetTag(value),
            Ctor = result == objectTag$1 ? value.constructor : undefined,
            ctorString = Ctor ? _toSource(Ctor) : '';

        if (ctorString) {
          switch (ctorString) {
            case dataViewCtorString: return dataViewTag$1;
            case mapCtorString: return mapTag$1;
            case promiseCtorString: return promiseTag;
            case setCtorString: return setTag$1;
            case weakMapCtorString: return weakMapTag$1;
          }
        }
        return result;
      };
    }

    var _getTag = getTag;

    /** Used for built-in method references. */
    var objectProto$c = Object.prototype;

    /** Used to check objects for own properties. */
    var hasOwnProperty$9 = objectProto$c.hasOwnProperty;

    /**
     * Initializes an array clone.
     *
     * @private
     * @param {Array} array The array to clone.
     * @returns {Array} Returns the initialized clone.
     */
    function initCloneArray(array) {
      var length = array.length,
          result = new array.constructor(length);

      // Add properties assigned by `RegExp#exec`.
      if (length && typeof array[0] == 'string' && hasOwnProperty$9.call(array, 'index')) {
        result.index = array.index;
        result.input = array.input;
      }
      return result;
    }

    var _initCloneArray = initCloneArray;

    /** Built-in value references. */
    var Uint8Array = _root.Uint8Array;

    var _Uint8Array = Uint8Array;

    /**
     * Creates a clone of `arrayBuffer`.
     *
     * @private
     * @param {ArrayBuffer} arrayBuffer The array buffer to clone.
     * @returns {ArrayBuffer} Returns the cloned array buffer.
     */
    function cloneArrayBuffer(arrayBuffer) {
      var result = new arrayBuffer.constructor(arrayBuffer.byteLength);
      new _Uint8Array(result).set(new _Uint8Array(arrayBuffer));
      return result;
    }

    var _cloneArrayBuffer = cloneArrayBuffer;

    /**
     * Creates a clone of `dataView`.
     *
     * @private
     * @param {Object} dataView The data view to clone.
     * @param {boolean} [isDeep] Specify a deep clone.
     * @returns {Object} Returns the cloned data view.
     */
    function cloneDataView(dataView, isDeep) {
      var buffer = isDeep ? _cloneArrayBuffer(dataView.buffer) : dataView.buffer;
      return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);
    }

    var _cloneDataView = cloneDataView;

    /** Used to match `RegExp` flags from their coerced string values. */
    var reFlags = /\w*$/;

    /**
     * Creates a clone of `regexp`.
     *
     * @private
     * @param {Object} regexp The regexp to clone.
     * @returns {Object} Returns the cloned regexp.
     */
    function cloneRegExp(regexp) {
      var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));
      result.lastIndex = regexp.lastIndex;
      return result;
    }

    var _cloneRegExp = cloneRegExp;

    /** Used to convert symbols to primitives and strings. */
    var symbolProto = _Symbol ? _Symbol.prototype : undefined,
        symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;

    /**
     * Creates a clone of the `symbol` object.
     *
     * @private
     * @param {Object} symbol The symbol object to clone.
     * @returns {Object} Returns the cloned symbol object.
     */
    function cloneSymbol(symbol) {
      return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};
    }

    var _cloneSymbol = cloneSymbol;

    /**
     * Creates a clone of `typedArray`.
     *
     * @private
     * @param {Object} typedArray The typed array to clone.
     * @param {boolean} [isDeep] Specify a deep clone.
     * @returns {Object} Returns the cloned typed array.
     */
    function cloneTypedArray(typedArray, isDeep) {
      var buffer = isDeep ? _cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;
      return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);
    }

    var _cloneTypedArray = cloneTypedArray;

    /** `Object#toString` result references. */
    var boolTag$1 = '[object Boolean]',
        dateTag$1 = '[object Date]',
        mapTag$2 = '[object Map]',
        numberTag$1 = '[object Number]',
        regexpTag$1 = '[object RegExp]',
        setTag$2 = '[object Set]',
        stringTag$1 = '[object String]',
        symbolTag = '[object Symbol]';

    var arrayBufferTag$1 = '[object ArrayBuffer]',
        dataViewTag$2 = '[object DataView]',
        float32Tag$1 = '[object Float32Array]',
        float64Tag$1 = '[object Float64Array]',
        int8Tag$1 = '[object Int8Array]',
        int16Tag$1 = '[object Int16Array]',
        int32Tag$1 = '[object Int32Array]',
        uint8Tag$1 = '[object Uint8Array]',
        uint8ClampedTag$1 = '[object Uint8ClampedArray]',
        uint16Tag$1 = '[object Uint16Array]',
        uint32Tag$1 = '[object Uint32Array]';

    /**
     * Initializes an object clone based on its `toStringTag`.
     *
     * **Note:** This function only supports cloning values with tags of
     * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.
     *
     * @private
     * @param {Object} object The object to clone.
     * @param {string} tag The `toStringTag` of the object to clone.
     * @param {boolean} [isDeep] Specify a deep clone.
     * @returns {Object} Returns the initialized clone.
     */
    function initCloneByTag(object, tag, isDeep) {
      var Ctor = object.constructor;
      switch (tag) {
        case arrayBufferTag$1:
          return _cloneArrayBuffer(object);

        case boolTag$1:
        case dateTag$1:
          return new Ctor(+object);

        case dataViewTag$2:
          return _cloneDataView(object, isDeep);

        case float32Tag$1: case float64Tag$1:
        case int8Tag$1: case int16Tag$1: case int32Tag$1:
        case uint8Tag$1: case uint8ClampedTag$1: case uint16Tag$1: case uint32Tag$1:
          return _cloneTypedArray(object, isDeep);

        case mapTag$2:
          return new Ctor;

        case numberTag$1:
        case stringTag$1:
          return new Ctor(object);

        case regexpTag$1:
          return _cloneRegExp(object);

        case setTag$2:
          return new Ctor;

        case symbolTag:
          return _cloneSymbol(object);
      }
    }

    var _initCloneByTag = initCloneByTag;

    /** Built-in value references. */
    var objectCreate = Object.create;

    /**
     * The base implementation of `_.create` without support for assigning
     * properties to the created object.
     *
     * @private
     * @param {Object} proto The object to inherit from.
     * @returns {Object} Returns the new object.
     */
    var baseCreate = (function() {
      function object() {}
      return function(proto) {
        if (!isObject_1(proto)) {
          return {};
        }
        if (objectCreate) {
          return objectCreate(proto);
        }
        object.prototype = proto;
        var result = new object;
        object.prototype = undefined;
        return result;
      };
    }());

    var _baseCreate = baseCreate;

    /**
     * Initializes an object clone.
     *
     * @private
     * @param {Object} object The object to clone.
     * @returns {Object} Returns the initialized clone.
     */
    function initCloneObject(object) {
      return (typeof object.constructor == 'function' && !_isPrototype(object))
        ? _baseCreate(_getPrototype(object))
        : {};
    }

    var _initCloneObject = initCloneObject;

    /** `Object#toString` result references. */
    var mapTag$3 = '[object Map]';

    /**
     * The base implementation of `_.isMap` without Node.js optimizations.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a map, else `false`.
     */
    function baseIsMap(value) {
      return isObjectLike_1(value) && _getTag(value) == mapTag$3;
    }

    var _baseIsMap = baseIsMap;

    /* Node.js helper references. */
    var nodeIsMap = _nodeUtil && _nodeUtil.isMap;

    /**
     * Checks if `value` is classified as a `Map` object.
     *
     * @static
     * @memberOf _
     * @since 4.3.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a map, else `false`.
     * @example
     *
     * _.isMap(new Map);
     * // => true
     *
     * _.isMap(new WeakMap);
     * // => false
     */
    var isMap = nodeIsMap ? _baseUnary(nodeIsMap) : _baseIsMap;

    var isMap_1 = isMap;

    /** `Object#toString` result references. */
    var setTag$3 = '[object Set]';

    /**
     * The base implementation of `_.isSet` without Node.js optimizations.
     *
     * @private
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a set, else `false`.
     */
    function baseIsSet(value) {
      return isObjectLike_1(value) && _getTag(value) == setTag$3;
    }

    var _baseIsSet = baseIsSet;

    /* Node.js helper references. */
    var nodeIsSet = _nodeUtil && _nodeUtil.isSet;

    /**
     * Checks if `value` is classified as a `Set` object.
     *
     * @static
     * @memberOf _
     * @since 4.3.0
     * @category Lang
     * @param {*} value The value to check.
     * @returns {boolean} Returns `true` if `value` is a set, else `false`.
     * @example
     *
     * _.isSet(new Set);
     * // => true
     *
     * _.isSet(new WeakSet);
     * // => false
     */
    var isSet = nodeIsSet ? _baseUnary(nodeIsSet) : _baseIsSet;

    var isSet_1 = isSet;

    /** Used to compose bitmasks for cloning. */
    var CLONE_DEEP_FLAG = 1,
        CLONE_FLAT_FLAG = 2,
        CLONE_SYMBOLS_FLAG = 4;

    /** `Object#toString` result references. */
    var argsTag$2 = '[object Arguments]',
        arrayTag$1 = '[object Array]',
        boolTag$2 = '[object Boolean]',
        dateTag$2 = '[object Date]',
        errorTag$1 = '[object Error]',
        funcTag$2 = '[object Function]',
        genTag$1 = '[object GeneratorFunction]',
        mapTag$4 = '[object Map]',
        numberTag$2 = '[object Number]',
        objectTag$2 = '[object Object]',
        regexpTag$2 = '[object RegExp]',
        setTag$4 = '[object Set]',
        stringTag$2 = '[object String]',
        symbolTag$1 = '[object Symbol]',
        weakMapTag$2 = '[object WeakMap]';

    var arrayBufferTag$2 = '[object ArrayBuffer]',
        dataViewTag$3 = '[object DataView]',
        float32Tag$2 = '[object Float32Array]',
        float64Tag$2 = '[object Float64Array]',
        int8Tag$2 = '[object Int8Array]',
        int16Tag$2 = '[object Int16Array]',
        int32Tag$2 = '[object Int32Array]',
        uint8Tag$2 = '[object Uint8Array]',
        uint8ClampedTag$2 = '[object Uint8ClampedArray]',
        uint16Tag$2 = '[object Uint16Array]',
        uint32Tag$2 = '[object Uint32Array]';

    /** Used to identify `toStringTag` values supported by `_.clone`. */
    var cloneableTags = {};
    cloneableTags[argsTag$2] = cloneableTags[arrayTag$1] =
    cloneableTags[arrayBufferTag$2] = cloneableTags[dataViewTag$3] =
    cloneableTags[boolTag$2] = cloneableTags[dateTag$2] =
    cloneableTags[float32Tag$2] = cloneableTags[float64Tag$2] =
    cloneableTags[int8Tag$2] = cloneableTags[int16Tag$2] =
    cloneableTags[int32Tag$2] = cloneableTags[mapTag$4] =
    cloneableTags[numberTag$2] = cloneableTags[objectTag$2] =
    cloneableTags[regexpTag$2] = cloneableTags[setTag$4] =
    cloneableTags[stringTag$2] = cloneableTags[symbolTag$1] =
    cloneableTags[uint8Tag$2] = cloneableTags[uint8ClampedTag$2] =
    cloneableTags[uint16Tag$2] = cloneableTags[uint32Tag$2] = true;
    cloneableTags[errorTag$1] = cloneableTags[funcTag$2] =
    cloneableTags[weakMapTag$2] = false;

    /**
     * The base implementation of `_.clone` and `_.cloneDeep` which tracks
     * traversed objects.
     *
     * @private
     * @param {*} value The value to clone.
     * @param {boolean} bitmask The bitmask flags.
     *  1 - Deep clone
     *  2 - Flatten inherited properties
     *  4 - Clone symbols
     * @param {Function} [customizer] The function to customize cloning.
     * @param {string} [key] The key of `value`.
     * @param {Object} [object] The parent object of `value`.
     * @param {Object} [stack] Tracks traversed objects and their clone counterparts.
     * @returns {*} Returns the cloned value.
     */
    function baseClone(value, bitmask, customizer, key, object, stack) {
      var result,
          isDeep = bitmask & CLONE_DEEP_FLAG,
          isFlat = bitmask & CLONE_FLAT_FLAG,
          isFull = bitmask & CLONE_SYMBOLS_FLAG;

      if (customizer) {
        result = object ? customizer(value, key, object, stack) : customizer(value);
      }
      if (result !== undefined) {
        return result;
      }
      if (!isObject_1(value)) {
        return value;
      }
      var isArr = isArray_1(value);
      if (isArr) {
        result = _initCloneArray(value);
        if (!isDeep) {
          return _copyArray(value, result);
        }
      } else {
        var tag = _getTag(value),
            isFunc = tag == funcTag$2 || tag == genTag$1;

        if (isBuffer_1(value)) {
          return _cloneBuffer(value, isDeep);
        }
        if (tag == objectTag$2 || tag == argsTag$2 || (isFunc && !object)) {
          result = (isFlat || isFunc) ? {} : _initCloneObject(value);
          if (!isDeep) {
            return isFlat
              ? _copySymbolsIn(value, _baseAssignIn(result, value))
              : _copySymbols(value, _baseAssign(result, value));
          }
        } else {
          if (!cloneableTags[tag]) {
            return object ? value : {};
          }
          result = _initCloneByTag(value, tag, isDeep);
        }
      }
      // Check for circular references and return its corresponding clone.
      stack || (stack = new _Stack);
      var stacked = stack.get(value);
      if (stacked) {
        return stacked;
      }
      stack.set(value, result);

      if (isSet_1(value)) {
        value.forEach(function(subValue) {
          result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));
        });

        return result;
      }

      if (isMap_1(value)) {
        value.forEach(function(subValue, key) {
          result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));
        });

        return result;
      }

      var keysFunc = isFull
        ? (isFlat ? _getAllKeysIn : _getAllKeys)
        : (isFlat ? keysIn : keys_1);

      var props = isArr ? undefined : keysFunc(value);
      _arrayEach(props || value, function(subValue, key) {
        if (props) {
          key = subValue;
          subValue = value[key];
        }
        // Recursively populate clone (susceptible to call stack limits).
        _assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));
      });
      return result;
    }

    var _baseClone = baseClone;

    /** Used to compose bitmasks for cloning. */
    var CLONE_DEEP_FLAG$1 = 1,
        CLONE_SYMBOLS_FLAG$1 = 4;

    /**
     * This method is like `_.clone` except that it recursively clones `value`.
     *
     * @static
     * @memberOf _
     * @since 1.0.0
     * @category Lang
     * @param {*} value The value to recursively clone.
     * @returns {*} Returns the deep cloned value.
     * @see _.clone
     * @example
     *
     * var objects = [{ 'a': 1 }, { 'b': 2 }];
     *
     * var deep = _.cloneDeep(objects);
     * console.log(deep[0] === objects[0]);
     * // => false
     */
    function cloneDeep(value) {
      return _baseClone(value, CLONE_DEEP_FLAG$1 | CLONE_SYMBOLS_FLAG$1);
    }

    var cloneDeep_1 = cloneDeep;

    var cloneDeepProxy = /*#__PURE__*/Object.freeze({
        default: cloneDeep_1,
        __moduleExports: cloneDeep_1
    });

    // Unique ID creation requires a high quality random # generator.  In node.js
    // this is pretty straight-forward - we use the crypto API.



    var rng = function nodeRNG() {
      return crypto.randomBytes(16);
    };

    /**
     * Convert array of 16 byte values to UUID string format of the form:
     * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX
     */
    var byteToHex = [];
    for (var i = 0; i < 256; ++i) {
      byteToHex[i] = (i + 0x100).toString(16).substr(1);
    }

    function bytesToUuid(buf, offset) {
      var i = offset || 0;
      var bth = byteToHex;
      // join used to fix memory issue caused by concatenation: https://bugs.chromium.org/p/v8/issues/detail?id=3175#c4
      return ([bth[buf[i++]], bth[buf[i++]], 
    	bth[buf[i++]], bth[buf[i++]], '-',
    	bth[buf[i++]], bth[buf[i++]], '-',
    	bth[buf[i++]], bth[buf[i++]], '-',
    	bth[buf[i++]], bth[buf[i++]], '-',
    	bth[buf[i++]], bth[buf[i++]],
    	bth[buf[i++]], bth[buf[i++]],
    	bth[buf[i++]], bth[buf[i++]]]).join('');
    }

    var bytesToUuid_1 = bytesToUuid;

    function v4(options, buf, offset) {
      var i = buf && offset || 0;

      if (typeof(options) == 'string') {
        buf = options === 'binary' ? new Array(16) : null;
        options = null;
      }
      options = options || {};

      var rnds = options.random || (options.rng || rng)();

      // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`
      rnds[6] = (rnds[6] & 0x0f) | 0x40;
      rnds[8] = (rnds[8] & 0x3f) | 0x80;

      // Copy bytes to buffer, if provided
      if (buf) {
        for (var ii = 0; ii < 16; ++ii) {
          buf[i + ii] = rnds[ii];
        }
      }

      return buf || bytesToUuid_1(rnds);
    }

    var v4_1 = v4;

    var uuidv4Proxy = /*#__PURE__*/Object.freeze({
        default: v4_1,
        __moduleExports: v4_1
    });

    // @ts-ignore
    var cloneDeep$1 = cloneDeepProxy;
    var uuidv4 = uuidv4Proxy;

    var SELECT_ALL = 'select all';
    var DESELECT_ALL = 'deselect all';
    // Add all icons to the library so you can use it in your page
    library.add(faTimes);
    library.add(faPlus);
    /**
     * Checkbox group represents one column's set of checkbox filters
     *
     * @class CheckboxGroup
     * @extends {React.Component}
     */
    var CheckboxGroup = function (props) {
        var element = props.element, showAllFacets = props.showAllFacets;
        var children = [];
        element.facetValues.sort(function (a, b) {
            return b.count - a.count;
        });
        var _a = getColorPallette(props.rgbIndex, element.facetValues.length), colorPalette = _a.colorPalette, textColors = _a.textColors;
        element.facetValues.forEach(function (facetValue, index$$1) {
            var uniqueId = element.columnName + " " + facetValue.value + " " + facetValue.count;
            var textColor = textColors[index$$1];
            var curColor = colorPalette[index$$1];
            var style = {};
            var isChecked = props.isChecked[index$$1] === undefined || props.isChecked[index$$1];
            if (isChecked) {
                style = {
                    background: curColor
                };
            }
            else {
                style = {
                    background: '#C4C4C4'
                };
            }
            style.color = textColor;
            var value = facetValue.value;
            facetValue.displayValue = value === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET' ? 'unannotated' : value;
            var icon$$1 = isChecked ? 'times' : 'plus';
            children.push(React.createElement("span", { style: style, className: "SRC-facets SRC-primary-background-color-hover SRC-nested-color", key: uniqueId, onClick: props.clickHandler({ index: index$$1, value: facetValue.value, columnName: element.columnName }) },
                React.createElement("span", { className: "SRC-facets-text" },
                    ' ',
                    "\u00A0\u00A0 ",
                    facetValue.displayValue,
                    " (",
                    facetValue.count,
                    ")",
                    ' '),
                React.createElement("span", null, "\u00A0\u00A0"),
                React.createElement(FontAwesomeIcon, { className: "SRC-facets-icon", icon: icon$$1 }),
                React.createElement("span", null, "\u00A0\u00A0")));
        });
        // By default only show 5 facets unless the user has clicked a facet, in which case
        // showAllFacets will be true.
        var childrenView = children.map(function (child, index$$1) { return !showAllFacets && index$$1 > 4 ? false : child; });
        return (React.createElement(React.Fragment, null, childrenView));
    };
    var Facets = /** @class */ (function (_super) {
        __extends(Facets, _super);
        function Facets(props) {
            var _this = _super.call(this, props) || this;
            /**
             * Handle checkbox click event
             */
            _this.handleClick = function (dict) { return function (event) {
                if (!_this.state.showAllFacets) {
                    _this.setState({
                        showAllFacets: true
                    });
                }
                // https://medium.freecodecamp.org/reactjs-pass-parameters-to-event-handlers-ca1f5c422b9
                var queryRequest = _this.props.getLastQueryRequest();
                var selectedFacets = queryRequest.query.selectedFacets;
                // grab the facet values associated for this column
                var specificFacet = selectedFacets[0];
                // if its not selected then we add as having been chosen, otherwise we
                // have to delete it
                if (specificFacet.facetValues.indexOf(dict.value) === -1) {
                    specificFacet.facetValues.push(dict.value);
                }
                else {
                    // remove value
                    specificFacet.facetValues.splice(specificFacet.facetValues.indexOf(dict.value), 1);
                }
                var isChecked = cloneDeep$1(_this.props).isChecked;
                var isCheckedValue = isChecked[dict.index];
                isChecked[dict.index] = isCheckedValue === undefined ? false : !isChecked[dict.index];
                queryRequest.query.selectedFacets = selectedFacets;
                queryRequest.query.offset = 0;
                _this.props.updateParentState({ isChecked: isChecked });
                _this.props.executeQueryRequest(queryRequest);
            }; };
            /**
             * Handle select all or deselect all event, selection group specifies which
             * option was chosen
             *
             * @memberof Facets
             */
            _this.updateSelection = function (selectionGroup) { return function (event) {
                event.preventDefault();
                var isChecked = cloneDeep$1(_this.props).isChecked;
                var queryRequest = _this.props.getLastQueryRequest();
                var selectedFacets = queryRequest.query.selectedFacets;
                // we go through and set all facets as selected or deselected per the button
                // clicked that initiated this function call
                for (var i = 0; i < 100; i += 1) {
                    if (selectionGroup === SELECT_ALL) {
                        isChecked[i] = true;
                    }
                    else {
                        isChecked[i] = false;
                    }
                }
                // we update the parent state with isChecked so that the barchart will reflect
                // in the graph slices on or off
                _this.props.updateParentState({ isChecked: isChecked });
                if (selectionGroup === SELECT_ALL) {
                    // if the user chose to select all facets then we can have the parent component
                    // run the first query it was given
                    _this.props.executeInitialQueryRequest();
                }
                else {
                    // if the user chose to deselect all facets then we zero out the facet selection
                    var facetColumnResultValues = selectedFacets.filter(function (value) {
                        return value.columnName === _this.props.filter;
                    })[0];
                    facetColumnResultValues.facetValues = [];
                    _this.props.executeQueryRequest(queryRequest);
                }
            }; };
            _this.handleClick = _this.handleClick.bind(_this);
            _this.state = {
                boxCount: 0,
                isChecked: [],
                // we store the selected facets by column name for ease of use,
                // this has to be later converted when making the api call
                selectedFacets: {},
                showAllFacets: false
            };
            _this.showAllFacets = _this.showAllFacets.bind(_this);
            _this.updateSelection = _this.updateSelection.bind(_this);
            _this.showButtons = _this.showButtons.bind(_this);
            return _this;
        }
        /**
         * Display the view of the facets
         *
         * @returns
         * @memberof Facets
         */
        Facets.prototype.showFacetFilter = function () {
            var _this = this;
            // iterate through the loaded data and write out the appropriate checkboxes,
            // filling in the state of the checkboxes according to the current selection
            var structuredRender = this.props.data.facets.map(function (element) {
                // display the data -- currently we only support enumerations
                if (element.columnName === _this.props.filter && element.facetType === 'enumeration') {
                    return (React.createElement(CheckboxGroup, { showAllFacets: _this.state.showAllFacets, rgbIndex: _this.props.rgbIndex, key: element.columnName, element: element, isChecked: _this.props.isChecked, clickHandler: _this.handleClick }));
                }
                // throw away.
                return (React.createElement("span", { key: element.columnName }));
            });
            return (React.createElement(React.Fragment, null, structuredRender));
        };
        Facets.prototype.showAllFacets = function (event) {
            event.preventDefault();
            this.setState({
                showAllFacets: true
            });
        };
        Facets.prototype.showButtons = function (showAllFacets, curFacetsLength) {
            if (showAllFacets) {
                return (React.createElement(React.Fragment, null,
                    React.createElement("a", { href: '', className: "SRC-primary-text-color SRC-no-text-decor", onClick: this.updateSelection(SELECT_ALL) },
                        ' ',
                        "Select All",
                        ' '),
                    React.createElement("span", { className: "SRC-facets-divider" }, "|"),
                    React.createElement("a", { href: '', className: "SRC-primary-text-color SRC-no-text-decor", onClick: this.updateSelection(DESELECT_ALL) },
                        ' ',
                        "Deselect All",
                        ' ')));
            }
            return (React.createElement("a", { href: '', className: "SRC-primary-text-color SRC-no-text-decor", onClick: this.showAllFacets },
                ' ',
                "Show All (",
                curFacetsLength,
                ")",
                ' '));
        };
        Facets.prototype.render = function () {
            if (this.props.data === undefined) {
                return (React.createElement("div", null));
            }
            var showAllFacets = this.state.showAllFacets;
            var _a = this.props, data = _a.data, filter = _a.filter;
            var facets = data.facets;
            // tslint:disable-next-line
            var curFacetsIndex = facets.findIndex(function (facet) { return facet.columnName === filter && facet.facetType === "enumeration"; });
            // cast is necessary because filter returns an array of arrays
            var facetColumnResultValues = facets[curFacetsIndex];
            if (!facetColumnResultValues) {
                return (React.createElement("div", null));
            }
            if (facetColumnResultValues.facetValues.length < 5) {
                // override
                showAllFacets = true;
            }
            return (React.createElement("div", { className: "container-fluid SRC-syn-border-spacing " },
                React.createElement("div", { className: "col-xs" },
                    React.createElement("form", null,
                        React.createElement("div", { className: "SRC-marginFive form-group" },
                            this.showFacetFilter(),
                            React.createElement("span", { className: "SRC-inlineBlock" }, this.showButtons(showAllFacets, facetColumnResultValues.facetValues.length)))))));
        };
        return Facets;
    }(React.Component));

    /** QueryBundleRequest constants */
    var BUNDLE_MASK_QUERY_RESULTS = 1;
    var BUNDLE_MASK_QUERY_COUNT = 2;
    var BUNDLE_MASK_QUERY_SELECT_COLUMNS = 4;
    var BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE = 8;
    var BUNDLE_MASK_QUERY_COLUMN_MODELS = 16;
    var BUNDLE_MASK_QUERY_FACETS = 32;
    /** EntityBundle constants */
    var ENTITY_BUNDLE_MASK_ENTITY = 1;
    var ENTITY_BUNDLE_MASK_ANNOTATIONS = 2;
    var ENTITY_BUNDLE_MASK_PERMISSIONS = 4;
    var ENTITY_BUNDLE_MASK_ENTITY_PATH = 8;
    var ENTITY_BUNDLE_MASK_HAS_CHILDREN = 32;
    var ENTITY_BUNDLE_MASK_ACL = 64;
    var ENTITY_BUNDLE_MASK_FILE_HANDLES = 2048;
    var ENTITY_BUNDLE_MASK_TABLE_DATA = 4096;
    var ENTITY_BUNDLE_MASK_ROOT_WIKI_ID = 8192;
    var ENTITY_BUNDLE_MASK_BENEFACTOR_ACL = 16384;
    var ENTITY_BUNDLE_MASK_DOI = 32768;
    var ENTITY_BUNDLE_MASK_FILE_NAME = 65536;
    var ENTITY_BUNDLE_MASK_THREAD_COUNT = 131072;
    var ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION = 262144;
    /** Row Types  */
    var STUDY = 'study';
    // for study icons
    var STUDY_ACTIVE = 'study active';
    var STUDY_COMPLETE = 'study complete';
    var DATASET = 'dataset';
    var AMP_PROJECT = 'AMP_Project';
    var AMP_CONSORTIUM = 'AMP_Consortium';
    var AMP_STUDY = 'AMP_Study';
    var FUNDER = 'funder';
    var PUBLICATION = 'publication';
    var TOOL = 'tool';

    var SynapseConstants = /*#__PURE__*/Object.freeze({
        BUNDLE_MASK_QUERY_RESULTS: BUNDLE_MASK_QUERY_RESULTS,
        BUNDLE_MASK_QUERY_COUNT: BUNDLE_MASK_QUERY_COUNT,
        BUNDLE_MASK_QUERY_SELECT_COLUMNS: BUNDLE_MASK_QUERY_SELECT_COLUMNS,
        BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE: BUNDLE_MASK_QUERY_MAX_ROWS_PER_PAGE,
        BUNDLE_MASK_QUERY_COLUMN_MODELS: BUNDLE_MASK_QUERY_COLUMN_MODELS,
        BUNDLE_MASK_QUERY_FACETS: BUNDLE_MASK_QUERY_FACETS,
        ENTITY_BUNDLE_MASK_ENTITY: ENTITY_BUNDLE_MASK_ENTITY,
        ENTITY_BUNDLE_MASK_ANNOTATIONS: ENTITY_BUNDLE_MASK_ANNOTATIONS,
        ENTITY_BUNDLE_MASK_PERMISSIONS: ENTITY_BUNDLE_MASK_PERMISSIONS,
        ENTITY_BUNDLE_MASK_ENTITY_PATH: ENTITY_BUNDLE_MASK_ENTITY_PATH,
        ENTITY_BUNDLE_MASK_HAS_CHILDREN: ENTITY_BUNDLE_MASK_HAS_CHILDREN,
        ENTITY_BUNDLE_MASK_ACL: ENTITY_BUNDLE_MASK_ACL,
        ENTITY_BUNDLE_MASK_FILE_HANDLES: ENTITY_BUNDLE_MASK_FILE_HANDLES,
        ENTITY_BUNDLE_MASK_TABLE_DATA: ENTITY_BUNDLE_MASK_TABLE_DATA,
        ENTITY_BUNDLE_MASK_ROOT_WIKI_ID: ENTITY_BUNDLE_MASK_ROOT_WIKI_ID,
        ENTITY_BUNDLE_MASK_BENEFACTOR_ACL: ENTITY_BUNDLE_MASK_BENEFACTOR_ACL,
        ENTITY_BUNDLE_MASK_DOI: ENTITY_BUNDLE_MASK_DOI,
        ENTITY_BUNDLE_MASK_FILE_NAME: ENTITY_BUNDLE_MASK_FILE_NAME,
        ENTITY_BUNDLE_MASK_THREAD_COUNT: ENTITY_BUNDLE_MASK_THREAD_COUNT,
        ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION: ENTITY_BUNDLE_MASK_RESTRICTION_INFORMATION,
        STUDY: STUDY,
        STUDY_ACTIVE: STUDY_ACTIVE,
        STUDY_COMPLETE: STUDY_COMPLETE,
        DATASET: DATASET,
        AMP_PROJECT: AMP_PROJECT,
        AMP_CONSORTIUM: AMP_CONSORTIUM,
        AMP_STUDY: AMP_STUDY,
        FUNDER: FUNDER,
        PUBLICATION: PUBLICATION,
        TOOL: TOOL
    });

    var _this = undefined;
    // TODO: Create JSON response types for return types
    var DEFAULT_ENDPOINT = 'https://repo-prod.prod.sagebase.org/';
    function delay(t) {
        return new Promise(function (resolve) {
            setTimeout(resolve.bind(null, null), t);
        });
    }
    var fetchWithExponentialTimeout = function (url, options, delayMs, retries) {
        return fetch(url, options)
            .then(function (resp) {
            if (resp.status > 199 && resp.status < 300) {
                // ok!
                return resp.json();
            }
            if (resp.status === 429 || resp.status === 0) {
                // TOO_MANY_REQUESTS_STATUS_CODE, or network connection is down.  Retry after a couple of seconds.
                if (retries === 1) {
                    return Promise.reject({
                        reason: resp.statusText,
                        statusCode: resp.status
                    });
                }
                return delay(delayMs).then(function () {
                    return fetchWithExponentialTimeout(url, options, delayMs * 2, retries - 1);
                });
            }
            // error status that indicates no more retries
            return resp
                .json()
                .then(function (json) {
                // on okay response return json, o.w. reject with json and
                // send to catch block
                var error = {
                    reason: json.reason,
                    status: resp.status
                };
                return resp.ok ? json : Promise.reject(error);
            })
                .catch(function (error) {
                // call failed above
                if (error.reason && error.status) {
                    // successfull return from server but invalid call
                    // the call was recieved, but staus wasn't ok-- return the json response from above
                    // from the response directly
                    return Promise.reject({
                        reason: error.reason,
                        statusCode: error.status
                    });
                }
                return Promise.reject({
                    reason: resp.statusText,
                    statusCode: resp.status
                });
            });
        })
            .catch(function (error) {
            // this should never happen
            return Promise.reject(error);
        });
    };
    var doPost = function (url, requestJsonObject, sessionToken, endpoint) {
        var options = {
            body: JSON.stringify(requestJsonObject),
            headers: {
                Accept: '*/*',
                'Access-Control-Request-Headers': 'sessiontoken',
                'Content-Type': 'application/json',
            },
            method: 'POST',
            mode: 'cors'
        };
        if (sessionToken) {
            options.headers.sessionToken = sessionToken;
        }
        return fetchWithExponentialTimeout(endpoint + url, options, 1000, 5);
    };
    var doGet = function (url, sessionToken, endpoint) {
        var options = {
            headers: {
                Accept: '*/*',
                'Access-Control-Request-Headers': 'sessiontoken'
            },
            method: 'GET',
            mode: 'cors'
        };
        if (sessionToken) {
            options.headers.sessionToken = sessionToken;
        }
        return fetchWithExponentialTimeout(endpoint + url, options, 1000, 5);
    };
    var getVersion = function (endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doGet('/repo/v1/version', undefined, endpoint);
    };
    var getQueryTableResultsFromJobId = function (entityId, jobId, sessionToken, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doGet("/repo/v1/entity/" + entityId + "/table/query/async/get/" + jobId, sessionToken, endpoint)
            .then(function (resp) {
            // is this the job status?
            if (resp.jobState && resp.jobState !== 'FAILED') {
                // still processing, wait for a second and try again
                return delay(500).then(function () {
                    return getQueryTableResultsFromJobId(entityId, jobId, sessionToken, endpoint);
                });
            }
            // these must be the query results!
            return resp;
        })
            .catch(function (error) {
            throw error;
        });
    };
    /**
     * This method is necesary because the backend service returns ALL table results when
     * a particular facet is empty, the rationale being that it is a slight optimization
     * for when a client first gets table results. However, it introduces an edge case on the front
     * end that when the user "deselects" all facets inside Facets.tsx, uninutitive to the user,
     * all results would be returned, so we have to make this a special case.
     *
     * Note: This is under the context that the user is exploring with only a single facet in mind,
     * beyond that this issue becomes much more confusing.
     *
     * @param {*} queryBundleRequest
     * @param {*} sessionToken
     * @param {*} lastQueryResult
     * @param {*} filter
     * @param {*} endpoint
     */
    var getIntuitiveQueryTableResults = function (queryBundleRequest, sessionToken, filter, lastQueryResult, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var facetSelection = queryBundleRequest.query.selectedFacets;
        var facetsForFilter = facetSelection.filter(function (obj) {
            return obj.columnName === filter;
        })[0];
        // check if the current set of facets being used is empty or not
        if (facetsForFilter.facetValues.length === 0) {
            // zero out the rows
            lastQueryResult.queryResult.queryResults.rows = [];
            return Promise.resolve(lastQueryResult);
        }
        return getQueryTableResults(queryBundleRequest, sessionToken, endpoint);
    };
    /**
     * http://docs.synapse.org/rest/POST/entity/id/table/query/nextPage/async/start.html
     * @param {*} queryBundleRequest
     * @param {*} sessionToken
     * @param {*} endpoint
     */
    var getQueryTableResults = function (queryBundleRequest, sessionToken, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost("/repo/v1/entity/" + queryBundleRequest.entityId + "/table/query/async/start", queryBundleRequest, sessionToken, endpoint)
            .then(function (resp) {
            // started query, now attempt to get the results.
            return getQueryTableResultsFromJobId(queryBundleRequest.entityId, resp.token, sessionToken, endpoint);
        })
            .catch(function (error) {
            throw error;
        });
    };
    /**
     *  Run and return results from queryBundleRequest, queryBundle request must be of the
     *  form:
     *     {
     *        concreteType: String,
     *        query: {
     *           sql: String,
     *           isConsistent: Boolean,
     *           partMask: Number
     *        }
     *     }
     * @param {*} queryBundleRequest
     * @param {*} [sessionToken=undefined]
     * @param {boolean} [onlyGetFacets=false] Specify if the query only needs facets and no
     * data-- (internally this limits the row count to 1 on the request)
     * @returns Full dataset from synapse table query
     */
    var getFullQueryTableResults = function (queryBundleRequest, sessionToken) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        return __awaiter(_this, void 0, void 0, function () {
            var query, rest, data, maxPageSize, queryRequest;
            var _this = this;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        query = queryBundleRequest.query, rest = __rest(queryBundleRequest, ["query"]);
                        data = {};
                        maxPageSize = 150;
                        queryRequest = __assign({}, rest, { query: __assign({}, query, { limit: maxPageSize }) });
                        // Have to make two "sets" of calls for query, the first one tells us the maximum size per page of data
                        // we can get, the following uses that maximum and offsets to the appropriate location to get the data
                        // afterwards, the process repeats
                        return [4 /*yield*/, getQueryTableResults(queryRequest, sessionToken).then(function (initData) { return __awaiter(_this, void 0, void 0, function () {
                                var queryCount, currentQueryCount, getData;
                                var _this = this;
                                return __generator(this, function (_a) {
                                    queryCount = initData.queryResult.queryResults.rows.length;
                                    currentQueryCount = queryCount;
                                    data = initData;
                                    getData = function () { return __awaiter(_this, void 0, void 0, function () {
                                        var queryRequestWithMaxPageSize;
                                        return __generator(this, function (_a) {
                                            switch (_a.label) {
                                                case 0:
                                                    if (!(queryCount === maxPageSize)) return [3 /*break*/, 2];
                                                    maxPageSize = initData.maxRowsPerPage;
                                                    queryRequestWithMaxPageSize = __assign({}, rest, { query: __assign({}, query, { limit: maxPageSize, offset: currentQueryCount }) });
                                                    return [4 /*yield*/, getQueryTableResults(queryRequestWithMaxPageSize, sessionToken)
                                                            .then(function (postData) {
                                                            var _a;
                                                            queryCount += postData.queryResult.queryResults.rows.length;
                                                            if (queryCount > 0) {
                                                                currentQueryCount += queryCount;
                                                                (_a = data.queryResult.queryResults.rows).push.apply(_a, postData.queryResult.queryResults.rows // ... spread operator to push all elements on
                                                                );
                                                            }
                                                            return getData();
                                                        })
                                                            .catch(function (err) {
                                                            console.log('Error on getting table results ', err);
                                                        })];
                                                case 1:
                                                    _a.sent();
                                                    return [3 /*break*/, 3];
                                                case 2: 
                                                // set data to this plots sql in the query data
                                                return [2 /*return*/, data];
                                                case 3: return [2 /*return*/];
                                            }
                                        });
                                    }); };
                                    return [2 /*return*/, getData()];
                                });
                            }); })];
                    case 1:
                        // Have to make two "sets" of calls for query, the first one tells us the maximum size per page of data
                        // we can get, the following uses that maximum and offsets to the appropriate location to get the data
                        // afterwards, the process repeats
                        _a.sent();
                        return [2 /*return*/, data];
                }
            });
        });
    };
    /**
     *  Log-in using the given username and password.  Will return a session token that must be used in
     *  authenticated requests.
     *  http://docs.synapse.org/rest/POST/login.html
     */
    var login = function (username, password, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/auth/v1/login', { username: username, password: password }, undefined, endpoint);
    };
    /**
     * Get redirect url
     * https://docs.synapse.org/rest/POST/oauth2/authurl.html
     * @param {*} provider
     * @param {*} redirectUrl
     * @param {*} endpoint
     */
    var oAuthUrlRequest = function (provider, redirectUrl, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/auth/v1/oauth2/authurl', { provider: provider, redirectUrl: redirectUrl }, undefined, endpoint);
    };
    /**
     * Get session token from SSO
     * https://docs.synapse.org/rest/POST/oauth2/session.html
     * @param {*} provider
     * @param {*} authenticationCode
     * @param {*} redirectUrl
     * @param {*} endpoint
     */
    var oAuthSessionRequest = function (provider, authenticationCode, redirectUrl, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/auth/v1/oauth2/session', { provider: provider, authenticationCode: authenticationCode, redirectUrl: redirectUrl }, undefined, endpoint);
    };
    /**
     * Create an entity (Project, Folder, File, Table, View)
     * http://docs.synapse.org/rest/POST/entity.html
     */
    var createEntity = function (entity, sessionToken, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/repo/v1/entity', entity, sessionToken, endpoint);
    };
    /**
     * Create a project with the given name.
     * http://docs.synapse.org/rest/POST/entity.html
     */
    var createProject = function (name, sessionToken, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return createEntity({
            name: name,
            concreteType: 'org.sagebionetworks.repo.model.Project'
        }, sessionToken, endpoint);
    };
    /**
     * Return this user's UserProfile
     * http://docs.synapse.org/rest/GET/userProfile.html
     */
    var getUserProfile = function (sessionToken, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doGet('/repo/v1/userProfile', sessionToken, endpoint);
    };
    /**
     * Return the User Profiles for the given list of user IDs
     * http://docs.synapse.org/rest/POST/userProfile.html
     */
    var getUserProfiles = function (userIdsArray, endpoint) {
        if (userIdsArray === void 0) { userIdsArray = []; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/repo/v1/userProfile', { list: userIdsArray }, undefined, endpoint);
    };
    /**
     * Return the children (Files/Folders) of the given entity (Project or Folder).
     * http://docs.synapse.org/rest/POST/entity/children.html
     */
    var getEntityChildren = function (request, sessionToken, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/repo/v1/entity/children', request, sessionToken, endpoint);
    };
    /**
     * Get a batch of pre-signed URLs and/or FileHandles for the given list of FileHandleAssociations.
     * http://docs.synapse.org/rest/POST/fileHandle/batch.html
     */
    var getFiles = function (request, sessionToken, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        return doPost('/file/v1/fileHandle/batch', request, sessionToken, endpoint);
    };
    /**
     * Bundled access to Entity and related data components.
     * An EntityBundle can be used to create, fetch, or update an Entity and associated
     * objects with a single web service request.
     * See SynapseClient.test.js for an example partsMask.
     * https://docs.synapse.org/rest/org/sagebionetworks/repo/model/Entity.html
     */
    var getEntity = function (sessionToken, entityId, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "/repo/v1/entity/" + entityId;
        return doGet(url, sessionToken, endpoint);
    };
    /**
     * Bundled access to Entity and related data components.
     * An EntityBundle can be used to create, fetch, or update an Entity and
     * associated objects with a single web service request.
     * See SynapseClient.test.js for an example partsMask.
     * http://docs.synapse.org/rest/GET/entity/id/version/versionNumber/bundle.html
     */
    var getEntityBundleForVersion = function (entityId, version, partsMask, sessionToken, endpoint) {
        if (sessionToken === void 0) { sessionToken = undefined; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "/repo/v1/entity/" + entityId;
        if (version) {
            url += "/version/ + " + version;
        }
        url += "/bundle?mask= " + partsMask;
        return doGet(url, sessionToken, endpoint);
    };
    /**
     * Get Wiki page contents, call is of the form:
     * http://docs.synapse.org/rest/GET/entity/ownerId/wiki.html
     */
    var getEntityWiki = function (sessionToken, ownerId, wikiId, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "/repo/v1/entity/" + ownerId + "/wiki/" + wikiId;
        return doGet(url, sessionToken, endpoint);
    };
    /**
     * Returns synapse user favorites list given their session token
     * http://docs.synapse.org/rest/GET/favorite.html
     */
    var getUserFavorites = function (sessionToken, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = 'repo/v1/favorite?offset=0&limit=200';
        return doGet(url, sessionToken, endpoint);
    };
    /**
     *  http://docs.synapse.org/rest/GET/projects/type.html
     *  @param {String} projectDetails Can be "MY_PROJECTS", "MY_CREATED_PROJECTS" or "MY_PARTICIPATED_PROJECTS"
     */
    var getUserProjectList = function (sessionToken, projectDetails, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "repo/v1/projects/" + projectDetails + "?offset=0&limit=200";
        return doGet(url, sessionToken, endpoint);
    };
    /**
     * Get the user's list of teams they are on
     *
     * @param {*} id ownerID of the synapse user see - http://docs.synapse.org/rest/org/sagebionetworks/repo/model/UserProfile.html
     */
    var getUserTeamList = function (sessionToken, id, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "repo/v1/user/" + id + "/team?offset=0&limit=200";
        return doGet(url, sessionToken, endpoint);
    };
    /**
     * Get the user's list of teams they are on
     *
     * @param {*} id ownerID of the synapse user see -https://docs.synapse.org/rest/GET/teamMembers/id.html
     * @param {*} fragment (optional) a prefix of the user's first or last name or email address (optional)
     * @param {*} limit    (optional) the maximum number of members to return (default 10, max limit 50)
     * @param {*} offset   (optional) the starting index of the returned results (default 0)
     *
     */
    var getTeamList = function (sessionToken, id, fragment, limit, offset, endpoint) {
        if (fragment === void 0) { fragment = ''; }
        if (limit === void 0) { limit = 10; }
        if (offset === void 0) { offset = 0; }
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "repo/v1/teamMembers/" + id + "?limit=" + limit + "&offset=" + offset + (fragment ? "&fragment=" + fragment : '');
        return doGet(url, sessionToken, endpoint);
    };
    var getWikiAttachmentsFromEntity = function (sessionToken, id, wikiId, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "repo/v1/entity/" + id + "/wiki/" + wikiId + "/attachmenthandles";
        return doGet(url, sessionToken, endpoint);
    };
    var getWikiAttachmentsFromEvaluation = function (sessionToken, id, wikiId, endpoint) {
        if (endpoint === void 0) { endpoint = DEFAULT_ENDPOINT; }
        var url = "repo/v1/evaluation/" + id + "/wiki/" + wikiId + "/attachmenthandles";
        return doGet(url, sessionToken, endpoint);
    };

    var SynapseClient = /*#__PURE__*/Object.freeze({
        doPost: doPost,
        doGet: doGet,
        getVersion: getVersion,
        getQueryTableResultsFromJobId: getQueryTableResultsFromJobId,
        getIntuitiveQueryTableResults: getIntuitiveQueryTableResults,
        getQueryTableResults: getQueryTableResults,
        getFullQueryTableResults: getFullQueryTableResults,
        login: login,
        oAuthUrlRequest: oAuthUrlRequest,
        oAuthSessionRequest: oAuthSessionRequest,
        createEntity: createEntity,
        createProject: createProject,
        getUserProfile: getUserProfile,
        getUserProfiles: getUserProfiles,
        getEntityChildren: getEntityChildren,
        getFiles: getFiles,
        getEntity: getEntity,
        getEntityBundleForVersion: getEntityBundleForVersion,
        getEntityWiki: getEntityWiki,
        getUserFavorites: getUserFavorites,
        getUserProjectList: getUserProjectList,
        getUserTeamList: getUserTeamList,
        getTeamList: getTeamList,
        getWikiAttachmentsFromEntity: getWikiAttachmentsFromEntity,
        getWikiAttachmentsFromEvaluation: getWikiAttachmentsFromEvaluation
    });

    var Bookmarks = /** @class */ (function (_super) {
        __extends(Bookmarks, _super);
        function Bookmarks(props) {
            var _this = _super.call(this, props) || this;
            _this.renderBookmarks = _this.renderBookmarks.bind(_this);
            return _this;
        }
        /**
         * Returns bookmarks
         *
         * @returns JSX for the embedded bookmarks in the markdown passed in as a prop
         * @memberof Bookmarks
         */
        Bookmarks.prototype.renderBookmarks = function () {
            var copyFootnotes = String(this.props.footnotes);
            // find all the links embedded in the markdown below
            var regex = /Synapse widget&gt;<\/span>(.*)</g;
            var matchedGroup;
            var output = [];
            // below we use regex.exec to find the find matched group containing the citation source
            while (matchedGroup = regex.exec(copyFootnotes)) {
                output.push(matchedGroup[1]);
            }
            // return all the links formatted accordingly
            return output.map(function (el, index) {
                var isBeforeLastElement = index < output.length - 1;
                return (React.createElement(React.Fragment, { key: index },
                    React.createElement("span", null,
                        React.createElement("a", { href: '', id: "bookmark" + index },
                            "[",
                            index + 1,
                            "]")),
                    el,
                    isBeforeLastElement && React.createElement("br", null)));
            });
        };
        Bookmarks.prototype.render = function () {
            return (React.createElement(React.Fragment, null,
                React.createElement("hr", null),
                this.renderBookmarks()));
        };
        return Bookmarks;
    }(React.Component));

    var SynapseImage = /** @class */ (function (_super) {
        __extends(SynapseImage, _super);
        function SynapseImage(props) {
            var _this = _super.call(this, props) || this;
            _this.getEntity = _this.getEntity.bind(_this);
            _this.getSynapseFiles = _this.getSynapseFiles.bind(_this);
            _this.compareById = _this.compareById.bind(_this);
            _this.state = {
                isLoaded: false,
                preSignedURL: ''
            };
            return _this;
        }
        SynapseImage.prototype.compareById = function (fileName, key) {
            return function (element) { return element[key] === fileName; };
        };
        /**
         * Attach markdown to wiki attachments
         */
        SynapseImage.prototype.matchToHandle = function (comparator, objectList) {
            if (objectList) {
                // make sure the files have loaded
                var filtered = objectList.filter(comparator);
                return filtered;
            }
            return [];
        };
        SynapseImage.prototype.getEntity = function () {
            var _this = this;
            var _a = this.props, token = _a.token, synapseId = _a.synapseId;
            getEntity(token, synapseId).then(
            // https://docs.synapse.org/rest/org/sagebionetworks/repo/model/FileEntity.html
            function (data) {
                var fileHandleAssociationList = [
                    {
                        associateObjectId: synapseId,
                        associateObjectType: 'FileEntity',
                        fileHandleId: data.dataFileHandleId
                    }
                ];
                _this.getSynapseFiles(fileHandleAssociationList, data.dataFileHandleId);
            });
        };
        SynapseImage.prototype.getSynapseFiles = function (fileHandleAssociationList, id) {
            var _this = this;
            // overload the method for two different use cases, one where
            // the image is attached to an entity and creates a list on the spot,
            // the other where list is passed in from componentDidMount in MarkdownSynapse
            var request = {
                includeFileHandles: false,
                includePreSignedURLs: true,
                includePreviewPreSignedURLs: false,
                requestedFiles: fileHandleAssociationList
            };
            getFiles(request, this.props.token).then(function (data) {
                var match = _this.matchToHandle(_this.compareById(id, 'fileHandleId'), data.requestedFiles);
                _this.setState({
                    preSignedURL: match[0].preSignedURL
                });
            });
        };
        SynapseImage.prototype.componentDidMount = function () {
            if (!this.props.token) {
                return;
            }
            if (!this.props.hasOwnProperty('wikiId')) {
                this.getEntity();
            }
            else {
                var _a = this.props, fileName = _a.fileName, fileResults = _a.fileResults;
                var match = this.matchToHandle(this.compareById(fileName, 'fileName'), fileResults);
                var fileHandleAssociationList = [
                    {
                        associateObjectId: this.props.wikiId,
                        associateObjectType: 'WikiAttachment',
                        fileHandleId: match[0].id
                    }
                ];
                this.getSynapseFiles(fileHandleAssociationList, match[0].id);
            }
        };
        SynapseImage.prototype.render = function () {
            var imgStyle = {};
            var params = this.props.params;
            if (params && params.align) {
                imgStyle.float = params.align.toLowerCase();
            }
            if (this.state.isLoaded) {
                return null;
            }
            return (React.createElement(React.Fragment, null,
                React.createElement("img", { alt: "synapse", className: "img-fluid", src: this.state.preSignedURL, style: imgStyle })));
        };
        return SynapseImage;
    }(React.Component));

    var SynapsePlot = /** @class */ (function (_super) {
        __extends(SynapsePlot, _super);
        function SynapsePlot(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                isLoaded: false,
                // @ts-ignore
                queryData: {}
            };
            _this.fetchPlotlyData = _this.fetchPlotlyData.bind(_this);
            _this.showPlot = _this.showPlot.bind(_this);
            return _this;
        }
        SynapsePlot.prototype.componentDidMount = function () {
            this.fetchPlotlyData();
        };
        /**
         * Get data for plotly
         *
         * @returns data corresponding to plotly widget
         */
        SynapsePlot.prototype.fetchPlotlyData = function () {
            var _this = this;
            var token = this.props.token;
            var query = this.props.widgetparamsMapped.query;
            var queryRequest = {
                concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',
                partMask: BUNDLE_MASK_QUERY_RESULTS,
                query: {
                    sql: query
                }
            };
            getFullQueryTableResults(queryRequest, token).then(function (data) {
                _this.setState({
                    isLoaded: true,
                    queryData: data
                });
            }).catch(function (err) {
                console.log('Error on full table query ', err);
            });
        };
        SynapsePlot.prototype.showPlot = function () {
            if (!this.state.isLoaded) {
                return;
            }
            var _a = this.props.widgetparamsMapped, title = _a.title, xtitle = _a.xtitle, ytitle = _a.ytitle, type = _a.type, xaxistype = _a.xaxistype, showlegend = _a.showlegend;
            var queryData = this.state;
            var isHorizontal = this.props.widgetparamsMapped.horizontal.toLowerCase();
            var layout = {
                showlegend: showlegend,
                title: title
            };
            if (xtitle) {
                layout.xaxis = {
                    title: xtitle
                };
            }
            if (xaxistype) {
                layout.xaxis = __assign({}, layout.xaxis, { xaxistype: xaxistype.toLowerCase() });
            }
            if (ytitle) {
                layout.yaxis = {
                    title: ytitle
                };
            }
            // init plot_data
            var plotData = [];
            var orientation = isHorizontal ? 'v' : 'h';
            var headers = queryData.queryData.queryResult.queryResults.headers;
            for (var i = 0; i < headers.length - 1; i += 1) {
                // make an entry for each set of data points
                plotData[i] = {
                    orientation: orientation,
                    name: headers[i + 1].name,
                    type: type.toLowerCase(),
                    x: [],
                    y: []
                };
            }
            // grab all the data
            for (var _i = 0, _b = queryData.queryData.queryResult.queryResults.rows; _i < _b.length; _i++) {
                var row = _b[_i];
                for (var j = 1; j < row.values.length; j += 1) {
                    // create pairs of data
                    var rowValues = row.values;
                    plotData[j - 1].x.push(rowValues[0]);
                    plotData[j - 1].y.push(rowValues[j]);
                }
            }
            return React.createElement(Plot, { data: plotData, layout: layout });
        };
        SynapsePlot.prototype.render = function () {
            if (!this.state.isLoaded) {
                return null;
            }
            return React.createElement(React.Fragment, null, this.showPlot());
        };
        return SynapsePlot;
    }(React.Component));

    var TOC_CLASS = {
        1: 'toc-indent1',
        2: 'toc-indent2',
        3: 'toc-indent3',
        4: 'toc-indent4',
        5: 'toc-indent5',
        6: 'toc-indent6'
    };
    var TOC_HEADER_REGEX = /<h[1-6] toc="true">.*<\/h[1-6]>/gm;
    var TOC_HEADER_REGEX_WITH_ID = /<h([1-6]) id="(.*)" .*toc="true">(.*)<\/h[1-6]>/gm;
    var md = require('markdown-it')({ html: true });
    var markdownitSynapse = require('markdown-it-synapse');
    var markdownSubAlt = require('markdown-it-sub-alt');
    var markdownCenterText = require('markdown-it-center-text');
    var markdownSynapseHeading = require('markdown-it-synapse-heading');
    var markdownSynapseTable = require('markdown-it-synapse-table');
    var markdownStrikethrough = require('markdown-it-strikethrough-alt');
    var markdownContainer = require('markdown-it-container');
    var markdownEmpahsisAlt = require('markdown-it-emphasis-alt');
    var markdownInlineComments = require('markdown-it-inline-comments');
    var markdownBr = require('markdown-it-br');
    var sanitizeHtml = require('sanitize-html');
    var synapseMath = require('markdown-it-synapse-math');
    /**
     * Basic vanilla Markdownit functionality with latex support, synapse image support, plotly support
     *
     * @class Markdown
     * @extends {React.Component}
     */
    var MarkdownSynapse = /** @class */ (function (_super) {
        __extends(MarkdownSynapse, _super);
        /**
         * Creates an instance of Markdown.
         * @param {*} props
         */
        function MarkdownSynapse(props) {
            var _this = _super.call(this, props) || this;
            // markdownitSynapse wraps around md object and uses its own dependencies
            markdownitSynapse.init_markdown_it(md, markdownSubAlt, markdownEmpahsisAlt, markdownCenterText, markdownSynapseHeading, markdownSynapseTable, markdownStrikethrough, markdownContainer, markdownEmpahsisAlt, markdownInlineComments, markdownBr);
            var mathSuffix = '';
            // Update the internal md object with the wrapped synapse object
            md.use(markdownitSynapse, mathSuffix).use(synapseMath, mathSuffix);
            _this.state = {
                md: md,
                errorMessage: '',
                fileHandles: undefined,
                isLoggedIn: _this.props.token !== '',
                newOwnerId: '',
                newWikiId: '',
                text: ''
            };
            _this.markupRef = React.createRef();
            _this.handleLinkClicks = _this.handleLinkClicks.bind(_this);
            // handle widgets and math markdown
            _this.processWidgets = _this.processWidgets.bind(_this);
            _this.processWidgetOrDomElement = _this.processWidgetOrDomElement.bind(_this);
            _this.processMath = _this.processMath.bind(_this);
            // handle init calls to get wiki related items
            _this.getWikiAttachments = _this.getWikiAttachments.bind(_this);
            _this.getWikiPageMarkdown = _this.getWikiPageMarkdown.bind(_this);
            // handle rendering widgets
            _this.renderWidget = _this.renderWidget.bind(_this);
            _this.renderSynapseButton = _this.renderSynapseButton.bind(_this);
            _this.renderSynapseImage = _this.renderSynapseImage.bind(_this);
            _this.renderSynapsePlot = _this.renderSynapsePlot.bind(_this);
            _this.renderSynapseTOC = _this.renderSynapseTOC.bind(_this);
            _this.getErrorView = _this.getErrorView.bind(_this);
            _this.createMarkup = _this.createMarkup.bind(_this);
            _this.addBookmarks = _this.addBookmarks.bind(_this);
            return _this;
        }
        MarkdownSynapse.prototype.componentDidCatch = function (err, info) {
            console.log('error ', err);
            console.log('info ', info);
        };
        MarkdownSynapse.prototype.componentWillUnmount = function () {
            // @ts-ignore TODO: give justification for ignoring this line
            this.markupRef.current.removeEventListener('click', this.handleLinkClicks);
        };
        // manually handle clicks to anchor tags
        MarkdownSynapse.prototype.handleLinkClicks = function (event) {
            event.preventDefault();
            // because this listener acts on the whole page (which is desired)
            // we have to cast the event to an anchor because that's what were interested in
            // responding to
            var anchor = event.target;
            if (anchor.tagName === 'A') {
                if (anchor.getAttribute('data-anchor') === null && anchor.id === '') {
                    window.open(anchor.href, '_blank');
                }
                else if (anchor.id.substring(0, 3) === 'ref') {
                    var referenceNumber = Number(event.currentTarget.id.substring(3)); // e.g. ref2 => '2'
                    var goTo = this.markupRef.current.querySelector("#bookmark" + referenceNumber);
                    try {
                        goTo.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center',
                            inline: 'center'
                        });
                    }
                    catch (e) {
                        console.log('error on scroll', e);
                    }
                }
                else if (event.currentTarget.id !== null) {
                    var idOfContent = anchor.getAttribute('data-anchor');
                    var goTo = this.markupRef.current.querySelector("#" + idOfContent);
                    try {
                        goTo.scrollIntoView({
                            behavior: 'smooth',
                            block: 'center',
                            inline: 'center'
                        });
                    }
                    catch (e) {
                        console.log('error on scroll', e);
                    }
                }
            }
        };
        /**
         * Given input text, generate markdown object to be passed onto inner html of some container.
         * @param {String} text The text being written in plain markdown
         * @returns {Object} Dictionary to be passed into dangerouslySetInnerHTML with markdown text
         */
        MarkdownSynapse.prototype.createMarkup = function (text) {
            var initText = this.state.md.render(text);
            var cleanText = sanitizeHtml(initText, {
                allowedAttributes: {
                    a: ['href'],
                    button: ['class'],
                    div: ['class', 'style'],
                    h1: ['toc'],
                    h2: ['toc'],
                    h3: ['toc'],
                    h4: ['toc'],
                    h5: ['toc'],
                    h6: ['toc'],
                    li: ['class'],
                    ol: ['class'],
                    span: ['*'],
                    table: ['class'],
                    th: ['class'],
                    thead: ['class'],
                    ul: ['class']
                },
                allowedTags: [
                    'span',
                    'code',
                    'h1',
                    'h2',
                    'h3',
                    'h4',
                    'h5',
                    'p',
                    'b',
                    'i',
                    'em',
                    'strong',
                    'a',
                    'id',
                    'table',
                    'tr',
                    'td',
                    'tbody',
                    'th',
                    'thead',
                    'button',
                    'div',
                    'image',
                    'ol',
                    'ul',
                    'li',
                    'svg',
                    'g',
                    'br',
                    'hr',
                    'summary',
                    'details'
                ]
            });
            return { __html: cleanText };
        };
        /**
         * Find all math identified elements of the form [id^=\"mathjax-\"]
         * (e.g. <dom element id="mathjax-10"> text </dom element>)
         * and transform them to their math markedown equivalents
         */
        MarkdownSynapse.prototype.processMath = function () {
            if (!this.markupRef.current) {
                return;
            }
            // use regex to grab all elements
            var mathExpressions = this.markupRef.current.querySelectorAll('[id^="mathjax-"]');
            // go through all obtained elements and transform them with katex
            mathExpressions.forEach(function (element) {
                katex.render(element.textContent, element, {
                    // @ts-ignore: The docs for katex report conflicting information
                    // about the typescript docs for katex usage
                    delimiters: [
                        {
                            display: true,
                            left: '$$',
                            right: '$$'
                        },
                        {
                            display: false,
                            left: '\\(',
                            right: '\\)'
                        },
                        {
                            display: true,
                            left: '\\[',
                            right: '\\]'
                        }
                    ],
                    throwOnError: false
                });
            });
        };
        /**
         * Process all the corresponding bookmark tags of the references made throughout the page
         *
         * @memberof MarkdownSynapse
         */
        MarkdownSynapse.prototype.addBookmarks = function () {
            markdownitSynapse.resetFootnotes();
            this.createMarkup(this.state.text);
            var footnotesHtml = this.createMarkup(markdownitSynapse.footnotes())
                .__html;
            if (footnotesHtml.length > 0) {
                var bookmarks = React.createElement(Bookmarks, { footnotes: footnotesHtml });
                return bookmarks;
            }
            // ts doesn't like functions without explicit return statements
            return;
        };
        /**
         * Call Synapse REST API to get AMP-AD wiki portal markdown as demo of API call
         */
        MarkdownSynapse.prototype.getWikiPageMarkdown = function () {
            var _this = this;
            if (!this.state.text) {
                getEntityWiki(this.props.token, this.props.ownerId, this.props.wikiId)
                    .then(function (data) {
                    // on success grab text and append to the default text
                    var initText = _this.state.text;
                    _this.setState({
                        text: initText + data.markdown
                    });
                    if (_this.props.updateLoadState) {
                        _this.props.updateLoadState({ isLoading: false });
                    }
                })
                    .catch(function (err) {
                    console.log('Error on wiki markdown load\n', err);
                });
            }
            // else the wiki page was retrieved accordingly or it was passed down
            // as a prop
        };
        MarkdownSynapse.prototype.getWikiAttachments = function () {
            var _this = this;
            // bang operator on ownerId and wikiId b/c this will only get called if we had found out above
            // that this was specified
            getWikiAttachmentsFromEntity(this.props.token, this.props.ownerId, this.props.wikiId)
                .then(function (data) {
                _this.setState({ fileHandles: data, errorMessage: '' });
            })
                .catch(function (err) {
                _this.setState({
                    errorMessage: err.reason
                });
                console.log('Error on wiki attachment load ', err);
            });
        };
        /**
         * If theres an error loading the wiki page show an informative message
         * likely a priveledge issue -- (e.g. not signed-in)
         *
         * @returns view that presents error message on error, otherwise null
         */
        MarkdownSynapse.prototype.getErrorView = function () {
            if (this.state.errorMessage && this.props.errorMessageView) {
                var errorViewWithProps = React.cloneElement(this.props.errorMessageView, {
                    message: this.state.errorMessage
                });
                return (React.createElement(React.Fragment, null, errorViewWithProps));
            }
            return;
        };
        MarkdownSynapse.prototype.processWidgets = function () {
            // (<span data-widgetparams.*?span>) captures widgets
            var count = 1;
            var markup = this.createMarkup(this.state.text).__html.replace(/<span id="wikiReference.*?<span data-widgetparams.*?span>/g, function () {
                // replace all reference tags with id's that we can later target
                var current = count;
                count += 1;
                return "<a href=\"\" id=\"ref" + current + "\">[" + current + "]</a>";
            });
            var tocId = 'SRC-header-';
            var tocIdCount = 1;
            markup = markup.replace(TOC_HEADER_REGEX, function (match) {
                // replace with id so we can target them alter with click events
                var curTocId = tocIdCount;
                tocIdCount += 1;
                var matchWithId = match.substring(0, 3) + " id=\"" + tocId + curTocId + "\"" + match.substring(3);
                return matchWithId;
            });
            var groups = markup.split(/(<span data-widgetparams.*?span>)/);
            if (groups.length > 0) {
                return this.processWidgetOrDomElement(groups, markup);
            }
            return;
        };
        MarkdownSynapse.prototype.decodeXml = function (xml) {
            var escapedOneToXmlSpecialMap = {
                '&amp;': '&',
                '&gt;': '>',
                '&lt;': '<',
                '&quot;': '"'
            };
            return xml.replace(/(&quot;|&lt;|&gt;|&amp;)/g, function (str, item) {
                return escapedOneToXmlSpecialMap[item];
            });
        };
        MarkdownSynapse.prototype.processWidgetMappings = function (rawWidgetString, originalMarkup) {
            var widgetstringRegExp = rawWidgetString.match(/data-widgetparams=("(.*?)")/);
            var widgetstring = this.decodeXml(widgetstringRegExp[2]);
            var questionIndex = widgetstring.indexOf('?');
            if (questionIndex === -1) {
                // e.g. toc is passed, there are no params
                return this.renderWidget(widgetstring, {}, originalMarkup);
            }
            var widgetType = widgetstring.substring(0, questionIndex);
            var widgetparamsMapped = {};
            // map out params and their values
            widgetstring
                .substring(questionIndex + 1)
                .split('&')
                .forEach(function (keyPair) {
                var _a = keyPair.split('='), key = _a[0], value = _a[1];
                value = decodeURIComponent(value);
                widgetparamsMapped[key] = value;
            });
            return this.renderWidget(widgetType, widgetparamsMapped, originalMarkup);
        };
        MarkdownSynapse.prototype.processWidgetOrDomElement = function (widgetsToBe, originalMarkup) {
            var widgets = [];
            for (var _i = 0, widgetsToBe_1 = widgetsToBe; _i < widgetsToBe_1.length; _i++) {
                var text = widgetsToBe_1[_i];
                if (text.indexOf('<span data-widgetparams') !== -1) {
                    widgets.push(this.processWidgetMappings(text, originalMarkup));
                }
                else {
                    widgets.push(React.createElement("span", { key: uuidv4(), dangerouslySetInnerHTML: { __html: text } }));
                }
            }
            return widgets;
        };
        MarkdownSynapse.prototype.renderWidget = function (widgetType, widgetparamsMapped, originalMarkup) {
            switch (widgetType) {
                case 'buttonlink':
                    return this.renderSynapseButton(widgetparamsMapped);
                case 'image':
                    return this.renderSynapseImage(widgetparamsMapped);
                case 'plot':
                    return this.renderSynapsePlot(widgetparamsMapped);
                case 'toc':
                    return this.renderSynapseTOC(originalMarkup);
                default:
                    return;
            }
        };
        MarkdownSynapse.prototype.renderSynapseButton = function (widgetparamsMapped) {
            return (React.createElement("a", { key: uuidv4(), href: widgetparamsMapped.url, className: "btn btn-lg btn-info", role: "button" }, widgetparamsMapped.text));
        };
        MarkdownSynapse.prototype.renderSynapsePlot = function (widgetparamsMapped) {
            return (React.createElement(SynapsePlot, { key: uuidv4(), token: this.props.token, ownerId: this.props.ownerId, wikiId: this.props.wikiId, widgetparamsMapped: widgetparamsMapped }));
        };
        MarkdownSynapse.prototype.renderSynapseImage = function (widgetparamsMapped) {
            if (!this.state.fileHandles) {
                // ensure files are loaded
                return;
            }
            if (widgetparamsMapped.fileName) {
                return (React.createElement(SynapseImage, { params: widgetparamsMapped, key: uuidv4(), token: this.props.token, fileName: widgetparamsMapped.fileName, wikiId: this.props.wikiId, fileResults: this.state.fileHandles.list }));
            }
            if (widgetparamsMapped.synapseId) {
                // elements with synapseIds have to have their resources loaded first, their not located
                // with the file attachnent list
                return (React.createElement(SynapseImage, { params: widgetparamsMapped, key: uuidv4(), token: this.props.token, synapseId: widgetparamsMapped.synapseId }));
            }
            return;
        };
        MarkdownSynapse.prototype.renderSynapseTOC = function (originalMarkup) {
            // for TOC
            var elements = [];
            originalMarkup.replace(TOC_HEADER_REGEX_WITH_ID, function (p1, p2, p3, p4) {
                elements.push(React.createElement("div", { key: uuidv4() },
                    React.createElement("a", { className: "link " + TOC_CLASS[Number(p2)], "data-anchor": p3 },
                        ' ',
                        p4,
                        ' ')));
                return '';
            });
            return React.createElement("div", { key: uuidv4() }, elements);
        };
        MarkdownSynapse.prototype.componentDidMount = function () {
            if (this.props.markdown) {
                this.setState({
                    text: this.props.markdown
                });
            }
            // @ts-ignore
            this.markupRef.current.addEventListener('click', this.handleLinkClicks);
            // unpack and set default value if not specified
            var _a = this.props.hasSynapseResources, hasSynapseResources = _a === void 0 ? true : _a;
            if (hasSynapseResources) {
                // get wiki attachments
                this.getWikiAttachments();
                this.getWikiPageMarkdown();
            }
            this.processMath();
        };
        // on component update find and re-render the math/widget items accordingly
        MarkdownSynapse.prototype.componentDidUpdate = function () {
            // we have to carefully update the component so it doesn't encounter an infinite loop
            if (this.props.token !== '' && !this.state.isLoggedIn) {
                // this is true when user just logged
                this.setState({ isLoggedIn: true });
                // only if they didn't supply markdown should this happen
                if (this.props.hasSynapseResources) {
                    this.getWikiAttachments();
                    this.getWikiPageMarkdown();
                }
            }
            this.processMath();
        };
        MarkdownSynapse.prototype.render = function () {
            return (React.createElement("div", { className: "markdown", ref: this.markupRef },
                this.getErrorView(),
                React.createElement("span", null, this.processWidgets()),
                React.createElement("div", null, this.addBookmarks())));
        };
        MarkdownSynapse.propTypes = {
            errorMessageView: PropTypes.element,
            hasSynapseResources: PropTypes.bool,
            markdown: PropTypes.string,
            ownerId: PropTypes.string,
            token: PropTypes.string,
            updateLoadState: PropTypes.func,
            wikiId: PropTypes.string
        };
        return MarkdownSynapse;
    }(React.Component));

    /**
     * Class wraps around any Synapse views that are dependent on a query bundle
     * Those classes then take in as props:
     *
     * @class QueryWrapper
     * @extends {React.Component}
     */
    var QueryWrapper = /** @class */ (function (_super) {
        __extends(QueryWrapper, _super);
        function QueryWrapper(props) {
            var _this = _super.call(this, props) || this;
            _this.executeInitialQueryRequest = _this.executeInitialQueryRequest.bind(_this);
            _this.executeQueryRequest = _this.executeQueryRequest.bind(_this);
            _this.getLastQueryRequest = _this.getLastQueryRequest.bind(_this);
            _this.getNextPageOfData = _this.getNextPageOfData.bind(_this);
            _this.resetFacetSelection = _this.resetFacetSelection.bind(_this);
            _this.updateParentState = _this.updateParentState.bind(_this);
            _this.state = {
                data: undefined,
                isChecked: [],
                isLoading: true,
                isLoadingNewData: true,
                lastQueryRequest: {},
            };
            return _this;
        }
        /**
         * Compute default query request
         *
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.componentDidMount = function () {
            if (this.props.json === null) {
                this.executeInitialQueryRequest();
            }
            else {
                this.setState({
                    data: cloneDeep$1(this.props.json)
                });
            }
        };
        /**
         * @memberof QueryWrapper
         *
         */
        QueryWrapper.prototype.componentDidUpdate = function (prevProps) {
            /**
             *  If component updates and the token has changed (they signed in) then the data should be pulled in. Or if the
             *  sql query has changed of the component then perform an update.
             */
            if (this.props.token !== '' && prevProps.token === '' && !this.props.json) {
                this.executeInitialQueryRequest();
            }
            if (prevProps.initQueryRequest.query.sql !== this.props.initQueryRequest.query.sql) {
                this.executeInitialQueryRequest();
            }
        };
        /**
         * Pass down a deep clone (so no side affects on the child's part) of the
         * last query request made
         *
         * @returns
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.getLastQueryRequest = function () {
            return cloneDeep$1(this.state.lastQueryRequest);
        };
        /**
         * Execute the given query
         *
         * @param {*} queryRequest Query request as specified by
         *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.executeQueryRequest = function (queryRequest) {
            var _this = this;
            this.setState({
                isLoading: true
            });
            getIntuitiveQueryTableResults(queryRequest, this.props.token, this.props.facetName, this.state.data)
                .then(function (data) {
                var newState = {
                    data: data,
                    isLoading: false,
                    lastQueryRequest: cloneDeep$1(queryRequest)
                };
                _this.setState(newState);
            }).catch(function (err) {
                console.log('Failed to get data ', err);
            });
        };
        /**
         * Grab the next page of data, pulling in 25 more rows.
         *
         * @param {*} queryRequest Query request as specified by
         *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.getNextPageOfData = function (queryRequest) {
            var _this = this;
            this.setState({
                isLoading: true
            });
            return getQueryTableResults(queryRequest, this.props.token)
                .then(function (data) {
                var _a;
                var oldData = cloneDeep$1(_this.state.data);
                // push on the new data retrieved from the API call
                (_a = oldData.queryResult.queryResults.rows).push.apply(_a, data.queryResult.queryResults.rows);
                var newState = {
                    data: oldData,
                    isLoading: false,
                    lastQueryRequest: cloneDeep$1(queryRequest)
                };
                _this.setState(newState);
                return Promise.resolve(data.queryResult.queryResults.rows.length > 0);
            }).catch(function (err) {
                console.log('Failed to get data ', err);
            });
        };
        /**
         * Execute the initial query passed into the component
         *
         * @param {*} queryRequest Query request as specified by
         *                         https://docs.synapse.org/rest/org/sagebionetworks/repo/model/table/Query.html
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.executeInitialQueryRequest = function () {
            var _this = this;
            this.setState({
                isChecked: [],
                isLoading: true,
                isLoadingNewData: true
            });
            getQueryTableResults(this.props.initQueryRequest, this.props.token)
                .then(function (data) {
                var filter = _this.props.facetName;
                var lastQueryRequest = _this.resetFacetSelection(data, filter);
                var newState = {
                    data: data,
                    lastQueryRequest: lastQueryRequest,
                    isLoading: false,
                    isLoadingNewData: false
                };
                _this.setState(newState);
            }).catch(function (err) {
                console.log('Failed to get data ', err);
            });
        };
        /**
         * Reset the initial set of facets for the lastQueryRequest object
         *
         * @private
         * @param {QueryResultBundle} data
         * @param {string} filter the facet used to filter the synapse table
         * @returns
         * @memberof QueryWrapper
         */
        QueryWrapper.prototype.resetFacetSelection = function (data, filter) {
            // we have to reset the facet selections by getting the original
            // facet corresponding to the original filter
            var facetsForFilter = data.facets.filter(function (obj) {
                return obj.columnName === filter;
            })[0];
            // next we have to selectively choose those facets and their
            // corresponding counts, we have to get the full counts because of
            // the nature that we are clicking elements and turning them "off"
            // this is a peculiarity due to UX and the synapse backend having different behavior
            var facetsMapped = facetsForFilter.facetValues.map(function (el) {
                return el.value;
            });
            var lastQueryRequest = cloneDeep$1(this.props.initQueryRequest);
            lastQueryRequest.query.selectedFacets = [
                {
                    columnName: filter,
                    concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',
                    facetValues: facetsMapped
                }
            ];
            return lastQueryRequest;
        };
        QueryWrapper.prototype.updateParentState = function (update) {
            // This is a hack needed because the barchart and the facets have to stay insync
            // with each other (their colors), but they exist side by side in the component tree, so we
            // have to pass the isChecked array up through querywrapper
            this.setState(update);
        };
        /**
         * Render the children without any formatting
         */
        QueryWrapper.prototype.render = function () {
            var _this = this;
            // inject props in children of this component
            var childrenWithProps = (React.Children.map(this.props.children, function (child) {
                return React.cloneElement(child, {
                    data: _this.state.data,
                    executeInitialQueryRequest: _this.executeInitialQueryRequest,
                    executeQueryRequest: _this.executeQueryRequest,
                    getLastQueryRequest: _this.getLastQueryRequest,
                    getNextPageOfData: _this.getNextPageOfData,
                    isChecked: _this.state.isChecked,
                    isLoading: _this.state.isLoading,
                    isLoadingNewData: _this.state.isLoadingNewData,
                    filter: _this.props.facetName,
                    rgbIndex: _this.props.rgbIndex,
                    unitDescription: _this.props.unitDescription,
                    updateParentState: _this.updateParentState,
                    isQueryWrapperChild: true
                });
            }));
            if (this.props.showMenu) {
                // menu is to the left of the child components so we let that add its
                // own html
                return (childrenWithProps);
            }
            return (React.createElement("div", { className: "container-fluid" },
                React.createElement("div", { className: 'col-xs-12' }, childrenWithProps)));
        };
        QueryWrapper.propTypes = {
            filter: PropTypes.string,
            initQueryRequest: PropTypes.shape({
                concreteType: PropTypes.string,
                partMask: PropTypes.number,
                query: PropTypes.shape({
                    isConsistent: PropTypes.bool,
                    limit: PropTypes.number,
                    offset: PropTypes.number,
                    selectedFacets: PropTypes.array,
                    sort: PropTypes.array,
                    sql: PropTypes.string
                })
            }),
            json: PropTypes.object,
            loadingScreen: PropTypes.element,
            rgbIndex: PropTypes.number,
            token: PropTypes.string
        };
        QueryWrapper.defaultProps = {
            json: null,
            token: ''
        };
        return QueryWrapper;
    }(React.Component));

    library.add(faAngleLeft);
    library.add(faAngleRight);
    var PREVIOUS_ITEM_CLICK = 'left click';
    var NEXT_CLICK = 'right click';
    /**
     * Make a simple stacked bar char
     *
     * @class StackedRowHomebrew
     * @extends {React.Component}
     */
    var StackedRowHomebrew = /** @class */ (function (_super) {
        __extends(StackedRowHomebrew, _super);
        function StackedRowHomebrew(props) {
            var _this = _super.call(this, props) || this;
            /**
             * Handle column click event
             */
            _this.handleClick = function (dict) { return function (event) {
                // https://medium.freecodecamp.org/reactjs-pass-parameters-to-event-handlers-ca1f5c422b9
                _this.setState({
                    hoverText: dict.value,
                    hoverTextCount: dict.count,
                    index: dict.index
                });
            }; };
            _this.handleArrowClick = function (direction) { return function (_) {
                var index$$1 = _this.state.index;
                if (index$$1 === -1) {
                    index$$1 = 0;
                }
                var dict = _this.extractPropsData(_this.props.data);
                var length = Object.keys(dict).length;
                if (direction === PREVIOUS_ITEM_CLICK) {
                    if (index$$1 === 0) {
                        // wrap around
                        index$$1 = length - 1;
                    }
                    else {
                        index$$1 -= 1;
                    }
                }
                else {
                    if (index$$1 === length - 1) {
                        index$$1 = 0;
                    }
                    else {
                        index$$1 += 1;
                    }
                }
                dict = dict[index$$1];
                _this.setState({
                    index: index$$1,
                    hoverText: dict.value,
                    hoverTextCount: dict.count
                });
            }; };
            _this.handleHover = _this.handleHover.bind(_this);
            _this.handleExit = _this.handleExit.bind(_this);
            _this.handleClick = _this.handleClick.bind(_this);
            _this.handleArrowClick = _this.handleArrowClick.bind(_this);
            _this.getHoverText = _this.getHoverText.bind(_this);
            _this.onMeasureResize = _this.onMeasureResize.bind(_this);
            _this.rgba2rgb = _this.rgba2rgb.bind(_this);
            // the text currently under the cursor
            _this.state = {
                dimensions: { bounds: { height: 1, width: 1, top: 0, left: 0, right: 0, bottom: 0 } },
                hoverText: '',
                hoverTextCount: 0,
                index: -1,
                selectedFacets: {}
            };
            _this.extractPropsData = _this.extractPropsData.bind(_this);
            return _this;
        }
        StackedRowHomebrew.prototype.componentDidUpdate = function (prevProps) {
            if (prevProps.filter !== this.props.filter || prevProps.isLoadingNewData !== this.props.isLoadingNewData) {
                this.setState({
                    hoverText: '',
                    hoverTextCount: 0,
                    index: -1
                });
            }
        };
        /**
         * Updates the hover text and update the view
         *
         * @memberof StackedRowHomebrew
         */
        StackedRowHomebrew.prototype.handleHover = function (event) {
            // add box shadow
            event.currentTarget.style.boxShadow = '25px 20px';
        };
        /**
         * Update the hover text and the view
         *
         * @param {*} event
         * @memberof StackedRowHomebrew
         */
        StackedRowHomebrew.prototype.handleExit = function (event) {
            // remove box shadow
            event.currentTarget.style.boxShadow = '';
        };
        StackedRowHomebrew.prototype.getHoverText = function (xData) {
            var _a = this.state, index$$1 = _a.index, hoverText = _a.hoverText;
            var hoverTextDisplay = index$$1 === -1 ? (xData[0] && xData[0].value) : hoverText;
            return (React.createElement("span", null,
                React.createElement("span", { className: "SRC-text-title" }, this.props.filter),
                " :",
                React.createElement("span", { className: "SRC-text-title" },
                    ' ',
                    hoverTextDisplay === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET' ? 'unannotated' : hoverTextDisplay)));
        };
        StackedRowHomebrew.prototype.getFileCount = function (xData) {
            if (this.state.index === -1) {
                var hoverTextCount = xData[0] && xData[0].count;
                return hoverTextCount;
            }
            return this.state.hoverTextCount;
        };
        StackedRowHomebrew.prototype.rgba2rgb = function (background, color) {
            var alpha = color[3];
            return [
                Math.floor((1 - alpha) * background[0] + alpha * color[0] + 0.5),
                Math.floor((1 - alpha) * background[1] + alpha * color[1] + 0.5),
                Math.floor((1 - alpha) * background[2] + alpha * color[2] + 0.5)
            ];
        };
        StackedRowHomebrew.prototype.advancedSearch = function (xData) {
            var _a = this.state, index$$1 = _a.index, hoverText = _a.hoverText;
            var _b = this.props, filter = _b.filter, _c = _b.synapseId, synapseId = _c === void 0 ? '' : _c;
            var hoverTextDisplay = index$$1 === -1 ? xData[0] && xData[0].value : hoverText;
            // base 64 encode the json of the query and go to url with the encoded object
            var lastQueryRequest = this.props.getLastQueryRequest();
            var query = lastQueryRequest.query;
            query.selectedFacets = [
                {
                    columnName: filter,
                    concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest',
                    facetValues: [hoverTextDisplay]
                }
            ];
            var encodedQuery = btoa(JSON.stringify(query));
            var link = "https://www.synapse.org/#!Synapse:" + synapseId + "/tables/query/" + encodedQuery;
            return link;
        };
        StackedRowHomebrew.prototype.render = function () {
            var _this = this;
            var _a = this.props, data = _a.data, isLoadingNewData = _a.isLoadingNewData, loadingScreen = _a.loadingScreen, rgbIndex = _a.rgbIndex, isChecked = _a.isChecked, filter = _a.filter, unitDescription = _a.unitDescription;
            // while loading
            if (isLoadingNewData) {
                return loadingScreen || React.createElement("div", null);
            }
            var xData = this.extractPropsData(data);
            var total = 0;
            var width = this.state.dimensions.bounds.width;
            // sum up the counts of data
            for (var key in xData) {
                if (xData.hasOwnProperty(key)) {
                    total += xData[key].count;
                }
            }
            var _b = getColorPallette(rgbIndex, xData.length), colorPalette = _b.colorPalette, textColors = _b.textColors;
            var originalColor = colorPalette[0];
            return (React.createElement("div", { className: "container-fluid" },
                React.createElement("div", { className: "row SRC-center-text" },
                    React.createElement("button", { className: "btn btn-default btn-sm SRC-floatRight", onClick: this.handleArrowClick(NEXT_CLICK) },
                        React.createElement(FontAwesomeIcon, { style: { fontSize: '11px' }, className: "SRC-primary-text-color", icon: "angle-right" })),
                    React.createElement("button", { className: "btn btn-default btn-sm SRC-floatRight", onClick: this.handleArrowClick(PREVIOUS_ITEM_CLICK) },
                        React.createElement(FontAwesomeIcon, { style: { fontSize: '11px' }, className: "SRC-primary-text-color", icon: "angle-left" }))),
                React.createElement("div", { className: "row SRC-bar-border SRC-bar-marginTop SRC-bar-border-top" },
                    React.createElement(Measure, { bounds: true, 
                        // tslint:disable-next-line
                        onResize: function (contentRect) {
                            _this.setState({ dimensions: contentRect });
                        } }, function (_a) {
                        var measureRef = _a.measureRef;
                        return (React.createElement("div", { className: "SRC-flex", ref: measureRef }, xData.map(function (obj, index$$1) {
                            var initRender = _this.state.index === -1 && index$$1 === 0;
                            var textColor = textColors[index$$1];
                            var rgbColor = colorPalette[index$$1];
                            var rectStyle;
                            var check = isChecked[index$$1] === undefined || isChecked[index$$1];
                            if (check) {
                                rectStyle = {
                                    fill: rgbColor
                                };
                            }
                            else {
                                rectStyle = {
                                    fill: '#C4C4C4'
                                };
                            }
                            var svgHeight = 80;
                            var svgWidth = obj.count / total * width;
                            var style = {};
                            if (_this.state.index === index$$1 || initRender) {
                                style.filter = 'drop-shadow(5px 5px 5px rgba(0,0,0,0.5))';
                            }
                            var label = filter + ": " + obj.value + "  - " + obj.count + " " + unitDescription;
                            var tooltipId = uuidv4();
                            // basic heuristic to calculate the number of pixels needed to show the value on the bar chart
                            var value = obj.count;
                            var numCharsInValue = value.toString().length * 4.5; // represents width of a character
                            return (
                            // each svg represents one of the bars
                            // will need to change this to be responsive
                            React.createElement(React.Fragment, { key: uuidv4() },
                                React.createElement("span", { "data-for": tooltipId, "data-tip": label },
                                    React.createElement("svg", { className: "SRC-hoverBox", height: svgHeight + 15, width: svgWidth, style: style, onClick: _this.handleClick(__assign({}, obj, { index: index$$1 })) },
                                        React.createElement("rect", { onMouseEnter: _this.handleHover, onMouseLeave: _this.handleExit, height: svgHeight, width: svgWidth, className: "SRC-chart-rect-style", 
                                            // can't remove inline style due to dynamic fill
                                            style: rectStyle }),
                                        index$$1 < 3 && svgWidth > numCharsInValue &&
                                            React.createElement("text", { textAnchor: "middle", className: "SRC-text-title", fontFamily: 'bold sans-serif', fill: textColor, x: '50%', y: '50%' }, obj.count),
                                        // tslint:disable-next-line:jsx-no-multiline-js
                                        (_this.state.index === index$$1 || initRender) &&
                                            (React.createElement("text", { fill: originalColor, x: 0, y: svgHeight + 15, className: "SRC-text-shadow SRC-text-large" }, '\u25BE')))),
                                React.createElement(ReactTooltip, { delayShow: 1000, id: tooltipId })));
                        })));
                    })),
                React.createElement("div", { className: "row SRC-bar-border SRC-bar-border-bottom" },
                    React.createElement("p", { className: "SRC-noMargin SRC-padding-chart SRC-text-title" },
                        React.createElement("strong", null, this.getHoverText(xData))),
                    React.createElement("p", { className: "SRC-noMargin SRC-padding-chart SRC-text-chart" },
                        this.getFileCount(xData),
                        " ",
                        unitDescription))));
        };
        StackedRowHomebrew.prototype.extractPropsData = function (data) {
            var xData = [];
            var filter = this.props.filter;
            data.facets.forEach(function (item) {
                if (item.facetType === 'enumeration' && item.columnName === filter) {
                    item.facetValues.forEach(function (facetValue) {
                        if (item.columnName) {
                            xData.push(__assign({ columnName: item.columnName }, facetValue));
                        }
                    });
                }
            });
            // sort the data so that the largest bars are at the front
            xData.sort(function (a, b) {
                return b.count - a.count;
            });
            return xData;
        };
        StackedRowHomebrew.prototype.onMeasureResize = function (contentRect) {
            this.setState({ dimensions: contentRect });
        };
        StackedRowHomebrew.propTypes = {
            loadingScreen: PropTypes.element
        };
        return StackedRowHomebrew;
    }(React.Component));

    var closeSvg = 'data:image/svg+xml;base64,dmFyIGltZyA9IG5ldyBJbWFnZSgpOyBpbWcuc3JjID0gJ2RhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1URWlJR2hsYVdkb2REMGlNVEVpSUhacFpYZENiM2c5SWpBZ01DQXhNU0F4TVNJZ1ptbHNiRDBpYm05dVpTSWdlRzFzYm5NOUltaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6SXdNREF2YzNabklqNEtQSEJoZEdnZ1pEMGlUVEV4SURFdU1UQTNPRFpNT1M0NE9USXhOQ0F3VERVdU5TQTBMak01TWpFMFRERXVNVEEzT0RZZ01Fd3dJREV1TVRBM09EWk1OQzR6T1RJeE5DQTFMalZNTUNBNUxqZzVNakUwVERFdU1UQTNPRFlnTVRGTU5TNDFJRFl1TmpBM09EWk1PUzQ0T1RJeE5DQXhNVXd4TVNBNUxqZzVNakUwVERZdU5qQTNPRFlnTlM0MVRERXhJREV1TVRBM09EWmFJaUJtYVd4c1BTSWpORVUxTkRreElpOCtDand2YzNablBnbz0nOyBleHBvcnQgZGVmYXVsdCBpbWc7';

    var MIN_SPACE_FACET_MENU = 700;
    // Add all icons to the library so you can use it in your page
    library.add(faColumns);
    library.add(faSort);
    library.add(faSortAmountUp);
    library.add(faSortAmountDown);
    library.add(faCheck);
    library.add(faTimes);
    library.add(faFilter);
    library.add(faDatabase);
    // Hold constants for next and previous button actions
    var NEXT = 'NEXT';
    var PREVIOUS = 'PREVIOUS';
    var SELECT_ALL$1 = 'SELECT_ALL';
    var DESELECT_ALL$1 = 'DESELECT_ALL';
    // double check these icons!
    var ICON_STATE = ['sort-amount-down', 'sort-amount-down', 'sort-amount-up'];
    var SORT_STATE = ['', 'ASC', 'DESC'];
    var SynapseTable = /** @class */ (function (_super) {
        __extends(SynapseTable, _super);
        function SynapseTable(props) {
            var _this = _super.call(this, props) || this;
            /**
             * Handle a click on next or previous
             *
             * @memberof SynapseTable
             */
            _this.handlePaginationClick = function (eventType) { return function (event) {
                var queryRequest = _this.props.getLastQueryRequest();
                var currentOffset = queryRequest.query.offset;
                // if its a "previous" click subtract from the offset
                // otherwise its next and we paginate forward
                if (eventType === PREVIOUS) {
                    currentOffset -= 25;
                }
                if (eventType === NEXT) {
                    currentOffset += 25;
                }
                queryRequest.query.offset = currentOffset;
                _this.props.executeQueryRequest(queryRequest);
            }; };
            /**
             * Handle a column having been selected
             *
             * @memberof SynapseTable
             */
            _this.handleColumnClick = function (dict) { return function (event) {
                // by using Synthetic event we can use the handler on both key press and mouse click
                var columnIconState = cloneDeep$1(_this.state.columnIconState);
                if (columnIconState.length === 0) {
                    columnIconState = Array(_this.getLengthOfPropsData()).fill(0);
                }
                // get currently sorted items and remove/insert this selection
                var sortSelection = cloneDeep$1(_this.state.sortSelection);
                var index$$1 = _this.findSelectionIndex(sortSelection, dict.name);
                if (index$$1 !== -1) {
                    sortSelection.splice(index$$1, 1);
                }
                columnIconState[dict.index] = (columnIconState[dict.index] + 1) % ICON_STATE.length;
                if (columnIconState[dict.index] > 0) {
                    sortSelection.unshift({
                        column: dict.name,
                        direction: SORT_STATE[columnIconState[dict.index]]
                    });
                }
                var queryRequest = _this.props.getLastQueryRequest();
                queryRequest.query.sort = sortSelection;
                _this.props.executeQueryRequest(queryRequest);
                _this.setState({
                    columnIconState: columnIconState,
                    sortSelection: sortSelection
                });
            }; };
            /**
             * Handles the toggle of a column select, this will cause the table to
             * either show the column or hide depending on the prior state of the column
             *
             * @memberof SynapseTable
             */
            _this.toggleColumnSelection = function (index$$1) { return function (event) {
                event.preventDefault();
                // lazily update the component with this information
                // this only runs once
                var isColumnSelected;
                if (_this.state.isColumnSelected.length === 0) {
                    // unpack all the data
                    var lengthOfPropsData = _this.getLengthOfPropsData();
                    var defaultSelection 
                    // fill visibleColumnCount with true and the rest as false
                    = void 0;
                    // fill visibleColumnCount with true and the rest as false
                    if (_this.props.visibleColumnCount === 0) {
                        // if set to zero then its all true
                        defaultSelection = Array(lengthOfPropsData).fill(true);
                    }
                    else {
                        defaultSelection = Array(_this.props.visibleColumnCount).fill(true);
                        defaultSelection.push.apply(defaultSelection, Array(lengthOfPropsData - _this.props.visibleColumnCount).fill(false));
                    }
                    isColumnSelected = defaultSelection;
                }
                else {
                    isColumnSelected = cloneDeep$1(_this.state.isColumnSelected);
                }
                isColumnSelected[index$$1] = !isColumnSelected[index$$1];
                _this.setState({ isColumnSelected: isColumnSelected });
            }; };
            _this.handleColumnClick = _this.handleColumnClick.bind(_this);
            _this.handlePaginationClick = _this.handlePaginationClick.bind(_this);
            _this.findSelectionIndex = _this.findSelectionIndex.bind(_this);
            _this.toggleColumnSelection = _this.toggleColumnSelection.bind(_this);
            _this.toggleDropdown = _this.toggleDropdown.bind(_this);
            _this.advancedSearch = _this.advancedSearch.bind(_this);
            _this.download = _this.download.bind(_this);
            _this.getLengthOfPropsData = _this.getLengthOfPropsData.bind(_this);
            _this.configureFacetDropdown = _this.configureFacetDropdown.bind(_this);
            _this.closeMenuClickHandler = _this.closeMenuClickHandler.bind(_this);
            _this.showPaginationButtons = _this.showPaginationButtons.bind(_this);
            // store the offset and sorted selection that is currently held
            _this.state = {
                applyClickedArray: Array(100).fill(false),
                columnIconState: [],
                filterClassList: Array(100).fill(''),
                isColumnSelected: [],
                isFilterSelected: Array(100).fill(false),
                isOpen: false,
                menuWallIsActive: false,
                offset: 0,
                sortSelection: []
            };
            _this.renderFacetSelection = _this.renderFacetSelection.bind(_this);
            return _this;
        }
        /**
         * Display the view
         */
        SynapseTable.prototype.render = function () {
            if (this.props.data === undefined) {
                return (React.createElement("div", null));
            }
            // unpack all the data
            var _a = this.props, data = _a.data, filter = _a.filter, isLoading = _a.isLoading, unitDescription = _a.unitDescription;
            var queryResult = data.queryResult;
            var queryResults = queryResult.queryResults;
            var rows = queryResults.rows;
            var headers = queryResults.headers;
            var facets = data.facets;
            var colorPalette = getColorPallette(this.props.rgbIndex, 1).colorPalette;
            var backgroundColor = colorPalette[0];
            // handle displaying the previous button -- if offset is zero then it
            // shouldn't be displayed
            var pastZero = this.props.getLastQueryRequest().query.offset > 0;
            var xData = [];
            data.facets.forEach(function (item) {
                if (item.facetType === 'enumeration' && item.columnName === filter) {
                    item.facetValues.forEach(function (facetValue) {
                        if (item.columnName) {
                            xData.push(__assign({ columnName: item.columnName }, facetValue));
                        }
                    });
                }
            });
            // edge case -- if they are all false then they are considered all true..
            // sum up the counts of data
            var anyTrue = false;
            var totalAllFalseCase = 0;
            var totalStandardCase = 0;
            for (var key in xData) {
                if (xData.hasOwnProperty(key)) {
                    anyTrue = anyTrue || xData[key].isSelected;
                    totalAllFalseCase += xData[key].count;
                    totalStandardCase += xData[key].isSelected ? xData[key].count : 0;
                }
            }
            var total = anyTrue ? totalStandardCase : totalAllFalseCase;
            if (rows.length === 0) {
                total = 0;
            }
            var tooltipIdOne = uuidv4();
            var tooltipIdTwo = uuidv4();
            var _b = this.state, menuWallIsActive = _b.menuWallIsActive, isOpen = _b.isOpen;
            var optionalHiddenClass = !menuWallIsActive ? 'hidden' : '';
            var addRemoveColClasses = 'SRC-extraPadding SRC-primary-background-color-hover dropdown-toggle SRC-hand-cursor';
            addRemoveColClasses += (isOpen ? 'SRC-primary-background-color' : '');
            return (React.createElement(React.Fragment, null,
                React.createElement("button", { onClick: this.closeMenuClickHandler, className: "SRC-menu-wall " + optionalHiddenClass }),
                React.createElement("div", { className: "container-fluid" },
                    React.createElement("div", { className: "row SRC-marginBottomTen" },
                        React.createElement("span", null,
                            !isLoading && React.createElement("strong", null,
                                " Showing ",
                                total,
                                " ",
                                unitDescription,
                                " "),
                            React.createElement("span", { className: isLoading ? 'spinner' : '', style: isLoading ? {} : { display: 'none' } }),
                            isLoading && React.createElement("strong", null, " \u00A0\u00A0 Table results updating... ")))),
                React.createElement("div", { className: "container-fluid" },
                    React.createElement("div", { className: "SRC-padding SRC-centerContent", style: { background: backgroundColor } },
                        React.createElement("h3", { className: "SRC-tableHeader" },
                            " ",
                            this.props.title),
                        React.createElement("span", { style: { marginLeft: 'auto', marginRight: '10px' } },
                            React.createElement("span", { className: " dropdown " + (this.state.isOpen ? 'open' : '') },
                                React.createElement("span", { tabIndex: 0, "data-for": tooltipIdOne, "data-tip": "Open Advanced Search in Synapse", className: "SRC-primary-background-color-hover SRC-extraPadding SRC-hand-cursor", onKeyPress: this.advancedSearch, onClick: this.advancedSearch },
                                    React.createElement(FontAwesomeIcon, { size: "1x", color: "white", icon: "database" })),
                                React.createElement(ReactTooltip, { delayShow: 1500, place: "bottom", type: "dark", effect: "solid", id: tooltipIdOne }),
                                React.createElement("span", { tabIndex: 0, "data-for": tooltipIdTwo, "data-tip": "Add / Remove Columns", style: { marginLeft: '10px' }, className: addRemoveColClasses, onKeyPress: this.toggleDropdown, onClick: this.toggleDropdown, id: "dropdownMenu1" },
                                    React.createElement(FontAwesomeIcon, { color: "white", icon: "columns" })),
                                React.createElement(ReactTooltip, { delayShow: 1500, place: "bottom", type: "dark", effect: "solid", id: tooltipIdTwo }),
                                React.createElement("ul", { className: "dropdown-menu dropdown-menu-right", "aria-labelledby": "dropdownMenu1" }, this.renderDropdownColumnMenu(headers)))))),
                React.createElement("div", { className: "container-fluid" },
                    React.createElement("div", { className: "row SRC-overflowAuto" },
                        React.createElement("table", { className: "table table-striped table-condensed" },
                            React.createElement("thead", { className: "SRC_borderTop" },
                                React.createElement("tr", null, this.createTableHeader(headers, facets))),
                            React.createElement("tbody", null,
                                " ",
                                this.createTableRows(rows, headers))),
                        total > 0 && this.showPaginationButtons(pastZero)))));
        };
        SynapseTable.prototype.showPaginationButtons = function (pastZero) {
            var previous = (React.createElement("button", { onClick: this.handlePaginationClick(PREVIOUS), className: "SRC-primary-background-color-hover SRC-viewMoreButton pull-right", type: "button" }, "Previous"));
            var next = ((React.createElement("button", { onClick: this.handlePaginationClick(NEXT), className: "SRC-primary-background-color-hover SRC-viewMoreButton pull-right", type: "button" }, "Next")));
            return (React.createElement(React.Fragment, null,
                next,
                pastZero && previous));
        };
        SynapseTable.prototype.renderDropdownColumnMenu = function (headers) {
            var _this = this;
            return headers.map(function (header, index$$1) {
                var isColumnSelected = _this.state.isColumnSelected[index$$1];
                var _a = _this.props.visibleColumnCount, visibleColumnCount = _a === void 0 ? 0 : _a;
                if (isColumnSelected === undefined) {
                    isColumnSelected = (index$$1 < visibleColumnCount) || (visibleColumnCount === 0);
                }
                var iconStyle = { width: '11px', marginRight: '10px' };
                if (!isColumnSelected) {
                    iconStyle.visibility = 'hidden';
                }
                var maybeShowPrimaryColor = isColumnSelected ? 'SRC-primary-text-color' : '';
                return (React.createElement("li", { style: { listStyle: 'none' }, className: "SRC-primary-background-color-hover SRC-nested-color", key: header.name, onClick: _this.toggleColumnSelection(index$$1) },
                    React.createElement("a", { className: "SRC-no-focus", href: "" },
                        React.createElement(FontAwesomeIcon, { style: iconStyle, className: maybeShowPrimaryColor, icon: "check" }),
                        header.name)));
            });
        };
        SynapseTable.prototype.createTableRows = function (rows, headers) {
            var _this = this;
            var rowsFormatted = [];
            var isColumnSelected = this.state.isColumnSelected;
            var isColumnSelectedLen = isColumnSelected.length;
            rows.forEach(function (expRow, i) {
                var rowContent = expRow.values.map(function (value, j) {
                    var columnName = headers[j].name;
                    var index$$1 = _this.findSelectionIndex(_this.state.sortSelection, columnName);
                    var _a = _this.props.visibleColumnCount, visibleColumnCount = _a === void 0 ? 0 : _a;
                    // we have to check if this column is selected under initial load
                    // there are two cases:
                    // 1. If the user has just clicked on the screen, we should show the column if its within
                    // the limit of the rows specified
                    // 2. If the visibleColumnCount is not specified or set to zero AND there have not been
                    // any selections made then we don't show it
                    var isRowActiveInit = j < visibleColumnCount && isColumnSelectedLen === 0;
                    isRowActiveInit = isRowActiveInit || (visibleColumnCount === 0 && isColumnSelectedLen === 0);
                    // this is checking if the column is selected post load and interactions have taken place
                    var isRowActiveSubsequent = isColumnSelectedLen !== 0 && _this.state.isColumnSelected[j];
                    if (isRowActiveInit || isRowActiveSubsequent) {
                        return (React.createElement("td", { className: "SRC_noBorderTop", key: "(" + i + "," + j + ")" },
                            React.createElement("p", { className: "" + (index$$1 === -1 ? '' : 'SRC-boldText') },
                                " ",
                                value,
                                " ")));
                    }
                    return (React.createElement("td", { key: "(" + i + "," + j + ")" }));
                });
                var rowFormatted = (React.createElement("tr", { key: expRow.rowId }, rowContent));
                rowsFormatted.push(rowFormatted);
            });
            return rowsFormatted;
        };
        SynapseTable.prototype.createTableHeader = function (headers, facets) {
            var _this = this;
            var _a = this.state, isColumnSelected = _a.isColumnSelected, sortSelection = _a.sortSelection, columnIconState = _a.columnIconState;
            var _b = this.props.visibleColumnCount, visibleColumnCount = _b === void 0 ? 0 : _b;
            return headers.map(function (column, index$$1) {
                // two cases when rendering the column headers on init load
                // of the page we have to show only this.props.visibleColumnCount many
                // columns, afterwards we rely on the isColumnSelected to get choices
                var initRender = index$$1 < visibleColumnCount && isColumnSelected.length === 0;
                initRender = initRender || (visibleColumnCount === 0 && isColumnSelected.length === 0);
                var subsequentRender = isColumnSelected[index$$1] && isColumnSelected.length !== 0;
                if (initRender || subsequentRender) {
                    // for background color
                    var isSelected = _this.findSelectionIndex(sortSelection, column.name) !== -1;
                    // for icon state
                    var columnIndex = columnIconState[index$$1] === undefined ? 0 : _this.state.columnIconState[index$$1];
                    // we have to figure out if the current column is a facet selection
                    var facetIndex = facets.findIndex(function (value) {
                        return value.columnName === column.name;
                    });
                    var isFacetSelection = facetIndex !== -1;
                    var isSelectedSpanClass = (isSelected ? 'SRC-primary-background-color SRC-anchor-light' : '');
                    var isSelectedIconClass = isSelected ? 'SRC-selected-table-icon' : 'SRC-primary-text-color';
                    var sortSpanBackgoundClass = "SRC-tableHead SRC-hand-cursor SRC-sortPadding SRC-primary-background-color-hover " + isSelectedSpanClass;
                    return (React.createElement("th", { key: column.name },
                        React.createElement("div", { className: "SRC-centerContent" },
                            column.name,
                            isFacetSelection && _this.configureFacetDropdown(index$$1, facets, facetIndex),
                            React.createElement("span", { tabIndex: 0, className: sortSpanBackgoundClass, onKeyPress: _this.handleColumnClick({ index: index$$1, name: column.name }), onClick: _this.handleColumnClick({ index: index$$1, name: column.name }) },
                                React.createElement(FontAwesomeIcon, { className: "SRC-primary-background-color-hover  " + isSelectedIconClass, icon: ICON_STATE[columnIndex] })))));
                }
                return (React.createElement("th", { key: column.name }));
            });
        };
        /**
         * Utility to search through array of objects and find object with key "column"
         * equal to input parameter "name"
         *
         * @param {*} sortSelection
         * @param {*} name
         * @returns -1 if not present, otherwise the index of the object
         * @memberof SynapseTable
         */
        SynapseTable.prototype.findSelectionIndex = function (sortSelection, name) {
            if (sortSelection.length !== 0) {
                // find if the current selection exists already and remove it
                return sortSelection.findIndex(function (el) { return el.column === name; });
            }
            return -1;
        };
        // TODO: implement this method
        SynapseTable.prototype.download = function () {
            return;
        };
        // Direct user to synapse corresponding synapse table
        SynapseTable.prototype.advancedSearch = function (event) {
            event.preventDefault();
            var lastQueryRequest = this.props.getLastQueryRequest();
            var query = lastQueryRequest.query;
            // base 64 encode the json of the query and go to url with the encoded object
            var encodedQuery = btoa(JSON.stringify(query));
            var synTable = this.props.synapseId;
            window.open("https://www.synapse.org/#!Synapse:" + synTable + "/tables/query/" + encodedQuery, '_blank');
        };
        /**
         * Handles the opening and closing of the column select menu, this method
         * is only necessary because react overrides the behavior that bootstrap
         * embeds in its menus
         *
         * @memberof SynapseTable
         */
        SynapseTable.prototype.toggleDropdown = function () {
            var isOpen = this.state.isOpen;
            var isFilterSelected = this.state.isFilterSelected;
            if (!isOpen) {
                for (var i = 0; i < isFilterSelected.length; i += 1) {
                    isFilterSelected[i] = false;
                }
            }
            if (!isOpen) {
                // the dropdown was closed coming into this method, so now it will be opened
                // so we activate the menu wall.
                this.setState({ menuWallIsActive: true });
            }
            else {
                // dropdown was open coming into this method, so we activate the menu wall
                // to allow the dropdown to be closed
                this.setState({ menuWallIsActive: false });
            }
            this.setState({ isFilterSelected: isFilterSelected, isOpen: !isOpen });
        };
        SynapseTable.prototype.getLengthOfPropsData = function () {
            var data = this.props.data;
            return data.queryResult.queryResults.headers.length;
        };
        /**
         *
         *
         * @param {number} index this is column index of the query table data
         * @param {string} columnName this is the name of the column
         * @param {FacetColumnResult[]} facetColumnResults
         * @param {number} facetIndex
         * @returns
         * @memberof SynapseTable
         */
        SynapseTable.prototype.configureFacetDropdown = function (index$$1, facetColumnResults, facetIndex) {
            var _this = this;
            // this grabs the specific facet selection
            var facetColumnResult = facetColumnResults[facetIndex];
            var columnName = facetColumnResult.columnName;
            // this is related to whether we've selected this column or not
            var isCurFilterSelected = this.state.isFilterSelected[index$$1];
            var toggleDropdown = function (event) {
                //  make param any for code re-use
                var isFilterSelected = cloneDeep$1(_this.state.isFilterSelected);
                var filterClassList = cloneDeep$1(_this.state.filterClassList);
                isFilterSelected[index$$1] = !isCurFilterSelected;
                // close all the other filters
                for (var i = 0; i < isFilterSelected.length; i += 1) {
                    if (i !== index$$1) {
                        isFilterSelected[i] = false;
                    }
                }
                // The dropdown is located inside of a scrollable, to know whether the current filter menu item is near the
                // front of the scrollable we can examine its parent bounding rect -- this gives a relative value
                // (that changes on scroll) of the filter to a fixed left most point.
                var tHeadLeftPosition = refOuterDiv.current.parentElement.getBoundingClientRect().left;
                var classNames = ''; //  the classes to be applied to the filter dropdown menu
                if (isFilterSelected[index$$1]) {
                    classNames = tHeadLeftPosition < MIN_SPACE_FACET_MENU ?
                        'SRC-forceLeftDropdown dropdown-menu-left' : 'dropdown-menu-right';
                }
                else {
                    classNames = '';
                }
                // set the class names for this dropdown item
                filterClassList[index$$1] = classNames;
                _this.setState({
                    filterClassList: filterClassList,
                    isFilterSelected: isFilterSelected,
                    isOpen: false,
                    menuWallIsActive: !isCurFilterSelected
                });
            };
            var ref = React.createRef();
            var refOuterDiv = React.createRef();
            // handle column selection
            var handleSelector = function (selector) { return function (event) {
                // There is conflicting information about tslint suggestion to use for..of
                // We ignore the suggestion
                // tslint:disable-next-line
                for (var i = 0; i < ref.current.children.length; i++) {
                    var curElement = ref.current.children[i];
                    var label = curElement.children[0];
                    var checkbox = label.children[1];
                    checkbox.checked = selector === SELECT_ALL$1;
                }
            }; };
            var applyChanges = function (_) {
                var facetValues = [];
                // tslint:disable-next-line
                for (var i = 0; i < ref.current.children.length; i++) {
                    var curElement = ref.current.children[i];
                    var label = curElement.children[0];
                    var checkbox = label.children[1];
                    var isSelected = checkbox.checked;
                    if (isSelected) {
                        facetValues.push(checkbox.value);
                    }
                }
                var queryRequest = cloneDeep$1(_this.props.getLastQueryRequest());
                var selectedFacets = queryRequest.query.selectedFacets;
                // the facet index of the result and the request are the same
                var currentFacetRequest = {
                    columnName: columnName,
                    facetValues: facetValues,
                    concreteType: 'org.sagebionetworks.repo.model.table.FacetColumnValuesRequest'
                };
                var indexOfFacetInRequest = selectedFacets.findIndex(function (el) { return el.columnName === columnName; });
                if (indexOfFacetInRequest === -1) {
                    queryRequest.query.selectedFacets.push(currentFacetRequest);
                }
                else {
                    queryRequest.query.selectedFacets[indexOfFacetInRequest] = currentFacetRequest;
                }
                _this.props.executeQueryRequest(queryRequest);
                toggleDropdown();
                var applyClickedArray = cloneDeep$1(_this.state.applyClickedArray);
                applyClickedArray[index$$1] = true;
                _this.setState({
                    applyClickedArray: applyClickedArray,
                    menuWallIsActive: false
                });
            };
            var applyPrimary = isCurFilterSelected ? 'SRC-primary-background-color' : 'SRC-primary-text-color';
            var numFacets = facetColumnResult.facetValues.length;
            var classList = this.state.filterClassList[index$$1];
            var style = { alignItems: 'center', marginLeft: '15px', marginRight: '5px', color: 'black', display: 'flex' };
            return (React.createElement("div", { ref: refOuterDiv, style: style, className: "btn-group SRC-tableHead " + (isCurFilterSelected ? 'open SRC-anchor-light' : '') },
                React.createElement("span", { tabIndex: 0, className: "SRC-padding SRC-hand-cursor SRC-primary-background-color-hover " + applyPrimary, onKeyPress: toggleDropdown, onClick: toggleDropdown },
                    React.createElement(FontAwesomeIcon, { style: { margin: 'auto' }, size: '1x', className: applyPrimary, color: isCurFilterSelected ? 'white' : '', icon: "filter" })),
                React.createElement("div", { className: "dropdown-menu SRC-minDropdownWidth " + classList },
                    React.createElement("div", { className: "paddingMenuDropdown" },
                        React.createElement("ul", { style: { listStyleType: 'none' }, className: "scrollable" },
                            React.createElement("li", null,
                                React.createElement("div", { className: "SRC-flex SRC-table-dropdown-content" },
                                    React.createElement("p", { className: "SRC-table-dropdown-text" },
                                        columnName,
                                        " (",
                                        numFacets,
                                        ")"),
                                    React.createElement("button", { className: "SRC-table-dropdown-close btn pull-right", onClick: toggleDropdown },
                                        React.createElement("img", { src: closeSvg })))),
                            React.createElement("br", null),
                            React.createElement("span", { ref: ref }, this.renderFacetSelection(facetColumnResult)))),
                    React.createElement("div", { className: "borderTopTable SRC-flex" },
                        React.createElement("span", { className: "tableTextColor" },
                            React.createElement("button", { onClick: handleSelector(SELECT_ALL$1), className: "tableDropdownSelector tableAll" }, "All"),
                            React.createElement("span", null, " | "),
                            React.createElement("button", { onClick: handleSelector(DESELECT_ALL$1), className: "tableDropdownSelector tableClear" }, "Clear")),
                        React.createElement("button", { onClick: applyChanges, className: "tableApply" }, " APPLY ")))));
        };
        SynapseTable.prototype.closeMenuClickHandler = function (_) {
            var menuWallIsActive = this.state.menuWallIsActive;
            var isFilterSelected = cloneDeep$1(this.state.isFilterSelected);
            var filterClassList = cloneDeep$1(this.state.filterClassList);
            if (menuWallIsActive) {
                // need to close the menus and column select menu
                for (var i = 0; i < isFilterSelected.length; i += 1) {
                    isFilterSelected[i] = false;
                    filterClassList[i] = '';
                }
                this.setState({
                    filterClassList: filterClassList,
                    isFilterSelected: isFilterSelected,
                    isOpen: false,
                    menuWallIsActive: false
                });
            }
        };
        SynapseTable.prototype.renderFacetSelection = function (facetColumnResult) {
            return facetColumnResult.facetValues.map(function (dataPoint) {
                var idText = dataPoint.value + "(" + dataPoint.count + ")";
                var displayValue = dataPoint.value;
                if (displayValue === 'org.sagebionetworks.UNDEFINED_NULL_NOTSET') {
                    displayValue = 'unannotated';
                }
                return (React.createElement(React.Fragment, { key: idText },
                    React.createElement("li", null,
                        React.createElement("label", { className: "dropdownList SRC-base-font containerCheckbox" },
                            displayValue,
                            React.createElement("span", { style: { color: '#DDDDDF' } },
                                " \u00A0\u00A0(",
                                dataPoint.count,
                                ") "),
                            React.createElement("input", { defaultChecked: true, type: "checkbox", value: dataPoint.value }),
                            React.createElement("span", { className: "checkmark" })))));
            });
        };
        SynapseTable.propTypes = {
            synapseId: PropTypes.string,
            title: PropTypes.string,
            visibleColumnCount: PropTypes.number
        };
        return SynapseTable;
    }(React.Component));

    var sufixes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];
    function calculateFriendlyFileSize(bytes) {
        if (!bytes) {
            return '';
        }
        // https://stackoverflow.com/questions/10420352/converting-file-size-in-bytes-to-human-readable-string
        var i = Math.floor(Math.log(bytes) / Math.log(1024));
        // tslint:disable-next-line
        return (!bytes && '0 Bytes') || (bytes / Math.pow(1024, i)).toFixed(2) + ' ' + sufixes[i];
    }

    var CardFooter = function (_a) {
        var values = _a.values, _b = _a.extraWide, extraWide = _b === void 0 ? false : _b;
        var valuesFormatted = values.map(function (kv) {
            if (kv[0].toUpperCase() === 'DOI') {
                return (React.createElement("div", { key: uuidv4(), className: "row" },
                    React.createElement("div", { className: "SRC-row-label" },
                        " ",
                        kv[0],
                        " "),
                    React.createElement("div", { className: "SRC-row-data" },
                        ' ',
                        React.createElement("a", { target: "_blank", href: "https://dx.doi.org/" + kv[1] }, kv[1]))));
            }
            if (kv[0].toUpperCase() === 'PUBLICATION') {
                return (React.createElement("div", { key: uuidv4() }));
            }
            return (React.createElement("div", { key: uuidv4(), className: "row " + (extraWide ? 'extraWide' : '') },
                React.createElement("div", { className: "SRC-verticalAlignTop SRC-row-label" },
                    " ",
                    kv[0],
                    " "),
                React.createElement("div", { className: "SRC-row-data SRC-limitMaxWidth" },
                    " ",
                    kv[1],
                    " ")));
        });
        return (React.createElement("div", { className: "SRC-cardMetadata" }, valuesFormatted));
    };

    var ChipContainer = function (_a) {
        var chips = _a.chips;
        var chipsFormatted = chips.map(function (el) {
            if (!el) {
                return false;
            }
            return React.createElement("span", { key: uuidv4() },
                " ",
                el);
        });
        return (React.createElement(React.Fragment, null, chipsFormatted));
    };

    var Icon = function (_a) {
        var type = _a.type;
        switch (type) {
            case PUBLICATION:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/Publication.svg') });
            case DATASET:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/Data2.svg') });
            case FUNDER:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/Data2.svg') });
            case STUDY_ACTIVE:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/study-active.svg') });
            case STUDY_COMPLETE:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/study-complete.svg') });
            case TOOL:
                return React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/DNA_Two.svg') });
            default:
                return null;
        }
    };

    var CHAR_COUNT_CUTOFF = 400;
    var ShowMore = /** @class */ (function (_super) {
        __extends(ShowMore, _super);
        function ShowMore(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                showMore: false
            };
            _this.toggleShowMore = _this.toggleShowMore.bind(_this);
            return _this;
        }
        ShowMore.prototype.toggleShowMore = function (event) {
            event.preventDefault();
            var showMore = this.state.showMore;
            showMore = !showMore;
            this.props.onClick({
                showMore: showMore
            });
            this.setState({
                showMore: showMore
            });
        };
        ShowMore.prototype.render = function () {
            // CHAR_COUNT_CUTOFF if show more is false and if its reasonably long enough
            var summary = this.props.summary;
            var summaryView = '';
            var meetsCharRequirenent = summary && summary.length >= CHAR_COUNT_CUTOFF;
            if (!this.state.showMore && meetsCharRequirenent) {
                var summarySplit = summary.split(' ');
                // find num words to join such that its >= char_count_cutoff
                var i = 0;
                while (summaryView.length < CHAR_COUNT_CUTOFF) {
                    summaryView += summarySplit[i] + " ";
                    i += 1;
                }
            }
            else if (!meetsCharRequirenent) {
                summaryView = summary;
            }
            var showMoreButton = (meetsCharRequirenent &&
                (React.createElement("a", { style: { fontSize: '14px', cursor: 'pointer' }, className: "SRC-primary-text-color", onClick: this.toggleShowMore },
                    "...Show More",
                    ' ')));
            return (React.createElement(React.Fragment, null,
                !this.state.showMore && summaryView,
                this.state.showMore && summary,
                !this.state.showMore && showMoreButton));
        };
        return ShowMore;
    }(React.Component));

    var Dataset = /** @class */ (function (_super) {
        __extends(Dataset, _super);
        function Dataset(props) {
            var _this = _super.call(this, props) || this;
            _this.handleLinkClick = function (link) { return function (event) {
                event.preventDefault();
                window.open("https://www.synapse.org/#!Synapse:" + link, '_blank');
            }; };
            _this.handleLinkClick = _this.handleLinkClick.bind(_this);
            return _this;
        }
        Dataset.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var datasetName = data[schema.datasetName];
            var summary = data[schema.summary];
            var tumorType = data[schema.tumorType];
            var diseaseFocus = data[schema.diseaseFocus];
            var id = data[schema.id];
            var fundingAgency = data[schema.fundingAgency];
            var fileCount = data[schema.fileCount];
            var fileSize = calculateFriendlyFileSize(data[schema.fileSize]);
            var values = [['FUNDER', fundingAgency], ['SIZE', fileSize], ['FILES', fileCount]];
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeDataset SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" },
                    React.createElement(Icon, { type: DATASET }),
                    React.createElement("div", null, fileSize)),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Dataset "),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            React.createElement("a", { target: "_blank", href: "https://www.synapse.org/#!Synapse:" + id }, datasetName))),
                    React.createElement("div", { className: "SRC-cardAction SRC-floatRight" },
                        React.createElement("button", { onClick: this.handleLinkClick(id), type: "button" }, "Download Dataset")),
                    React.createElement("div", { className: "SRC-description" },
                        " ",
                        summary,
                        " "),
                    React.createElement("div", { className: "SRC-cardAnnotations" },
                        React.createElement(ChipContainer, { chips: [tumorType, diseaseFocus] }))),
                React.createElement(CardFooter, { values: values })));
        };
        return Dataset;
    }(React.Component));

    var logoLinks = {
        CTF: require('../../assets/logos/ctf.svg'),
        'DHART SPORE': require('../../assets/logos/dhart.svg'),
        NTAP: require('../../assets/logos/ntap.svg')
    };
    var Funder = /** @class */ (function (_super) {
        __extends(Funder, _super);
        function Funder(props) {
            var _this = _super.call(this, props) || this;
            _this.handleLinkClick = function (link) { return function (event) {
                event.preventDefault();
                window.open(link, '_blank');
            }; };
            _this.handleLinkClick = _this.handleLinkClick.bind(_this);
            return _this;
        }
        Funder.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var organizationName = data[schema.organizationName];
            var organizationPath = data[schema.organizationPath];
            var summary = data[schema.summary];
            var website = data[schema.website];
            var abbreviation = data[schema.abbreviation];
            var logo = logoLinks[abbreviation];
            var orgPath = window.location.origin + "/#" + organizationPath;
            // remove leading http(s):// and trailing /
            var websiteDisplayName = website.replace('https://', '');
            websiteDisplayName = websiteDisplayName.replace('http://', '');
            if (websiteDisplayName.charAt(websiteDisplayName.length - 1) === '/') {
                websiteDisplayName = websiteDisplayName.substring(0, websiteDisplayName.length - 1);
            }
            var isOnOrgPath = window.location.hash.substring(1) === organizationPath;
            var style = {};
            var showOrgLink;
            if (!isOnOrgPath) {
                style.paddingBottom = '42px';
                showOrgLink = (React.createElement("div", { className: "SRC-marginAuto SRC-cardAction" },
                    React.createElement("button", { onClick: this.handleLinkClick(orgPath), type: "button" }, "View Funded Research")));
            }
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeFunder SRC-layoutLandscape", style: style },
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Organization"),
                    React.createElement("div", { className: "SRC-cardThumbnail" },
                        React.createElement("img", { alt: "funder logo", className: "SRC-logo", src: logo })),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            isOnOrgPath && organizationName,
                            !isOnOrgPath && React.createElement("a", { href: orgPath }, organizationName))),
                    React.createElement("div", { className: "SRC-website" },
                        React.createElement("a", { target: "_blank", href: website }, websiteDisplayName)),
                    React.createElement("div", { className: "SRC-description" }, summary)),
                showOrgLink));
        };
        return Funder;
    }(React.Component));

    var Publication = /** @class */ (function (_super) {
        __extends(Publication, _super);
        function Publication(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                showMore: false
            };
            return _this;
        }
        Publication.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var citation = data[schema.citation];
            var tumorType = data[schema.tumorType];
            var diseaseFocus = data[schema.diseaseFocus];
            var doi = data[schema.doi];
            var fundingAgency = data[schema.fundingAgency];
            var projectName = data[schema.projectName];
            var values = [['DOI', doi], ['FUNDER', fundingAgency], ['STUDY', projectName]];
            return (React.createElement("div", { className: "SRC-portalCard SRC-typePublication SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" },
                    React.createElement(Icon, { type: PUBLICATION })),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Publication"),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            React.createElement("a", { target: "_blank", href: "https://dx.doi.org/" + doi }, citation))),
                    React.createElement("div", { className: "SRC-cardAnnotations" },
                        React.createElement(ChipContainer, { chips: [tumorType, diseaseFocus] }))),
                React.createElement(CardFooter, { values: values })));
        };
        return Publication;
    }(React.Component));

    var Study = /** @class */ (function (_super) {
        __extends(Study, _super);
        function Study(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                hasCreatedIndex: false,
                showMore: false
            };
            _this.handleClick = _this.handleClick.bind(_this);
            return _this;
        }
        Study.prototype.handleClick = function (event) {
            this.setState({
                showMore: !this.state.showMore
            });
        };
        Study.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var projectName = data[schema.projectName];
            var projectLeads = data[schema.projectLeads] && data[schema.projectLeads].split(';').join(' / ');
            var summary = data[schema.summary];
            var diseaseFocus = data[schema.diseaseFocus];
            var tumorType = data[schema.tumorType];
            var projectStatus = data[schema.projectStatus];
            var fundingAgency = data[schema.fundingAgency];
            var dataStatus = data[schema.dataStatus];
            var id = data[schema.id];
            var link = "https://www.synapse.org/#!Synapse:" + id;
            var values = [
                ['STATUS', projectStatus],
                ['FUNDER', fundingAgency],
                ['DATA', dataStatus],
                ['PUBLICATION', 'NONE']
            ];
            var chips = [tumorType, diseaseFocus];
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeStudy SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" },
                    React.createElement(Icon, { type: projectStatus === 'Active' ? STUDY_ACTIVE : STUDY_COMPLETE }),
                    React.createElement("div", null, projectStatus)),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Study"),
                    React.createElement("div", { className: "SRC-title" },
                        ' ',
                        React.createElement("h3", null,
                            ' ',
                            React.createElement("a", { target: "_blank", href: link }, projectName),
                            ' '),
                        ' '),
                    React.createElement("div", { className: "SRC-author" }, projectLeads),
                    React.createElement("span", { className: "SRC-font-size-base" },
                        React.createElement(ShowMore, { onClick: this.handleClick, summary: summary })),
                    React.createElement("div", { className: "SRC-cardAnnotations" },
                        React.createElement(ChipContainer, { chips: chips }))),
                React.createElement(CardFooter, { values: values })));
        };
        return Study;
    }(React.Component));

    var Tool = /** @class */ (function (_super) {
        __extends(Tool, _super);
        function Tool(props) {
            var _this = _super.call(this, props) || this;
            _this.handleLinkClick = function (link) { return function (event) {
                event.preventDefault();
                window.open(link, '_blank');
            }; };
            _this.handleLinkClick = _this.handleLinkClick.bind(_this);
            return _this;
        }
        Tool.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var softwareName = data[schema.softwareName];
            var summary = data[schema.summary];
            var softwareLink = data[schema.softwareLink];
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeTool SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" },
                    React.createElement(Icon, { type: TOOL })),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Tool"),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            React.createElement("a", { href: softwareLink, target: "_blank" }, softwareName))),
                    React.createElement("div", { className: "SRC-description" }, summary)),
                React.createElement("div", { className: "SRC-cardAction" },
                    React.createElement("button", { onClick: this.handleLinkClick(softwareLink), type: "button" }, "Open Tool"))));
        };
        return Tool;
    }(React.Component));

    var Consortium = /** @class */ (function (_super) {
        __extends(Consortium, _super);
        function Consortium(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                hasCreatedIndex: false,
                showMore: false
            };
            _this.handleClick = _this.handleClick.bind(_this);
            _this.getIcon = _this.getIcon.bind(_this);
            return _this;
        }
        Consortium.prototype.handleClick = function (event) {
            this.setState({
                showMore: !this.state.showMore
            });
        };
        Consortium.prototype.getIcon = function (org, isHeader) {
            // This CAN NOT be refactored below -- dynamic imports are currently not supported
            // in es6, so the code below already has static references to the files below
            // even though its baked into if else clauses.
            switch (org) {
                case 'AMP-AD':
                    if (isHeader) {
                        return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/amp-icon-header.svg') });
                    }
                    return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/amp-icon.svg') });
                case 'M2OVE-AD':
                    if (isHeader) {
                        return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/move-icon-header.svg') });
                    }
                    return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/move-icon.svg') });
                case 'MODEL-AD':
                    if (isHeader) {
                        return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/ModelAD-icon-header.svg') });
                    }
                    return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/ModelAD-icon.svg') });
                case 'Resilience-AD':
                    if (isHeader) {
                        // ignore long require, this is inevitable
                        // tslint:disable-next-line
                        return React.createElement("img", { src: require("../../../assets/icons/AMP_AD/consortia-icons/resilience-icon-header.svg") });
                    }
                    return React.createElement("img", { src: require('../../../assets/icons/AMP_AD/consortia-icons/resilience-icon.svg') });
                default:
                    return (false);
            }
        };
        Consortium.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var description = data[schema['Short Description']];
            var name = data[schema['Full Name']];
            var org = data[schema.Program];
            var path = data[schema.Path];
            var orgPath = window.location.origin + "/#" + path;
            var isOnOrgPath = window.location.hash.substring(1) === path;
            return (React.createElement("div", { style: { paddingBottom: '32px' }, className: "SRC-portalCard SRC-typeStudy SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" }, this.getIcon(org, isOnOrgPath)),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Program"),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            !isOnOrgPath && React.createElement("a", { target: "_blank", href: orgPath },
                                " ",
                                name,
                                " "),
                            isOnOrgPath && name)),
                    React.createElement("span", { className: "SRC-font-size-base" }, description))));
        };
        return Consortium;
    }(React.Component));

    var Study$1 = /** @class */ (function (_super) {
        __extends(Study, _super);
        function Study(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                hasCreatedIndex: false,
                showMore: false
            };
            _this.handleClick = _this.handleClick.bind(_this);
            return _this;
        }
        Study.prototype.handleClick = function (event) {
            this.setState({
                showMore: !this.state.showMore
            });
        };
        Study.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var abstract = data[schema.Abstract];
            // const consortium = data[schema.Consortium]
            var grantNumber = data[schema['Grant Number']];
            var institutions = data[schema.Institutions];
            var contributors = data[schema['Key Data Contributors']];
            var program = data[schema.Program];
            var investigators = data[schema['Key Investigators']];
            var link = data[schema.Link];
            var name = data[schema.Name];
            var values = [['PROGRAM', program]];
            if (institutions) {
                values.unshift(['INSTITUTIONS', institutions]);
            }
            if (contributors) {
                values.unshift(['KEY CONTRIBUTORS', contributors]);
            }
            if (grantNumber) {
                values.unshift(['GRANT', grantNumber]);
            }
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeStudy SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" }, Study.icon),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Project"),
                    React.createElement("div", { className: "SRC-title" },
                        React.createElement("h3", null,
                            React.createElement("a", { target: "_blank", href: link }, name))),
                    React.createElement("div", { className: "SRC-author SRC-boldText" }, investigators),
                    React.createElement("span", { className: "SRC-font-size-base" },
                        React.createElement(ShowMore, { onClick: this.handleClick, summary: abstract }))),
                React.createElement(CardFooter, { extraWide: true, values: values })));
        };
        Study.icon = React.createElement("img", { className: "iconImg", alt: "", src: require('../../../assets/icons/project.svg') });
        return Study;
    }(React.Component));

    var Study$2 = /** @class */ (function (_super) {
        __extends(Study, _super);
        function Study(props) {
            var _this = _super.call(this, props) || this;
            _this.state = {
                hasCreatedIndex: false,
                showMore: false
            };
            _this.handleClick = _this.handleClick.bind(_this);
            return _this;
        }
        Study.prototype.handleClick = function (event) {
            this.setState({
                showMore: !this.state.showMore
            });
        };
        Study.prototype.getIcon = function (name) {
            switch (name) {
                case 'Controlled':
                    return (React.createElement("img", { src: require('../../../assets/icons/controlledStudy.svg') }));
                default:
                    return (React.createElement("img", { src: require('../../../assets/icons/study-active.svg') }));
            }
        };
        Study.prototype.render = function () {
            var _a = this.props, data = _a.data, schema = _a.schema;
            var accessType = data[schema.Access_Type];
            var id = data[schema.Study];
            var link = "https://www.synapse.org/#!Synapse:" + id;
            var dataContributors = data[schema.Data_Contributor];
            var studyName = data[schema.Study_Name];
            var studyDescription = data[schema.Study_Description];
            var model = data[schema.Model_System] || '';
            var species = data[schema.Species];
            var individuals = data[schema.Number_of_Individuals];
            var program = data[schema.Consortium];
            var grant = data[schema.Grant];
            var dataTypes = data[schema.DataType_All];
            var values = [
                ['Data Types', dataTypes],
                ['SPECIES', species + " " + model],
                ['INDIVIDUALS', individuals],
                ['PROGRAM', program],
                ['GRANT', grant]
            ];
            return (React.createElement("div", { className: "SRC-portalCard SRC-typeStudy SRC-layoutLandscape SRC-showMetadata" },
                React.createElement("div", { className: "SRC-cardThumbnail" }, this.getIcon(accessType)),
                React.createElement("div", { className: "SRC-cardContent" },
                    React.createElement("div", { className: "SRC-type" }, "Study"),
                    React.createElement("div", { className: "SRC-title" },
                        ' ',
                        React.createElement("h3", null,
                            ' ',
                            React.createElement("a", { target: "_blank", href: link }, studyName),
                            ' '),
                        ' '),
                    React.createElement("div", { className: "SRC-author" }, dataContributors),
                    React.createElement("span", { className: "SRC-font-size-base" },
                        React.createElement(ShowMore, { onClick: this.handleClick, summary: studyDescription }))),
                React.createElement(CardFooter, { values: values })));
        };
        return Study;
    }(React.Component));

    var PAGE_SIZE = 25;
    // Instead of giving each of the Study/Tool/etc components the same
    // props we make a simple container that does
    var RowContainer = function (props) {
        var type = props.type, rest = __rest(props, ["type"]);
        switch (type) {
            case STUDY:
                return React.createElement(Study, __assign({}, rest));
            case DATASET:
                return React.createElement(Dataset, __assign({}, rest));
            case FUNDER:
                return React.createElement(Funder, __assign({}, rest));
            case PUBLICATION:
                return React.createElement(Publication, __assign({}, rest));
            case TOOL:
                return React.createElement(Tool, __assign({}, rest));
            case AMP_PROJECT:
                return React.createElement(Study$1, __assign({}, rest));
            case AMP_CONSORTIUM:
                return React.createElement(Consortium, __assign({}, rest));
            case AMP_STUDY:
                return React.createElement(Study$2, __assign({}, rest));
            default:
                return (React.createElement("div", null)); // this should never happen
        }
    };
    var SynapseTableCardView = /** @class */ (function (_super) {
        __extends(SynapseTableCardView, _super);
        function SynapseTableCardView(props) {
            var _this = _super.call(this, props) || this;
            _this.handleViewMore = _this.handleViewMore.bind(_this);
            _this.getBufferData = _this.getBufferData.bind(_this);
            _this.state = {
                cardLimit: PAGE_SIZE,
                hasLoadedBufferData: false,
                hasMoreData: true
            };
            return _this;
        }
        SynapseTableCardView.prototype.componentDidMount = function () {
            // we try to load one page of data ahead of cards, this allows the "view more" behavior
            // to be instant
            this.getBufferData();
        };
        SynapseTableCardView.prototype.getBufferData = function () {
            var _this = this;
            // Load data ahead of the currently displayed data, do this recursively in case it needs more time
            if (!this.state.hasLoadedBufferData) {
                setTimeout(function () {
                    if (!_this.props.getLastQueryRequest) {
                        // parent component still setting up
                        _this.getBufferData();
                        return;
                    }
                    var queryRequest = _this.props.getLastQueryRequest();
                    if (!queryRequest.query) {
                        // parent component still setting up
                        _this.getBufferData();
                        return;
                    }
                    var offset = queryRequest.query.offset;
                    // if its a "previous" click subtract from the offset
                    // otherwise its next and we paginate forward
                    offset += PAGE_SIZE;
                    queryRequest.query.offset = offset;
                    _this.props.getNextPageOfData(queryRequest).then(function (hasMoreData) {
                        _this.setState({ hasMoreData: hasMoreData, hasLoadedBufferData: true });
                    });
                }, 1500);
            }
        };
        /**
         * Handle a click on next or previous
         *
         * @memberof SynapseTable
         */
        SynapseTableCardView.prototype.handleViewMore = function () {
            var _this = this;
            var queryRequest = this.props.getLastQueryRequest();
            var offset = queryRequest.query.offset;
            // if its a "previous" click subtract from the offset
            // otherwise its next and we paginate forward
            offset += PAGE_SIZE;
            queryRequest.query.offset = offset;
            var cardLimit = this.state.cardLimit;
            this.setState({ cardLimit: cardLimit + PAGE_SIZE });
            this.props.getNextPageOfData(queryRequest).then(function (hasMoreData) {
                if (!hasMoreData) {
                    _this.setState({ hasMoreData: false });
                }
            });
        };
        SynapseTableCardView.prototype.render = function () {
            var _a = this.props, data = _a.data, _b = _a.hideOrganizationLink, hideOrganizationLink = _b === void 0 ? false : _b, _c = _a.limit, limit = _c === void 0 ? Infinity : _c, _d = _a.token, token = _d === void 0 ? '' : _d, _e = _a.ownerId, ownerId = _e === void 0 ? '' : _e, _f = _a.isHeader, isHeader = _f === void 0 ? false : _f, isQueryWrapperChild = _a.isQueryWrapperChild, filter = _a.filter, unitDescription = _a.unitDescription, type = _a.type;
            if (data === undefined || Object.keys(data).length === 0) {
                return React.createElement("div", { className: "container" });
            }
            var schema = {};
            data.queryResult.queryResults.headers.forEach(function (element, index) {
                schema[element.name] = index;
            });
            var cardLimit = 0;
            // Either the number of cards to be shown is specified by the developer in the props
            // or this card is under the query wrapper and we handle the view more button
            cardLimit = isQueryWrapperChild ? this.state.cardLimit : limit;
            // We want to hide the view more button if:
            //     1. On page load we get the initial results and find there are < 25 rows
            //     2. We have done a subsequent query request from init render and have found
            //        that there were no rows returned.
            //     3. If its loading then we want it to remove from the screen so the browser doesn't
            //        keep the button in focus (its a UX issue).
            var showViewMore = isQueryWrapperChild && data.queryResult.queryResults.rows.length >= PAGE_SIZE;
            showViewMore = showViewMore && this.state.hasMoreData;
            showViewMore = showViewMore && !this.props.isLoading;
            var _g = data.facets, facets = _g === void 0 ? [] : _g;
            var total = 0;
            var curFacetsIndex = facets.findIndex(function (el) { return el.facetType === 'enumeration' && el.columnName === filter; });
            if (curFacetsIndex !== -1) {
                // calculate the values chosen
                var curFacets = data.facets[curFacetsIndex];
                // edge case -- if they are all false then they are considered all true..
                // sum up the counts of data
                var anyTrue = false;
                var totalAllFalseCase = 0;
                var totalStandardCase = 0;
                if (curFacets) {
                    for (var _i = 0, _h = curFacets.facetValues; _i < _h.length; _i++) {
                        var key = _h[_i];
                        anyTrue = anyTrue || key.isSelected;
                        totalAllFalseCase += key.count;
                        totalStandardCase += key.isSelected ? key.count : 0;
                    }
                }
                total = anyTrue ? totalStandardCase : totalAllFalseCase;
            }
            if (data.queryResult.queryResults.rows.length === 0) {
                total = 0;
            }
            // Either the filter is defined and the count should be shown or the client defined the unit description
            // and the count should be shown.
            var showCardCount = filter || (!filter && unitDescription);
            var showViewMoreButton = (showViewMore
                &&
                    (React.createElement("div", null,
                        React.createElement("button", { onClick: this.handleViewMore, className: "pull-right SRC-primary-background-color-hover SRC-viewMoreButton" }, "View More"))));
            return (React.createElement("div", null,
                showCardCount && React.createElement("p", { className: "SRC-boldText SRC-text-title" },
                    " Displaying ",
                    total,
                    " ",
                    unitDescription),
                data.queryResult.queryResults.rows.map(function (rowData, index) {
                    if (index < cardLimit) {
                        return (React.createElement(React.Fragment, { key: index },
                            React.createElement(RowContainer, { type: type, hideOrganizationLink: hideOrganizationLink, limit: cardLimit, data: rowData.values, schema: schema, token: token, ownerId: ownerId, isHeader: isHeader })));
                    }
                    return false;
                }),
                showViewMoreButton));
        };
        SynapseTableCardView.propTypes = {
            hideOrganizationLink: PropTypes.bool,
            limit: PropTypes.number,
            type: PropTypes.oneOf([STUDY, DATASET, FUNDER, PUBLICATION, TOOL, AMP_PROJECT, AMP_CONSORTIUM, AMP_STUDY])
        };
        return SynapseTableCardView;
    }(React.Component));

    library.add(faAngleLeft);
    library.add(faAngleRight);
    var Menu = /** @class */ (function (_super) {
        __extends(Menu, _super);
        function Menu(props) {
            var _this = _super.call(this, props) || this;
            /**
             * Handle the user hovering over a facet selection, it must be programatically
             * handled because the color used is dynamic
             *
             * @memberof Menu
             */
            _this.handleHoverLogic = function (info) { return function (event) {
                if (!info.isSelected && event.currentTarget.tagName === 'DIV') {
                    event.currentTarget.style.backgroundColor = info.originalColor;
                }
            }; };
            /**
             * Handle user clicking menu item, event isn't used so we denote it as an _
             *
             * @memberof Menu
             */
            _this.switchFacet = function (menuIndex) { return function (_) {
                _this.setState({ menuIndex: menuIndex });
            }; };
            _this.state = {
                menuIndex: 0
            };
            _this.handleHoverLogic = _this.handleHoverLogic.bind(_this);
            _this.switchFacet = _this.switchFacet.bind(_this);
            return _this;
        }
        Menu.prototype.render = function () {
            var _this = this;
            var _a = this.props, token = _a.token, menuConfig = _a.menuConfig, rgbIndex = _a.rgbIndex, type = _a.type, loadingScreen = _a.loadingScreen;
            var colorPalette = getColorPallette(rgbIndex, 1).colorPalette;
            var originalColor = colorPalette[0];
            var menuDropdown = menuConfig.map(function (config$$1, index) {
                var isSelected = (index === _this.state.menuIndex);
                var style = {};
                var selectedStyling = '';
                if (isSelected) {
                    // we have to programatically set the style since the color is chosen from a color
                    // wheel
                    style.background = originalColor;
                    // below has to be set so the pseudo element created will inherit its color
                    // appropriately
                    style.borderLeftColor = originalColor;
                    selectedStyling = 'SRC-pointed SRC-whiteText';
                }
                else {
                    // change background to class
                    selectedStyling = 'SRC-blackText SRC-light-background';
                }
                var infoEnter = { isSelected: isSelected, originalColor: originalColor };
                var infoLeave = { isSelected: isSelected, originalColor: '#F5F5F5' };
                var facetDisplayValue = config$$1.facetDisplayValue || '';
                if (!facetDisplayValue) {
                    facetDisplayValue = config$$1.facetName;
                }
                return (React.createElement("div", { onMouseEnter: _this.handleHoverLogic(infoEnter), onMouseLeave: _this.handleHoverLogic(infoLeave), key: config$$1.facetName, className: "SRC-hoverWhiteText SRC-menu SRC-hand-cursor SRC-menu-hover SRC-hoverBox SRC-text-chart " + selectedStyling, onClick: _this.switchFacet(index), style: style }, facetDisplayValue));
            });
            var queryWrapper = menuConfig.map(function (config$$1, index) {
                var isSelected = (_this.state.menuIndex === index);
                var className = '';
                if (!isSelected) {
                    className = 'SRC-hidden';
                }
                var showSynTable = React.createElement("div", null);
                if (config$$1.title) {
                    showSynTable = (React.createElement(SynapseTable, { title: config$$1.title, synapseId: config$$1.synapseId, 
                        // specify visible column count
                        visibleColumnCount: config$$1.visibleColumnCount || 0 }));
                }
                return (React.createElement("span", { key: config$$1.facetName, className: className },
                    React.createElement(QueryWrapper, { showMenu: true, initQueryRequest: {
                            concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',
                            partMask: 
                            // tslint:disable-next-line
                            BUNDLE_MASK_QUERY_COLUMN_MODELS |
                                BUNDLE_MASK_QUERY_FACETS |
                                BUNDLE_MASK_QUERY_RESULTS,
                            query: {
                                isConsistent: false,
                                limit: 25,
                                offset: 0,
                                sql: config$$1.sql,
                            }
                        }, unitDescription: config$$1.unitDescription || '', facetName: config$$1.facetName, token: token, rgbIndex: rgbIndex },
                        React.createElement(StackedRowHomebrew, { synapseId: config$$1.synapseId, unitDescription: (config$$1.unitDescription || ''), loadingScreen: loadingScreen }),
                        React.createElement(Facets, null),
                        showSynTable,
                        type ? React.createElement(SynapseTableCardView, { type: type }) : (React.createElement("div", null)))));
            });
            return (React.createElement("div", { className: "container-fluid" },
                React.createElement("div", { className: "col-xs-2 SRC-menuLayout SRC-paddingTopNoMargin" }, menuDropdown),
                React.createElement("div", { className: "col-xs-10" }, queryWrapper)));
        };
        Menu.propTypes = {
            facetName: PropTypes.string,
            menuConfig: PropTypes.arrayOf(PropTypes.any),
            rgbIndex: PropTypes.number,
            token: PropTypes.string
        };
        return Menu;
    }(React.Component));

    var StaticQueryWrapper = /** @class */ (function (_super) {
        __extends(StaticQueryWrapper, _super);
        function StaticQueryWrapper(props) {
            var _this = _super.call(this, props) || this;
            _this.state = { data: {} };
            _this.getData = _this.getData.bind(_this);
            return _this;
        }
        StaticQueryWrapper.prototype.componentDidUpdate = function (prevProps) {
            // re-run query if sql is updated
            if (this.props.sql !== prevProps.sql) {
                this.getData();
            }
        };
        StaticQueryWrapper.prototype.componentDidMount = function () {
            this.getData();
        };
        StaticQueryWrapper.prototype.render = function () {
            var _a = this.props, children = _a.children, json = _a.json;
            var data = this.state.data;
            var childData;
            childData = json !== undefined ? json : data;
            var childrenWithProps = React.Children.map(children, function (child) {
                return React.cloneElement(child, {
                    data: childData
                });
            });
            return (React.createElement("div", null, childrenWithProps));
        };
        StaticQueryWrapper.prototype.getData = function () {
            var _this = this;
            var _a = this.props, _b = _a.token, token = _b === void 0 ? '' : _b, json = _a.json;
            if (json === undefined) {
                var queryBundleRequest = {
                    concreteType: 'org.sagebionetworks.repo.model.table.QueryBundleRequest',
                    partMask: BUNDLE_MASK_QUERY_RESULTS,
                    query: {
                        isConsistent: false,
                        limit: 25,
                        offset: 0,
                        sql: this.props.sql
                    }
                };
                getQueryTableResults(queryBundleRequest, token).then(function (data) {
                    _this.setState({ data: data });
                });
            }
        };
        return StaticQueryWrapper;
    }(React.Component));

    var SynapseComponents = {
        Facets: Facets,
        QueryWrapper: QueryWrapper,
        StackedRowHomebrew: StackedRowHomebrew,
        StaticQueryWrapper: StaticQueryWrapper,
        SynapseTable: SynapseTable,
        SynapseTableCardView: SynapseTableCardView,
        QueryWrapperMenu: Menu,
        Markdown: MarkdownSynapse
    };

    exports.SynapseClient = SynapseClient;
    exports.SynapseConstants = SynapseConstants;
    exports.SynapseComponents = SynapseComponents;

    Object.defineProperty(exports, '__esModule', { value: true });

}));
